/*! For license information please see main.f376c71b.js.LICENSE.txt */
!function(){var e={371:function(e,t,n){var r;!function(i){var a=Object.hasOwnProperty,o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s="object"==typeof process&&"function"==typeof process.nextTick,u="function"===typeof Symbol,c="object"===typeof Reflect,l="function"===typeof setImmediate?setImmediate:setTimeout,d=u?c&&"function"===typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function h(){this._events={},this._conf&&f.call(this,this._conf)}function f(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==i&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function p(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!==typeof process&&process.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=e,process.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var v=function(e,t,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function m(e,t){for(var n={},r=e.length,a=t?value.length:0,o=0;o<r;o++)n[e[o]]=o<a?t[o]:i;return n}function g(e,t,n){var r,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),t.addEventListener?(r=t.addEventListener,i=t.removeEventListener):t.addListener?(r=t.addListener,i=t.removeListener):t.on&&(r=t.on,i=t.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!==typeof r)throw TypeError("on method must be a function");if("function"!==typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var a=e._observers;a?a.push(this):e._observers=[this]}function y(e,t,n,r){var o=Object.assign({},t);if(!e)return o;if("object"!==typeof e)throw TypeError("options must be an object");var s,u,c,l=Object.keys(e),d=l.length;function h(e){throw Error('Invalid "'+s+'" option value'+(e?". Reason: "+e:""))}for(var f=0;f<d;f++){if(s=l[f],!r&&!a.call(t,s))throw Error('Unknown "'+s+'" option');(u=e[s])!==i&&(c=n[s],o[s]=c?c(u,h):u)}return o}function k(e,t){return"function"===typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function b(e){var t="value must be type of "+e.join("|"),n=e.length,r=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===r)return e;n(t)}:2===n?function(e,n){var a=typeof e;if(a===r||a===i)return e;n(t)}:function(r,i){for(var a=typeof r,o=n;o-- >0;)if(a===e[o])return r;i(t)}}Object.assign(g.prototype,{subscribe:function(e,t,n){var r=this,i=this._target,a=this._emitter,o=this._listeners,s=function(){var r=v.apply(null,arguments),o={data:r,name:t,original:e};if(n){var s=n.call(i,o);!1!==s&&a.emit.apply(a,[o.name].concat(r))}else a.emit.apply(a,[t].concat(r))};if(o[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,a._newListener&&a._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===t&&null===o[e]&&(o[e]=s,r._on.call(i,e,s))},a.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!a.hasListeners(n)&&o[e]&&(o[e]=null,r._off.call(i,e,s))},o[e]=null,a.on("removeListener",this._onRemoveListener)):(o[e]=s,r._on.call(i,e,s))},unsubscribe:function(e){var t,n,r,i=this,a=this._listeners,o=this._emitter,s=this._off,u=this._target;if(e&&"string"!==typeof e)throw TypeError("event must be a string");function c(){i._onNewListener&&(o.off("newListener",i._onNewListener),o.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=E.call(o,i);o._observers.splice(e,1)}if(e){if(!(t=a[e]))return;s.call(u,e,t),delete a[e],--this._listenersCount||c()}else{for(r=(n=d(a)).length;r-- >0;)e=n[r],s.call(u,e,a[e]);this._listeners={},this._listenersCount=0,c()}}});var w=b(["function"]),S=b(["object","function"]);function T(e,t,n){var r,i,a,o=0,s=new e((function(u,c,l){function d(){i&&(i=null),o&&(clearTimeout(o),o=0)}n=y(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!==typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),r=!n.overload&&"function"===typeof e.prototype.cancel&&"function"===typeof l;var h=function(e){d(),u(e)},f=function(e){d(),c(e)};r?t(h,f,l):(i=[function(e){f(e||Error("canceled"))}],t(h,f,(function(e){if(a)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!==typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),a=!0),n.timeout>0&&(o=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",o=0,s.cancel(e),c(e)}),n.timeout))}));return r||(s.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),s}function E(e){var t=this._observers;if(!t)return-1;for(var n=t.length,r=0;r<n;r++)if(t[r]._target===e)return r;return-1}function x(e,t,n,r,i){if(!n)return null;if(0===r){var a=typeof t;if("string"===a){var o,s,u=0,c=0,l=this.delimiter,h=l.length;if(-1!==(s=t.indexOf(l))){o=new Array(5);do{o[u++]=t.slice(c,s),c=s+h}while(-1!==(s=t.indexOf(l,c)));o[u++]=t.slice(c),t=o,i=u}else t=[t],i=1}else"object"===a?i=t.length:(t=[t],i=1)}var f,p,v,m,g,y,k,b=null,w=t[r],S=t[r+1];if(r===i)n._listeners&&("function"===typeof n._listeners?(e&&e.push(n._listeners),b=[n]):(e&&e.push.apply(e,n._listeners),b=[n]));else{if("*"===w){for(s=(y=d(n)).length;s-- >0;)"_listeners"!==(f=y[s])&&(k=x(e,t,n[f],r+1,i))&&(b?b.push.apply(b,k):b=k);return b}if("**"===w){for((g=r+1===i||r+2===i&&"*"===S)&&n._listeners&&(b=x(e,t,n,i,i)),s=(y=d(n)).length;s-- >0;)"_listeners"!==(f=y[s])&&("*"===f||"**"===f?(n[f]._listeners&&!g&&(k=x(e,t,n[f],i,i))&&(b?b.push.apply(b,k):b=k),k=x(e,t,n[f],r,i)):k=x(e,t,n[f],f===S?r+2:r,i),k&&(b?b.push.apply(b,k):b=k));return b}n[w]&&(b=x(e,t,n[w],r+1,i))}if((p=n["*"])&&x(e,t,p,r+1,i),v=n["**"])if(r<i)for(v._listeners&&x(e,t,v,i,i),s=(y=d(v)).length;s-- >0;)"_listeners"!==(f=y[s])&&(f===S?x(e,t,v[f],r+2,i):f===w?x(e,t,v[f],r+1,i):((m={})[f]=v[f],x(e,t,{"**":m},r+1,i)));else v._listeners?x(e,t,v,i,i):v["*"]&&v["*"]._listeners&&x(e,t,v["*"],i,i);return b}function C(e,t,n){var r,i,a=0,o=0,s=this.delimiter,u=s.length;if("string"===typeof e)if(-1!==(r=e.indexOf(s))){i=new Array(5);do{i[a++]=e.slice(o,r),o=r+u}while(-1!==(r=e.indexOf(s,o)));i[a++]=e.slice(o)}else i=[e],a=1;else i=e,a=e.length;if(a>1)for(r=0;r+1<a;r++)if("**"===i[r]&&"**"===i[r+1])return;var c,l=this.listenerTree;for(r=0;r<a;r++)if(l=l[c=i[r]]||(l[c]={}),r===a-1)return l._listeners?("function"===typeof l._listeners&&(l._listeners=[l._listeners]),n?l._listeners.unshift(t):l._listeners.push(t),!l._listeners.warned&&this._maxListeners>0&&l._listeners.length>this._maxListeners&&(l._listeners.warned=!0,p.call(this,l._listeners.length,c))):l._listeners=t,!0;return!0}function P(e,t,n,r){for(var i,a,o,s,u=d(e),c=u.length,l=e._listeners;c-- >0;)i=e[a=u[c]],o="_listeners"===a?n:n?n.concat(a):[a],s=r||"symbol"===typeof a,l&&t.push(s?o:o.join(this.delimiter)),"object"===typeof i&&P.call(this,i,t,o,s);return t}function R(e){for(var t,n,r,i=d(e),a=i.length;a-- >0;)(t=e[n=i[a]])&&(r=!0,"_listeners"===n||R(t)||delete e[n]);return r}function _(e,t,n){this.emitter=e,this.event=t,this.listener=n}function I(e,t,n){if(!0===n)a=!0;else if(!1===n)r=!0;else{if(!n||"object"!==typeof n)throw TypeError("options should be an object or true");var r=n.async,a=n.promisify,o=n.nextTick,u=n.objectify}if(r||o||a){var c=t,d=t._origin||t;if(o&&!s)throw Error("process.nextTick is not supported");a===i&&(a="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return a?o?Promise.resolve():new Promise((function(e){l(e)})).then((function(){return t.event=n,c.apply(t,e)})):(o?process.nextTick:l)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=d}return[t,u?new _(this,e,t):this]}function A(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,f.call(this,e)}_.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},A.EventEmitter2=A,A.prototype.listenTo=function(e,t,n){if("object"!==typeof e)throw TypeError("target musts be an object");var r=this;function a(t){if("object"!==typeof t)throw TypeError("events must be an object");var i,a=n.reducers,o=E.call(r,e);i=-1===o?new g(r,e,n):r._observers[o];for(var s,u=d(t),c=u.length,l="function"===typeof a,h=0;h<c;h++)s=u[h],i.subscribe(s,t[s]||s,l?a:a&&a[s])}return n=y(n,{on:i,off:i,reducers:i},{on:w,off:w,reducers:S}),o(t)?a(m(t)):a("string"===typeof t?m(t.split(/\s+/)):t),this},A.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var r,i=n.length,a=!1;if(e&&"object"!==typeof e)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],e&&r._target!==e||(r.unsubscribe(t),a=!0);return a},A.prototype.delimiter=".",A.prototype.setMaxListeners=function(e){e!==i&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},A.prototype.getMaxListeners=function(){return this._maxListeners},A.prototype.event="",A.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},A.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},A.prototype._once=function(e,t,n,r){return this._many(e,1,t,n,r)},A.prototype.many=function(e,t,n,r){return this._many(e,t,n,!1,r)},A.prototype.prependMany=function(e,t,n,r){return this._many(e,t,n,!0,r)},A.prototype._many=function(e,t,n,r,i){var a=this;if("function"!==typeof n)throw new Error("many only accepts instances of Function");function o(){return 0===--t&&a.off(e,o),n.apply(this,arguments)}return o._origin=n,this._on(e,o,r,i)},A.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,n,r,i,a,o=arguments[0],s=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return!1;if(s&&(e=o,"newListener"!==o&&"removeListener"!==o&&"object"===typeof o)){if(n=o.length,u)for(r=0;r<n;r++)if("symbol"===typeof o[r]){a=!0;break}a||(o=o.join(this.delimiter))}var c,l=arguments.length;if(this._all&&this._all.length)for(r=0,n=(c=this._all.slice()).length;r<n;r++)switch(this.event=o,l){case 1:c[r].call(this,o);break;case 2:c[r].call(this,o,arguments[1]);break;case 3:c[r].call(this,o,arguments[1],arguments[2]);break;default:c[r].apply(this,arguments)}if(s)c=[],x.call(this,c,e,this.listenerTree,0,n);else{if("function"===typeof(c=this._events[o])){switch(this.event=o,l){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(l-1),i=1;i<l;i++)t[i-1]=arguments[i];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(l>3)for(t=new Array(l-1),i=1;i<l;i++)t[i-1]=arguments[i];for(r=0,n=c.length;r<n;r++)switch(this.event=o,l){case 1:c[r].call(this);break;case 2:c[r].call(this,arguments[1]);break;case 3:c[r].call(this,arguments[1],arguments[2]);break;default:c[r].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===o)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},A.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,n,r,i,a,o=arguments[0],s=this.wildcard;if("newListener"===o&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(s&&(e=o,"newListener"!==o&&"removeListener"!==o&&"object"===typeof o)){if(r=o.length,u)for(i=0;i<r;i++)if("symbol"===typeof o[i]){t=!0;break}t||(o=o.join(this.delimiter))}var c,l=[],d=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=o,d){case 1:l.push(this._all[i].call(this,o));break;case 2:l.push(this._all[i].call(this,o,arguments[1]));break;case 3:l.push(this._all[i].call(this,o,arguments[1],arguments[2]));break;default:l.push(this._all[i].apply(this,arguments))}if(s?(c=[],x.call(this,c,e,this.listenerTree,0)):c=this._events[o],"function"===typeof c)switch(this.event=o,d){case 1:l.push(c.call(this));break;case 2:l.push(c.call(this,arguments[1]));break;case 3:l.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(d-1),a=1;a<d;a++)n[a-1]=arguments[a];l.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),d>3)for(n=new Array(d-1),a=1;a<d;a++)n[a-1]=arguments[a];for(i=0,r=c.length;i<r;i++)switch(this.event=o,d){case 1:l.push(c[i].call(this));break;case 2:l.push(c[i].call(this,arguments[1]));break;case 3:l.push(c[i].call(this,arguments[1],arguments[2]));break;default:l.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===o)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(l)},A.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},A.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},A.prototype.onAny=function(e){return this._onAny(e,!1)},A.prototype.prependAny=function(e){return this._onAny(e,!0)},A.prototype.addListener=A.prototype.on,A.prototype._onAny=function(e,t){if("function"!==typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},A.prototype._on=function(e,t,n,r){if("function"===typeof e)return this._onAny(e,t),this;if("function"!==typeof t)throw new Error("on only accepts instances of Function");this._events||h.call(this);var a,o=this;return r!==i&&(t=(a=I.call(this,e,t,r))[0],o=a[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(C.call(this,e,t,n),o):(this._events[e]?("function"===typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,p.call(this,this._events[e].length,e))):this._events[e]=t,o)},A.prototype.off=function(e,t){if("function"!==typeof t)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"===typeof e?e.split(this.delimiter):e.slice();if(!(r=x.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var a=0;a<r.length;a++){var s=r[a];if(n=s._listeners,o(n)){for(var u=-1,c=0,l=n.length;c<l;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){u=c;break}if(u<0)continue;return this.wildcard?s._listeners.splice(u,1):this._events[e].splice(u,1),0===n.length&&(this.wildcard?delete s._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete s._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&R(this.listenerTree),this},A.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},A.prototype.removeListener=A.prototype.off,A.prototype.removeAllListeners=function(e){if(e===i)return!this._events||h.call(this),this;if(this.wildcard){var t,n=x.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&R(this.listenerTree)}else this._events&&(this._events[e]=null);return this},A.prototype.listeners=function(e){var t,n,r,a,o,s=this._events;if(e===i){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!s)return[];for(a=(t=d(s)).length,r=[];a-- >0;)"function"===typeof(n=s[t[a]])?r.push(n):r.push.apply(r,n);return r}if(this.wildcard){if(!(o=this.listenerTree))return[];var u=[],c="string"===typeof e?e.split(this.delimiter):e.slice();return x.call(this,u,c,o,0),u}return s&&(n=s[e])?"function"===typeof n?[n]:n:[]},A.prototype.eventNames=function(e){var t=this._events;return this.wildcard?P.call(this,this.listenerTree,[],null,e):t?d(t):[]},A.prototype.listenerCount=function(e){return this.listeners(e).length},A.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"===typeof e?e.split(this.delimiter):e.slice();return x.call(this,t,n,this.listenerTree,0),t.length>0}var r=this._events,a=this._all;return!!(a&&a.length||r&&(e===i?d(r).length:r[e]))},A.prototype.listenersAny=function(){return this._all?this._all:[]},A.prototype.waitFor=function(e,t){var n=this,r=typeof t;return"number"===r?t={timeout:t}:"function"===r&&(t={filter:t}),T((t=y(t,{timeout:0,filter:i,handleError:!1,Promise:Promise,overload:!1},{filter:w,Promise:k})).Promise,(function(r,i,a){function o(){var a=t.filter;if(!a||a.apply(n,arguments))if(n.off(e,o),t.handleError){var s=arguments[0];s?i(s):r(v.apply(null,arguments).slice(1))}else r(v.apply(null,arguments))}a((function(){n.off(e,o)})),n._on(e,o,!1)}),{timeout:t.timeout,overload:t.overload})};var D=A.prototype;Object.defineProperties(A,{defaultMaxListeners:{get:function(){return D._maxListeners},set:function(e){if("number"!==typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");D._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return T((n=y(n,{Promise:Promise,timeout:0,overload:!1},{Promise:k})).Promise,(function(n,r,i){var a;if("function"===typeof e.addEventListener)return a=function(){n(v.apply(null,arguments))},i((function(){e.removeEventListener(t,a)})),void e.addEventListener(t,a,{once:!0});var o,s=function(){o&&e.removeListener("error",o),n(v.apply(null,arguments))};"error"!==t&&(o=function(n){e.removeListener(t,s),r(n)},e.once("error",o)),i((function(){o&&e.removeListener("error",o),e.removeListener(t,s)})),e.once(t,s)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(D,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(r=function(){return A}.call(t,n,t,e))===i||(e.exports=r)}()},463:function(e,t,n){"use strict";var r=n(791),i=n(296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function v(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function k(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),P=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,U=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var j=!1;function B(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var u="\n"+i[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function V(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case S:return"Portal";case x:return"Profiler";case E:return"StrictMode";case _:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case R:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:G(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return G(e(t))}catch(n){}}return null}function z(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ge=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Te=null,Ee=null;function xe(e){if(e=ki(e)){if("function"!==typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=wi(t),Se(e.stateNode,e.type,t))}}function Ce(e){Te?Ee?Ee.push(e):Ee=[e]:Te=e}function Pe(){if(Te){var e=Te,t=Ee;if(Ee=Te=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function Re(e,t){return e(t)}function _e(){}var Ie=!1;function Ae(e,t,n){if(Ie)return e(t,n);Ie=!0;try{return Re(e,t,n)}finally{Ie=!1,(null!==Te||null!==Ee)&&(_e(),Pe())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ne=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Ne=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){Ne=!1}function Le(e,t,n,r,i,a,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Me=!1,Ue=null,Fe=!1,je=null,Be={onError:function(e){Me=!0,Ue=e}};function Ve(e,t,n,r,i,a,o,s,u){Me=!1,Ue=null,Le.apply(Be,arguments)}function Ge(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ge(e)!==e)throw Error(a(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ge(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===r)return He(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var qe=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Je=i.unstable_shouldYield,$e=i.unstable_requestPaint,Ye=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=dt(s):0!==(a&=o)&&(r=dt(a))}else 0!==(o=n&~i)?r=dt(o):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var kt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,St,Tt,Et,xt,Ct=!1,Pt=[],Rt=null,_t=null,It=null,At=new Map,Dt=new Map,Nt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Rt=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=ki(t))&&St(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ut(e){var t=yi(e.target);if(null!==t){var n=Ge(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=ze(n)))return e.blockedOn=t,void xt(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ki(n))&&St(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function jt(e,t,n){Ft(e)&&n.delete(t)}function Bt(){Ct=!1,null!==Rt&&Ft(Rt)&&(Rt=null),null!==_t&&Ft(_t)&&(_t=null),null!==It&&Ft(It)&&(It=null),At.forEach(jt),Dt.forEach(jt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bt)))}function Gt(e){function t(t){return Vt(t,e)}if(0<Pt.length){Vt(Pt[0],e);for(var n=1;n<Pt.length;n++){var r=Pt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Rt&&Vt(Rt,e),null!==_t&&Vt(_t,e),null!==It&&Vt(It,e),At.forEach(t),Dt.forEach(t),n=0;n<Nt.length;n++)(r=Nt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Nt.length&&null===(n=Nt[0]).blockedOn;)Ut(n),null===n.blockedOn&&Nt.shift()}var zt=b.ReactCurrentBatchConfig,Ht=!0;function Kt(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=1,qt(e,t,n,r)}finally{kt=i,zt.transition=a}}function Wt(e,t,n,r){var i=kt,a=zt.transition;zt.transition=null;try{kt=4,qt(e,t,n,r)}finally{kt=i,zt.transition=a}}function qt(e,t,n,r){if(Ht){var i=Jt(e,t,n,r);if(null===i)Hr(e,t,r,Qt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Rt=Mt(Rt,e,t,n,r,i),!0;case"dragenter":return _t=Mt(_t,e,t,n,r,i),!0;case"mouseover":return It=Mt(It,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return At.set(a,Mt(At.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Dt.set(a,Mt(Dt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var a=ki(i);if(null!==a&&wt(a),null===(a=Jt(e,t,n,r))&&Hr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Qt=null;function Jt(e,t,n,r){if(Qt=null,null!==(e=yi(e=we(r))))if(null===(t=Ge(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=ze(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),dn=U({},cn,{view:0,detail:0}),hn=an(dn),fn=U({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(fn),vn=an(U({},fn,{dataTransfer:0})),mn=an(U({},dn,{relatedTarget:0})),gn=an(U({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=U({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(yn),bn=an(U({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tn[e])&&!!t[e]}function xn(){return En}var Cn=U({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Pn=an(Cn),Rn=an(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=an(U({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xn})),In=an(U({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(An),Nn=[9,13,27,32],On=l&&"CompositionEvent"in window,Ln=null;l&&"documentMode"in document&&(Ln=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ln,Un=l&&(!On||Ln&&8<Ln&&11>=Ln),Fn=String.fromCharCode(32),jn=!1;function Bn(e,t){switch(e){case"keyup":return-1!==Nn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gn=!1;var zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!zn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ce(r),0<(t=Wr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,qn=null;function Qn(e){Fr(e,0)}function Jn(e){if(q(bi(e)))return e}function $n(e,t){if("change"===e)return t}var Yn=!1;if(l){var Xn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),qn=Wn=null)}function nr(e){if("value"===e.propertyName&&Jn(qn)){var t=[];Kn(t,qn,e,we(e)),Ae(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(qn)}function ar(e,t){if("click"===e)return Jn(t)}function or(e,t){if("input"===e||"change"===e)return Jn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,kr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==mr||mr!==Q(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=Wr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Sr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Tr={},Er={};function xr(e){if(Tr[e])return Tr[e];if(!Sr[e])return e;var t,n=Sr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Tr[e]=n[t];return e}l&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete Sr.animationend.animation,delete Sr.animationiteration.animation,delete Sr.animationstart.animation),"TransitionEvent"in window||delete Sr.transitionend.transition);var Cr=xr("animationend"),Pr=xr("animationiteration"),Rr=xr("animationstart"),_r=xr("transitionend"),Ir=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ir.set(e,t),u(t,[e])}for(var Nr=0;Nr<Ar.length;Nr++){var Or=Ar[Nr];Dr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Dr(Cr,"onAnimationEnd"),Dr(Pr,"onAnimationIteration"),Dr(Rr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(_r,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,u,c){if(Ve.apply(this,arguments),Me){if(!Me)throw Error(a(198));var l=Ue;Me=!1,Ue=null,Fe||(Fe=!0,je=l)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==a&&i.isPropagationStopped())break e;Ur(i,s,c),a=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==a&&i.isPropagationStopped())break e;Ur(i,s,c),a=u}}}if(Fe)throw e=je,Fe=!1,je=null,e}function jr(e,t){var n=t[vi];void 0===n&&(n=t[vi]=new Set);var r=e+"__bubble";n.has(r)||(zr(t,e,2,!1),n.add(r))}function Br(e,t,n){var r=0;t&&(r|=4),zr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Gr(e){if(!e[Vr]){e[Vr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||Br(t,!1,e),Br(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,Br("selectionchange",!1,t))}}function zr(e,t,n,r){switch($t(t)){case 1:var i=Kt;break;case 4:i=Wt;break;default:i=qt}n=i.bind(null,t,n,e),i=void 0,!Ne||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=yi(s)))return;if(5===(u=o.tag)||6===u){r=a=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=a,i=we(n),o=[];e:{var s=Ir.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Pn;break;case"focusin":c="focus",u=mn;break;case"focusout":c="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=_n;break;case Cr:case Pr:case Rr:u=gn;break;case _r:u=In;break;case"scroll":u=hn;break;case"wheel":u=Dn;break;case"copy":case"cut":case"paste":u=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Rn}var l=0!==(4&t),d=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var f,p=r;null!==p;){var v=(f=p).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==h&&(null!=(v=De(p,h))&&l.push(Kr(p,v,f)))),d)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,i),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(d=Ge(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=pn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Rn,v="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==u?s:bi(u),f=null==c?s:bi(c),(s=new l(v,p+"leave",u,n,i)).target=d,s.relatedTarget=f,v=null,yi(i)===r&&((l=new l(h,p+"enter",c,n,i)).target=f,l.relatedTarget=d,v=l),d=v,u&&c)e:{for(h=c,p=0,f=l=u;f;f=qr(f))p++;for(f=0,v=h;v;v=qr(v))f++;for(;0<p-f;)l=qr(l),p--;for(;0<f-p;)h=qr(h),f--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=qr(l),h=qr(h)}l=null}else l=null;null!==u&&Qr(o,s,u,l,!1),null!==c&&null!==d&&Qr(o,d,c,l,!0)}if("select"===(u=(s=r?bi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=$n;else if(Hn(s))if(Yn)m=or;else{m=ir;var g=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ar);switch(m&&(m=m(e,r))?Kn(o,m,n,i):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?bi(r):window,e){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,br(o,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(o,n,i)}var y;if(On)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Gn?Bn(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Un&&"ko"!==n.locale&&(Gn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Gn&&(y=en()):(Xt="value"in(Yt=i)?Yt.value:Yt.textContent,Gn=!0)),0<(g=Wr(r,k)).length&&(k=new bn(k,e,null,n,i),o.push({event:k,listeners:g}),y?k.data=y:null!==(y=Vn(n))&&(k.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(jn=!0,Fn);case"textInput":return(e=t.data)===Fn&&jn?null:e;default:return null}}(e,n):function(e,t){if(Gn)return"compositionend"===e||!On&&Bn(e,t)?(e=en(),Zt=Xt=Yt=null,Gn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}Fr(o,t)}))}function Kr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=De(e,n))&&r.unshift(Kr(e,a,i)),null!=(a=De(e,t))&&r.push(Kr(e,a,i))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(u=De(n,a))&&o.unshift(Kr(n,u,s)):i||null!=(u=De(n,a))&&o.push(Kr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace($r,"")}function Xr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Gt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Gt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,vi="__reactEvents$"+di,mi="__reactListeners$"+di,gi="__reactHandles$"+di;function yi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[hi])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function ki(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function wi(e){return e[fi]||null}var Si=[],Ti=-1;function Ei(e){return{current:e}}function xi(e){0>Ti||(e.current=Si[Ti],Si[Ti]=null,Ti--)}function Ci(e,t){Ti++,Si[Ti]=e.current,e.current=t}var Pi={},Ri=Ei(Pi),_i=Ei(!1),Ii=Pi;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Pi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Di(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ni(){xi(_i),xi(Ri)}function Oi(e,t,n){if(Ri.current!==Pi)throw Error(a(168));Ci(Ri,t),Ci(_i,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,z(e)||"Unknown",i));return U({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pi,Ii=Ri.current,Ci(Ri,e),Ci(_i,_i.current),!0}function Ui(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Li(e,t,Ii),r.__reactInternalMemoizedMergedChildContext=e,xi(_i),xi(Ri),Ci(Ri,e)):xi(_i),Ci(_i,n)}var Fi=null,ji=!1,Bi=!1;function Vi(e){null===Fi?Fi=[e]:Fi.push(e)}function Gi(){if(!Bi&&null!==Fi){Bi=!0;var e=0,t=kt;try{var n=Fi;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,ji=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),qe(Ze,Gi),i}finally{kt=t,Bi=!1}}return null}var zi=b.ReactCurrentBatchConfig;function Hi(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ki=Ei(null),Wi=null,qi=null,Qi=null;function Ji(){Qi=qi=Wi=null}function $i(e){var t=Ki.current;xi(Ki),e._currentValue=t}function Yi(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Xi(e,t){Wi=e,Qi=qi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ws=!0),e.firstContext=null)}function Zi(e){var t=e._currentValue;if(Qi!==e)if(e={context:e,memoizedValue:t,next:null},null===qi){if(null===Wi)throw Error(a(308));qi=e,Wi.dependencies={lanes:0,firstContext:e}}else qi=qi.next=e;return t}var ea=null,ta=!1;function na(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ia(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function aa(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,tc(e)?(null===(e=n.interleaved)?(t.next=t,null===ea?ea=[n]:ea.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function oa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function sa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ua(e,t,n,r){var i=e.updateQueue;ta=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?a=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==a){var d=i.baseState;for(o=0,l=c=u=null,s=a;;){var h=s.lane,f=s.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(h=t,f=n,v.tag){case 1:if("function"===typeof(p=v.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=v.payload)?p.call(f,d,h):p)||void 0===h)break e;d=U({},d,h);break e;case 2:ta=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=f,u=d):l=l.next=f,o|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===l&&(u=d),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Nu|=o,e.lanes=o,e.memoizedState=d}}function ca(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var la=(new r.Component).refs;function da(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ha={isMounted:function(e){return!!(e=e._reactInternals)&&Ge(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Yu(),i=Xu(e),a=ia(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),aa(e,a),null!==(t=Zu(e,i,r))&&oa(t,e,i)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Yu(),i=Xu(e),a=ia(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),aa(e,a),null!==(t=Zu(e,i,r))&&oa(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Yu(),r=Xu(e),i=ia(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),aa(e,i),null!==(t=Zu(e,r,n))&&oa(t,e,r)}};function fa(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,a))}function pa(e,t,n){var r=!1,i=Pi,a=t.contextType;return"object"===typeof a&&null!==a?a=Zi(a):(i=Di(t)?Ii:Ri.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Pi),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ha,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function va(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ha.enqueueReplaceState(t,t.state,null)}function ma(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=la,na(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Zi(a):(a=Di(t)?Ii:Ri.current,i.context=Ai(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(da(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ha.enqueueReplaceState(i,i.state,null),ua(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}var ga=[],ya=0,ka=null,ba=0,wa=[],Sa=0,Ta=null,Ea=1,xa="";function Ca(e,t){ga[ya++]=ba,ga[ya++]=ka,ka=e,ba=t}function Pa(e,t,n){wa[Sa++]=Ea,wa[Sa++]=xa,wa[Sa++]=Ta,Ta=e;var r=Ea;e=xa;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ea=1<<32-ot(t)+i|n<<i|r,xa=a+e}else Ea=1<<a|n<<i|r,xa=e}function Ra(e){null!==e.return&&(Ca(e,1),Pa(e,1,0))}function _a(e){for(;e===ka;)ka=ga[--ya],ga[ya]=null,ba=ga[--ya],ga[ya]=null;for(;e===Ta;)Ta=wa[--Sa],wa[Sa]=null,xa=wa[--Sa],wa[Sa]=null,Ea=wa[--Sa],wa[Sa]=null}var Ia=null,Aa=null,Da=!1,Na=null;function Oa(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function La(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,Ia=e,Aa=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,Ia=e,Aa=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ta?{id:Ea,overflow:xa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,Ia=e,Aa=null,!0);default:return!1}}function Ma(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function Ua(e){if(Da){var t=Aa;if(t){var n=t;if(!La(e,t)){if(Ma(e))throw Error(a(418));t=ci(n.nextSibling);var r=Ia;t&&La(e,t)?Oa(r,n):(e.flags=-4097&e.flags|2,Da=!1,Ia=e)}}else{if(Ma(e))throw Error(a(418));e.flags=-4097&e.flags|2,Da=!1,Ia=e}}}function Fa(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ia=e}function ja(e){if(e!==Ia)return!1;if(!Da)return Fa(e),Da=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=Aa)){if(Ma(e)){for(e=Aa;e;)e=ci(e.nextSibling);throw Error(a(418))}for(;t;)Oa(e,t),t=ci(t.nextSibling)}if(Fa(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Aa=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Aa=null}}else Aa=Ia?ci(e.stateNode.nextSibling):null;return!0}function Ba(){Aa=Ia=null,Da=!1}function Va(e){null===Na?Na=[e]:Na.push(e)}function Ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===la&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function za(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ha(e){return(0,e._init)(e._payload)}function Ka(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===T?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&Ha(a)===t.type)?((r=i(t,n.props)).ref=Ga(e,t,n),r.return=e,r):((r=Nc(n.type,n.key,n.props,null,e.mode,r)).ref=Ga(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Oc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Nc(t.type,t.key,t.props,null,e.mode,n)).ref=Ga(e,null,t),n.return=e,n;case S:return(t=Uc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Oc(t,e.mode,n,null)).return=e,t;za(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case S:return n.key===i?l(e,t,n,r):null;case D:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:d(e,t,n,r,null);za(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case S:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i);case D:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return d(t,e=e.get(n)||null,r,i,null);za(t,r)}return null}function v(i,a,s,u){for(var c=null,l=null,d=a,v=a=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var g=f(i,d,s[v],u);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(i,d),a=o(g,a,v),null===l?c=g:l.sibling=g,l=g,d=m}if(v===s.length)return n(i,d),Da&&Ca(i,v),c;if(null===d){for(;v<s.length;v++)null!==(d=h(i,s[v],u))&&(a=o(d,a,v),null===l?c=d:l.sibling=d,l=d);return Da&&Ca(i,v),c}for(d=r(i,d);v<s.length;v++)null!==(m=p(d,i,v,s[v],u))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),a=o(m,a,v),null===l?c=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(i,e)})),Da&&Ca(i,v),c}function m(i,s,u,c){var l=L(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var d=l=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var k=f(i,v,y.value,c);if(null===k){null===v&&(v=g);break}e&&v&&null===k.alternate&&t(i,v),s=o(k,s,m),null===d?l=k:d.sibling=k,d=k,v=g}if(y.done)return n(i,v),Da&&Ca(i,m),l;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=h(i,y.value,c))&&(s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return Da&&Ca(i,m),l}for(v=r(i,v);!y.done;m++,y=u.next())null!==(y=p(v,i,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(i,e)})),Da&&Ca(i,m),l}return function e(r,a,o,u){if("object"===typeof o&&null!==o&&o.type===T&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=a;null!==l;){if(l.key===c){if((c=o.type)===T){if(7===l.tag){n(r,l.sibling),(a=i(l,o.props.children)).return=r,r=a;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&Ha(c)===l.type){n(r,l.sibling),(a=i(l,o.props)).ref=Ga(r,l,o),a.return=r,r=a;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===T?((a=Oc(o.props.children,r.mode,u,o.key)).return=r,r=a):((u=Nc(o.type,o.key,o.props,null,r.mode,u)).ref=Ga(r,a,o),u.return=r,r=u)}return s(r);case S:e:{for(l=o.key;null!==a;){if(a.key===l){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Uc(o,r.mode,u)).return=r,r=a}return s(r);case D:return e(r,a,(l=o._init)(o._payload),u)}if(te(o))return v(r,a,o,u);if(L(o))return m(r,a,o,u);za(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=Mc(o,r.mode,u)).return=r,r=a),s(r)):n(r,a)}}var Wa=Ka(!0),qa=Ka(!1),Qa={},Ja=Ei(Qa),$a=Ei(Qa),Ya=Ei(Qa);function Xa(e){if(e===Qa)throw Error(a(174));return e}function Za(e,t){switch(Ci(Ya,t),Ci($a,e),Ci(Ja,Qa),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ja),Ci(Ja,t)}function eo(){xi(Ja),xi($a),xi(Ya)}function to(e){Xa(Ya.current);var t=Xa(Ja.current),n=ue(t,e.type);t!==n&&(Ci($a,e),Ci(Ja,n))}function no(e){$a.current===e&&(xi(Ja),xi($a))}var ro=Ei(0);function io(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ao=[];function oo(){for(var e=0;e<ao.length;e++)ao[e]._workInProgressVersionPrimary=null;ao.length=0}var so=b.ReactCurrentDispatcher,uo=b.ReactCurrentBatchConfig,co=0,lo=null,ho=null,fo=null,po=!1,vo=!1,mo=0,go=0;function yo(){throw Error(a(321))}function ko(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function bo(e,t,n,r,i,o){if(co=o,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?rs:is,e=n(r,i),vo){o=0;do{if(vo=!1,mo=0,25<=o)throw Error(a(301));o+=1,fo=ho=null,t.updateQueue=null,so.current=as,e=n(r,i)}while(vo)}if(so.current=ns,t=null!==ho&&null!==ho.next,co=0,fo=ho=lo=null,po=!1,t)throw Error(a(300));return e}function wo(){var e=0!==mo;return mo=0,e}function So(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===fo?lo.memoizedState=fo=e:fo=fo.next=e,fo}function To(){if(null===ho){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=ho.next;var t=null===fo?lo.memoizedState:fo.next;if(null!==t)fo=t,ho=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ho=e).memoizedState,baseState:ho.baseState,baseQueue:ho.baseQueue,queue:ho.queue,next:null},null===fo?lo.memoizedState=fo=e:fo=fo.next=e}return fo}function Eo(e,t){return"function"===typeof t?t(e):t}function xo(e){var t=To(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ho,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var u=s=null,c=null,l=o;do{var d=l.lane;if((co&d)===d)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=h,s=r):c=c.next=h,lo.lanes|=d,Nu|=d}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(ws=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,lo.lanes|=o,Nu|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Co(e){var t=To(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(ws=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Po(){}function Ro(e,t){var n=lo,r=To(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,ws=!0),r=r.queue,jo(Ao.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==fo&&1&fo.memoizedState.tag){if(n.flags|=2048,Oo(9,Io.bind(null,n,r,i,t),void 0,null),null===Cu)throw Error(a(349));0!==(30&co)||_o(n,t,i)}return i}function _o(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Io(e,t,n,r){t.value=n,t.getSnapshot=r,Do(t)&&Zu(e,1,-1)}function Ao(e,t,n){return n((function(){Do(t)&&Zu(e,1,-1)}))}function Do(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function No(e){var t=So();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t.queue=e,e=e.dispatch=Yo.bind(null,lo,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Lo(){return To().memoizedState}function Mo(e,t,n,r){var i=So();lo.flags|=e,i.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function Uo(e,t,n,r){var i=To();r=void 0===r?null:r;var a=void 0;if(null!==ho){var o=ho.memoizedState;if(a=o.destroy,null!==r&&ko(r,o.deps))return void(i.memoizedState=Oo(t,n,a,r))}lo.flags|=e,i.memoizedState=Oo(1|t,n,a,r)}function Fo(e,t){return Mo(8390656,8,e,t)}function jo(e,t){return Uo(2048,8,e,t)}function Bo(e,t){return Uo(4,2,e,t)}function Vo(e,t){return Uo(4,4,e,t)}function Go(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4,4,Go.bind(null,t,e),n)}function Ho(){}function Ko(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ko(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qo(e,t,n){return 0===(21&co)?(e.baseState&&(e.baseState=!1,ws=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),lo.lanes|=n,Nu|=n,e.baseState=!0),t)}function Qo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=uo.transition;uo.transition={};try{e(!1),t()}finally{kt=n,uo.transition=r}}function Jo(){return To().memoizedState}function $o(e,t,n){var r=Xu(e);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xo(e)?Zo(t,n):(es(e,t,n),null!==(e=Zu(e,r,n=Yu()))&&ts(e,t,r))}function Yo(e,t,n){var r=Xu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xo(e))Zo(t,i);else{es(e,t,i);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o))return}catch(u){}null!==(e=Zu(e,r,n=Yu()))&&ts(e,t,r)}}function Xo(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Zo(e,t){vo=po=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function es(e,t,n){tc(e)?(null===(e=t.interleaved)?(n.next=n,null===ea?ea=[t]:ea.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function ts(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var ns={readContext:Zi,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},rs={readContext:Zi,useCallback:function(e,t){return So().memoizedState=[e,void 0===t?null:t],e},useContext:Zi,useEffect:Fo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4194308,4,Go.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Mo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mo(4,2,e,t)},useMemo:function(e,t){var n=So();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=So();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=$o.bind(null,lo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},So().memoizedState=e},useState:No,useDebugValue:Ho,useDeferredValue:function(e){return So().memoizedState=e},useTransition:function(){var e=No(!1),t=e[0];return e=Qo.bind(null,e[1]),So().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lo,i=So();if(Da){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Cu)throw Error(a(349));0!==(30&co)||_o(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Fo(Ao.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,Io.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=So(),t=Cu.identifierPrefix;if(Da){var n=xa;t=":"+t+"R"+(n=(Ea&~(1<<32-ot(Ea)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},is={readContext:Zi,useCallback:Ko,useContext:Zi,useEffect:jo,useImperativeHandle:zo,useInsertionEffect:Bo,useLayoutEffect:Vo,useMemo:Wo,useReducer:xo,useRef:Lo,useState:function(){return xo(Eo)},useDebugValue:Ho,useDeferredValue:function(e){return qo(To(),ho.memoizedState,e)},useTransition:function(){return[xo(Eo)[0],To().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ro,useId:Jo,unstable_isNewReconciler:!1},as={readContext:Zi,useCallback:Ko,useContext:Zi,useEffect:jo,useImperativeHandle:zo,useInsertionEffect:Bo,useLayoutEffect:Vo,useMemo:Wo,useReducer:Co,useRef:Lo,useState:function(){return Co(Eo)},useDebugValue:Ho,useDeferredValue:function(e){var t=To();return null===ho?t.memoizedState=e:qo(t,ho.memoizedState,e)},useTransition:function(){return[Co(Eo)[0],To().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ro,useId:Jo,unstable_isNewReconciler:!1};function os(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var us,cs,ls,ds="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=ia(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vu||(Vu=!0,Gu=r),ss(0,t)},n}function fs(e,t,n){(n=ia(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ss(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ss(0,t),"function"!==typeof r&&(null===zu?zu=new Set([this]):zu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ps(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function vs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ms(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=ia(-1,1)).tag=2,aa(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}function gs(e,t){if(!Da)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ys(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ks(e,t,n){var r=t.pendingProps;switch(_a(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ys(t),null;case 1:case 17:return Di(t.type)&&Ni(),ys(t),null;case 3:return r=t.stateNode,eo(),xi(_i),xi(Ri),oo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ja(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==Na&&(ac(Na),Na=null))),ys(t),null;case 5:no(t);var i=Xa(Ya.current);if(n=t.type,null!==e&&null!=t.stateNode)cs(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return ys(t),null}if(e=Xa(Ja.current),ja(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hi]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":jr("cancel",r),jr("close",r);break;case"iframe":case"object":case"embed":jr("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)jr(Lr[i],r);break;case"source":jr("error",r);break;case"img":case"image":case"link":jr("error",r),jr("load",r);break;case"details":jr("toggle",r);break;case"input":$(r,o),jr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},jr("invalid",r);break;case"textarea":ie(r,o),jr("invalid",r)}for(var u in ye(n,o),i=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&jr("scroll",r)}switch(n){case"input":W(r),Z(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[hi]=t,e[fi]=r,us(e,t),t.stateNode=e;e:{switch(u=ke(n,r),n){case"dialog":jr("cancel",e),jr("close",e),i=r;break;case"iframe":case"object":case"embed":jr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)jr(Lr[i],e);i=r;break;case"source":jr("error",e),i=r;break;case"img":case"image":case"link":jr("error",e),jr("load",e),i=r;break;case"details":jr("toggle",e),i=r;break;case"input":$(e,r),i=J(e,r),jr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=U({},r,{value:void 0}),jr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),jr("invalid",e)}for(o in ye(n,i),c=i)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&jr("scroll",e):null!=l&&k(e,o,l,u))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return ys(t),null;case 6:if(e&&null!=t.stateNode)ls(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Xa(Ya.current),Xa(Ja.current),ja(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(o=r.nodeValue!==n)&&null!==(e=Ia))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return ys(t),null;case 13:if(xi(ro),r=t.memoizedState,Da&&null!==Aa&&0!==(1&t.mode)&&0===(128&t.flags)){for(r=Aa;r;)r=ci(r.nextSibling);return Ba(),t.flags|=98560,t}if(null!==r&&null!==r.dehydrated){if(r=ja(t),null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[hi]=t}else Ba(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return ys(t),null}return null!==Na&&(ac(Na),Na=null),0!==(128&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?ja(t):n=null!==e.memoizedState,r!==n&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ro.current)?0===Au&&(Au=3):pc())),null!==t.updateQueue&&(t.flags|=4),ys(t),null);case 4:return eo(),null===e&&Gr(t.stateNode.containerInfo),ys(t),null;case 10:return $i(t.type._context),ys(t),null;case 19:if(xi(ro),null===(o=t.memoizedState))return ys(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)gs(o,!1);else{if(0!==Au||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=io(e))){for(t.flags|=128,gs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(ro,1&ro.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>ju&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=io(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!Da)return ys(t),null}else 2*Ye()-o.renderingStartTime>ju&&1073741824!==n&&(t.flags|=128,r=!0,gs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=ro.current,Ci(ro,r?1&n|2:1&n),t):(ys(t),null);case 22:case 23:return lc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&_u)&&(ys(t),6&t.subtreeFlags&&(t.flags|=8192)):ys(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}us=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},cs=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Xa(Ja.current);var a,o=null;switch(n){case"input":i=J(e,i),r=J(e,r),o=[];break;case"select":i=U({},i,{value:void 0}),r=U({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ye(n,r),n=null,i)if(!r.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var u=i[l];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=i?i[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(a in u)!u.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&u[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&jr("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},ls=function(e,t,n,r){n!==r&&(t.flags|=4)};var bs=b.ReactCurrentOwner,ws=!1;function Ss(e,t,n,r){t.child=null===e?qa(t,null,n,r):Wa(t,e.child,n,r)}function Ts(e,t,n,r,i){n=n.render;var a=t.ref;return Xi(t,i),r=bo(e,t,n,r,a,i),n=wo(),null===e||ws?(Da&&n&&Ra(t),t.flags|=1,Ss(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function Es(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Ac(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,xs(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Hs(e,t,i)}return t.flags|=1,(e=Dc(a,r)).ref=t.ref,e.return=t,t.child=e}function xs(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ur(a,r)&&e.ref===t.ref){if(ws=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Hs(e,t,i);0!==(131072&e.flags)&&(ws=!0)}}return Rs(e,t,n,r,i)}function Cs(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Iu,_u),_u|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Iu,_u),_u|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ci(Iu,_u),_u|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ci(Iu,_u),_u|=r;return Ss(e,t,i,n),t.child}function Ps(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Rs(e,t,n,r,i){var a=Di(n)?Ii:Ri.current;return a=Ai(t,a),Xi(t,i),n=bo(e,t,n,r,a,i),r=wo(),null===e||ws?(Da&&r&&Ra(t),t.flags|=1,Ss(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Hs(e,t,i))}function _s(e,t,n,r,i){if(Di(n)){var a=!0;Mi(t)}else a=!1;if(Xi(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),pa(t,n,r),ma(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Zi(c):c=Ai(t,c=Di(n)?Ii:Ri.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&va(t,o,r,c),ta=!1;var h=t.memoizedState;o.state=h,ua(t,r,o,i),u=t.memoizedState,s!==r||h!==u||_i.current||ta?("function"===typeof l&&(da(t,n,l,r),u=t.memoizedState),(s=ta||fa(t,n,s,r,h,u,c))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ra(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Hi(t.type,s),o.props=c,d=t.pendingProps,h=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Zi(u):u=Ai(t,u=Di(n)?Ii:Ri.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==u)&&va(t,o,r,u),ta=!1,h=t.memoizedState,o.state=h,ua(t,r,o,i);var p=t.memoizedState;s!==d||h!==p||_i.current||ta?("function"===typeof f&&(da(t,n,f,r),p=t.memoizedState),(c=ta||fa(t,n,c,r,h,p,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Is(e,t,n,r,a,i)}function Is(e,t,n,r,i,a){Ps(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Ui(t,n,!1),Hs(e,t,a);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Wa(t,e.child,null,a),t.child=Wa(t,null,s,a)):Ss(e,t,s,a),t.memoizedState=r.state,i&&Ui(t,n,!0),t.child}function As(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Za(e,t.containerInfo)}function Ds(e,t,n,r,i){return Ba(),Va(i),t.flags|=256,Ss(e,t,n,r),t.child}var Ns={dehydrated:null,treeContext:null,retryLane:0};function Os(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function Ms(e,t,n){var r,i=t.pendingProps,o=ro.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(ro,1&o),null===e)return Ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=i.children,e=i.fallback,s?(i=t.mode,s=t.child,o={mode:"hidden",children:o},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=o):s=Lc(o,i,0,null),e=Oc(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Os(n),t.memoizedState=Ns,e):Us(t,o));if(null!==(o=e.memoizedState)){if(null!==(r=o.dehydrated)){if(u)return 256&t.flags?(t.flags&=-257,Bs(e,t,n,Error(a(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=i.fallback,o=t.mode,i=Lc({mode:"visible",children:i.children},o,0,null),(s=Oc(s,o,n,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,0!==(1&t.mode)&&Wa(t,e.child,null,n),t.child.memoizedState=Os(n),t.memoizedState=Ns,s);if(0===(1&t.mode))t=Bs(e,t,n,null);else if("$!"===r.data)t=Bs(e,t,n,Error(a(419)));else if(i=0!==(n&e.childLanes),ws||i){if(null!==(i=Cu)){switch(n&-n){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(i=0!==(s&(i.suspendedLanes|n))?0:s)&&i!==o.retryLane&&(o.retryLane=i,Zu(e,i,-1))}pc(),t=Bs(e,t,n,Error(a(421)))}else"$?"===r.data?(t.flags|=128,t.child=e.child,t=Cc.bind(null,e),r._reactRetry=t,t=null):(n=o.treeContext,Aa=ci(r.nextSibling),Ia=t,Da=!0,Na=null,null!==n&&(wa[Sa++]=Ea,wa[Sa++]=xa,wa[Sa++]=Ta,Ea=n.id,xa=n.overflow,Ta=t),(t=Us(t,t.pendingProps.children)).flags|=4096);return t}return s?(i=js(e,t,i.children,i.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Os(n):Ls(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Ns,i):(n=Fs(e,t,i.children,n),t.memoizedState=null,n)}return s?(i=js(e,t,i.children,i.fallback,n),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?Os(n):Ls(o,n),s.childLanes=e.childLanes&~n,t.memoizedState=Ns,i):(n=Fs(e,t,i.children,n),t.memoizedState=null,n)}function Us(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fs(e,t,n,r){var i=e.child;return e=i.sibling,n=Dc(i,{mode:"visible",children:n}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n}function js(e,t,n,r,i){var a=t.mode,o=(e=e.child).sibling,s={mode:"hidden",children:n};return 0===(1&a)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=s,t.deletions=null):(n=Dc(e,s)).subtreeFlags=14680064&e.subtreeFlags,null!==o?r=Dc(o,r):(r=Oc(r,a,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Bs(e,t,n,r){return null!==r&&Va(r),Wa(t,e.child,null,n),(e=Us(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Vs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Yi(e.return,t,n)}function Gs(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function zs(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(Ss(e,t,r.children,n),0!==(2&(r=ro.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Vs(e,n,t);else if(19===e.tag)Vs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(ro,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===io(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Gs(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===io(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Gs(t,!0,n,null,a);break;case"together":Gs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Nu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ks(e,t){switch(_a(t),t.tag){case 1:return Di(t.type)&&Ni(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return eo(),xi(_i),xi(Ri),oo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return no(t),null;case 13:if(xi(ro),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));Ba()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(ro),null;case 4:return eo(),null;case 10:return $i(t.type._context),null;case 22:case 23:return lc(),null;default:return null}}var Ws=!1,qs=!1,Qs="function"===typeof WeakSet?WeakSet:Set,Js=null;function $s(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tc(e,t,r)}else n.current=null}function Ys(e,t,n){try{n()}catch(r){Tc(e,t,r)}}var Xs=!1;function Zs(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&Ys(t,n,a)}i=i.next}while(i!==r)}}function eu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function tu(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function nu(e){var t=e.alternate;null!==t&&(e.alternate=null,nu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[vi],delete t[mi],delete t[gi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ru(e){return 5===e.tag||3===e.tag||4===e.tag}function iu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ru(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function au(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(au(e,t,n),e=e.sibling;null!==e;)au(e,t,n),e=e.sibling}function ou(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ou(e,t,n),e=e.sibling;null!==e;)ou(e,t,n),e=e.sibling}var su=null,uu=!1;function cu(e,t,n){for(n=n.child;null!==n;)lu(e,t,n),n=n.sibling}function lu(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:qs||$s(n,t);case 6:var r=su,i=uu;su=null,cu(e,t,n),uu=i,null!==(su=r)&&(uu?(e=su,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):su.removeChild(n.stateNode));break;case 18:null!==su&&(uu?(e=su,n=n.stateNode,8===e.nodeType?ui(e.parentNode,n):1===e.nodeType&&ui(e,n),Gt(e)):ui(su,n.stateNode));break;case 4:r=su,i=uu,su=n.stateNode.containerInfo,uu=!0,cu(e,t,n),su=r,uu=i;break;case 0:case 11:case 14:case 15:if(!qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&Ys(n,t,o),i=i.next}while(i!==r)}cu(e,t,n);break;case 1:if(!qs&&($s(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Tc(n,t,s)}cu(e,t,n);break;case 21:cu(e,t,n);break;case 22:1&n.mode?(qs=(r=qs)||null!==n.memoizedState,cu(e,t,n),qs=r):cu(e,t,n);break;default:cu(e,t,n)}}function du(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qs),t.forEach((function(t){var r=Pc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function hu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:su=u.stateNode,uu=!1;break e;case 3:case 4:su=u.stateNode.containerInfo,uu=!0;break e}u=u.return}if(null===su)throw Error(a(160));lu(o,s,i),su=null,uu=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Tc(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fu(t,e),t=t.sibling}function fu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hu(t,e),pu(e),4&r){try{Zs(3,e,e.return),eu(3,e)}catch(v){Tc(e,e.return,v)}try{Zs(5,e,e.return)}catch(v){Tc(e,e.return,v)}}break;case 1:hu(t,e),pu(e),512&r&&null!==n&&$s(n,n.return);break;case 5:if(hu(t,e),pu(e),512&r&&null!==n&&$s(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(v){Tc(e,e.return,v)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Y(i,o),ke(u,s);var l=ke(u,o);for(s=0;s<c.length;s+=2){var d=c[s],h=c[s+1];"style"===d?me(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):k(i,d,h,l)}switch(u){case"input":X(i,o);break;case"textarea":ae(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(v){Tc(e,e.return,v)}}break;case 6:if(hu(t,e),pu(e),4&r){if(null===e.stateNode)throw Error(a(162));l=e.stateNode,d=e.memoizedProps;try{l.nodeValue=d}catch(v){Tc(e,e.return,v)}}break;case 3:if(hu(t,e),pu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Gt(t.containerInfo)}catch(v){Tc(e,e.return,v)}break;case 4:default:hu(t,e),pu(e);break;case 13:hu(t,e),pu(e),8192&(l=e.child).flags&&null!==l.memoizedState&&(null===l.alternate||null===l.alternate.memoizedState)&&(Fu=Ye()),4&r&&du(e);break;case 22:if(l=null!==n&&null!==n.memoizedState,1&e.mode?(qs=(d=qs)||l,hu(t,e),qs=d):hu(t,e),pu(e),8192&r){d=null!==e.memoizedState;e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,d?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=f.stateNode,s=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(v){Tc(e,e.return,v)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(v){Tc(e,e.return,v)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}if(d&&!l&&0!==(1&e.mode))for(Js=e,e=e.child;null!==e;){for(l=Js=e;null!==Js;){switch(h=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:Zs(4,d,d.return);break;case 1:if($s(d,d.return),"function"===typeof(o=d.stateNode).componentWillUnmount){f=d,p=d.return;try{i=f,o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(v){Tc(f,p,v)}}break;case 5:$s(d,d.return);break;case 22:if(null!==d.memoizedState){yu(l);continue}}null!==h?(h.return=d,Js=h):yu(l)}e=e.sibling}}break;case 19:hu(t,e),pu(e),4&r&&du(e);case 21:}}function pu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ru(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),ou(e,iu(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;au(e,iu(e),o);break;default:throw Error(a(161))}}catch(s){Tc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vu(e,t,n){Js=e,mu(e,t,n)}function mu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var i=Js,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ws;if(!o){var s=i.alternate,u=null!==s&&null!==s.memoizedState||qs;s=Ws;var c=qs;if(Ws=o,(qs=u)&&!c)for(Js=i;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?ku(i):null!==u?(u.return=o,Js=u):ku(i);for(;null!==a;)Js=a,mu(a,t,n),a=a.sibling;Js=i,Ws=s,qs=c}gu(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Js=a):gu(e)}}function gu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:qs||eu(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!qs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Hi(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ca(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ca(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Gt(h)}}}break;default:throw Error(a(163))}qs||512&t.flags&&tu(t)}catch(f){Tc(t,t.return,f)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function yu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{eu(4,t)}catch(u){Tc(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(u){Tc(t,i,u)}}var a=t.return;try{tu(t)}catch(u){Tc(t,a,u)}break;case 5:var o=t.return;try{tu(t)}catch(u){Tc(t,o,u)}}}catch(u){Tc(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var bu,wu=Math.ceil,Su=b.ReactCurrentDispatcher,Tu=b.ReactCurrentOwner,Eu=b.ReactCurrentBatchConfig,xu=0,Cu=null,Pu=null,Ru=0,_u=0,Iu=Ei(0),Au=0,Du=null,Nu=0,Ou=0,Lu=0,Mu=null,Uu=null,Fu=0,ju=1/0,Bu=null,Vu=!1,Gu=null,zu=null,Hu=!1,Ku=null,Wu=0,qu=0,Qu=null,Ju=-1,$u=0;function Yu(){return 0!==(6&xu)?Ye():-1!==Ju?Ju:Ju=Ye()}function Xu(e){return 0===(1&e.mode)?1:0!==(2&xu)&&0!==Ru?Ru&-Ru:null!==zi.transition?(0===$u&&($u=vt()),$u):0!==(e=kt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function Zu(e,t,n){if(50<qu)throw qu=0,Qu=null,Error(a(185));var r=ec(e,t);return null===r?null:(gt(r,t,n),0!==(2&xu)&&r===Cu||(r===Cu&&(0===(2&xu)&&(Ou|=t),4===Au&&oc(r,Ru)),nc(r,n),1===t&&0===xu&&0===(1&e.mode)&&(ju=Ye()+500,ji&&Gi())),r)}function ec(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function tc(e){return(null!==Cu||null!==ea)&&0!==(1&e.mode)&&0===(2&xu)}function nc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,u=i[o];-1===u?0!==(s&n)&&0===(s&r)||(i[o]=ft(s,t)):u<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ht(e,e===Cu?Ru:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){ji=!0,Vi(e)}(sc.bind(null,e)):Vi(sc.bind(null,e)),oi((function(){0===xu&&Gi()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Rc(n,rc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function rc(e,t){if(Ju=-1,$u=0,0!==(6&xu))throw Error(a(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=ht(e,e===Cu?Ru:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=xu;xu|=2;var o=fc();for(Cu===e&&Ru===t||(Bu=null,ju=Ye()+500,dc(e,t));;)try{gc();break}catch(u){hc(e,u)}Ji(),Su.current=o,xu=i,null!==Pu?t=0:(Cu=null,Ru=0,t=Au)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ic(e,i))),1===t)throw n=Du,dc(e,0),oc(e,r),nc(e,Ye()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Du,dc(e,0),oc(e,r),nc(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:bc(e,Uu,Bu);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Fu+500-Ye())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Yu(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bc.bind(null,e,Uu,Bu),t);break}bc(e,Uu,Bu);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*wu(r/1960))-r)){e.timeoutHandle=ri(bc.bind(null,e,Uu,Bu),r);break}bc(e,Uu,Bu);break;default:throw Error(a(329))}}}return nc(e,Ye()),e.callbackNode===n?rc.bind(null,e):null}function ic(e,t){var n=Mu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Uu,Uu=n,null!==t&&ac(t)),e}function ac(e){null===Uu?Uu=e:Uu.push.apply(Uu,e)}function oc(e,t){for(t&=~Lu,t&=~Ou,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(0!==(6&xu))throw Error(a(327));wc();var t=ht(e,0);if(0===(1&t))return nc(e,Ye()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Du,dc(e,0),oc(e,t),nc(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bc(e,Uu,Bu),nc(e,Ye()),null}function uc(e,t){var n=xu;xu|=1;try{return e(t)}finally{0===(xu=n)&&(ju=Ye()+500,ji&&Gi())}}function cc(e){null!==Ku&&0===Ku.tag&&0===(6&xu)&&wc();var t=xu;xu|=1;var n=Eu.transition,r=kt;try{if(Eu.transition=null,kt=1,e)return e()}finally{kt=r,Eu.transition=n,0===(6&(xu=t))&&Gi()}}function lc(){_u=Iu.current,xi(Iu)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pu)for(n=Pu.return;null!==n;){var r=n;switch(_a(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ni();break;case 3:eo(),xi(_i),xi(Ri),oo();break;case 5:no(r);break;case 4:eo();break;case 13:case 19:xi(ro);break;case 10:$i(r.type._context);break;case 22:case 23:lc()}n=n.return}if(Cu=e,Pu=e=Dc(e.current,null),Ru=_u=t,Au=0,Du=null,Lu=Ou=Nu=0,Uu=Mu=null,null!==ea){for(t=0;t<ea.length;t++)if(null!==(r=(n=ea[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}ea=null}return e}function hc(e,t){for(;;){var n=Pu;try{if(Ji(),so.current=ns,po){for(var r=lo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}po=!1}if(co=0,fo=ho=lo=null,vo=!1,mo=0,Tu.current=null,null===n||null===n.return){Au=1,Du=t,Pu=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Ru,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,d=u,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=vs(s);if(null!==p){p.flags&=-257,ms(p,s,u,0,t),1&p.mode&&ps(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){ps(o,l,t),pc();break e}c=Error(a(426))}else if(Da&&1&u.mode){var g=vs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ms(g,s,u,0,t),Va(c);break e}}o=c,4!==Au&&(Au=2),null===Mu?Mu=[o]:Mu.push(o),c=os(c,u),u=s;do{switch(u.tag){case 3:u.flags|=65536,t&=-t,u.lanes|=t,sa(u,hs(0,c,t));break e;case 1:o=c;var y=u.type,k=u.stateNode;if(0===(128&u.flags)&&("function"===typeof y.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===zu||!zu.has(k)))){u.flags|=65536,t&=-t,u.lanes|=t,sa(u,fs(u,o,t));break e}}u=u.return}while(null!==u)}kc(n)}catch(b){t=b,Pu===n&&null!==n&&(Pu=n=n.return);continue}break}}function fc(){var e=Su.current;return Su.current=ns,null===e?ns:e}function pc(){0!==Au&&3!==Au&&2!==Au||(Au=4),null===Cu||0===(268435455&Nu)&&0===(268435455&Ou)||oc(Cu,Ru)}function vc(e,t){var n=xu;xu|=2;var r=fc();for(Cu===e&&Ru===t||(Bu=null,dc(e,t));;)try{mc();break}catch(i){hc(e,i)}if(Ji(),xu=n,Su.current=r,null!==Pu)throw Error(a(261));return Cu=null,Ru=0,Au}function mc(){for(;null!==Pu;)yc(Pu)}function gc(){for(;null!==Pu&&!Je();)yc(Pu)}function yc(e){var t=bu(e.alternate,e,_u);e.memoizedProps=e.pendingProps,null===t?kc(e):Pu=t,Tu.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=ks(n,t,_u)))return void(Pu=n)}else{if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Pu=n);if(null===e)return Au=6,void(Pu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pu=t);Pu=t=e}while(null!==t);0===Au&&(Au=5)}function bc(e,t,n){var r=kt,i=Eu.transition;try{Eu.transition=null,kt=1,function(e,t,n,r){do{wc()}while(null!==Ku);if(0!==(6&xu))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Cu&&(Pu=Cu=null,Ru=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Hu||(Hu=!0,Rc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Eu.transition,Eu.transition=null;var s=kt;kt=1;var u=xu;xu|=4,Tu.current=null,function(e,t){if(ei=Ht,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(S){n=null;break e}var s=0,u=-1,c=-1,l=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(u=s+i),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++l===i&&(u=s),f===o&&++d===r&&(c=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,k=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Hi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var b=t.stateNode.containerInfo;if(1===b.nodeType)b.textContent="";else if(9===b.nodeType){var w=b.body;null!=w&&(w.textContent="")}break;default:throw Error(a(163))}}catch(S){Tc(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=Xs,Xs=!1}(e,n),fu(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,vu(n,e,i),$e(),xu=u,kt=s,Eu.transition=o}else e.current=n;if(Hu&&(Hu=!1,Ku=e,Wu=i),0===(o=e.pendingLanes)&&(zu=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(Vu)throw Vu=!1,e=Gu,Gu=null,e;0!==(1&Wu)&&0!==e.tag&&wc(),0!==(1&(o=e.pendingLanes))?e===Qu?qu++:(qu=0,Qu=e):qu=0,Gi()}(e,t,n,r)}finally{Eu.transition=i,kt=r}return null}function wc(){if(null!==Ku){var e=bt(Wu),t=Eu.transition,n=kt;try{if(Eu.transition=null,kt=16>e?16:e,null===Ku)var r=!1;else{if(e=Ku,Ku=null,Wu=0,0!==(6&xu))throw Error(a(331));var i=xu;for(xu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var d=Js;switch(d.tag){case 0:case 11:case 15:Zs(8,d,o)}var h=d.child;if(null!==h)h.return=d,Js=h;else for(;null!==Js;){var f=(d=Js).sibling,p=d.return;if(nu(d),d===l){Js=null;break}if(null!==f){f.return=p,Js=f;break}Js=p}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:Zs(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Js=y;break e}Js=o.return}}var k=e.current;for(Js=k;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=k;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:eu(9,u)}}catch(S){Tc(u,u.return,S)}if(u===s){Js=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,Js=w;break e}Js=u.return}}if(xu=i,Gi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(S){}r=!0}return r}finally{kt=n,Eu.transition=t}}return!1}function Sc(e,t,n){aa(e,t=hs(0,t=os(n,t),1)),t=Yu(),null!==(e=ec(e,1))&&(gt(e,1,t),nc(e,t))}function Tc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===zu||!zu.has(r))){aa(t,e=fs(t,e=os(n,e),1)),e=Yu(),null!==(t=ec(t,1))&&(gt(t,1,e),nc(t,e));break}}t=t.return}}function Ec(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Yu(),e.pingedLanes|=e.suspendedLanes&n,Cu===e&&(Ru&n)===n&&(4===Au||3===Au&&(130023424&Ru)===Ru&&500>Ye()-Fu?dc(e,0):Lu|=n),nc(e,t)}function xc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=Yu();null!==(e=ec(e,t))&&(gt(e,t,n),nc(e,n))}function Cc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xc(e,n)}function Pc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),xc(e,n)}function Rc(e,t){return qe(e,t)}function _c(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new _c(e,t,n,r)}function Ac(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nc(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Ac(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case T:return Oc(n.children,i,o,t);case E:s=8,i|=8;break;case x:return(e=Ic(12,n,t,2|i)).elementType=x,e.lanes=o,e;case _:return(e=Ic(13,n,t,i)).elementType=_,e.lanes=o,e;case I:return(e=Ic(19,n,t,i)).elementType=I,e.lanes=o,e;case N:return Lc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case P:s=9;break e;case R:s=11;break e;case A:s=14;break e;case D:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Ic(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Oc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=N,e.lanes=n,e.stateNode={},e}function Mc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function jc(e,t,n,r,i,a,o,s,u){return e=new Fc(e,t,n,s,u),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Ic(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},na(a),e}function Bc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Vc(e){if(!e)return Pi;e:{if(Ge(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Di(n))return Li(e,n,t)}return t}function Gc(e,t,n,r,i,a,o,s,u){return(e=jc(n,r,!0,e,0,a,0,s,u)).context=Vc(null),n=e.current,(a=ia(r=Yu(),i=Xu(n))).callback=void 0!==t&&null!==t?t:null,aa(n,a),e.current.lanes=i,gt(e,i,r),nc(e,r),e}function zc(e,t,n,r){var i=t.current,a=Yu(),o=Xu(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=ia(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),aa(i,t),null!==(e=Zu(i,o,a))&&oa(e,i,o),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}bu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_i.current)ws=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ws=!1,function(e,t,n){switch(t.tag){case 3:As(t),Ba();break;case 5:to(t);break;case 1:Di(t.type)&&Mi(t);break;case 4:Za(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(Ki,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(ro,1&ro.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ms(e,t,n):(Ci(ro,1&ro.current),null!==(e=Hs(e,t,n))?e.sibling:null);Ci(ro,1&ro.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return zs(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(ro,ro.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Hs(e,t,n)}(e,t,n);ws=0!==(131072&e.flags)}else ws=!1,Da&&0!==(1048576&t.flags)&&Pa(t,ba,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=Ai(t,Ri.current);Xi(t,n),i=bo(null,t,r,e,i,n);var o=wo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(r)?(o=!0,Mi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,na(t),i.updater=ha,t.stateNode=i,i._reactInternals=t,ma(t,r,e,n),t=Is(null,t,r,!0,o,n)):(t.tag=0,Da&&o&&Ra(t),Ss(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Ac(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===R)return 11;if(e===A)return 14}return 2}(r),e=Hi(r,e),i){case 0:t=Rs(null,t,r,e,n);break e;case 1:t=_s(null,t,r,e,n);break e;case 11:t=Ts(null,t,r,e,n);break e;case 14:t=Es(null,t,r,Hi(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Rs(e,t,r,i=t.elementType===r?i:Hi(r,i),n);case 1:return r=t.type,i=t.pendingProps,_s(e,t,r,i=t.elementType===r?i:Hi(r,i),n);case 3:e:{if(As(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,ra(e,t),ua(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ds(e,t,r,n,i=Error(a(423)));break e}if(r!==i){t=Ds(e,t,r,n,i=Error(a(424)));break e}for(Aa=ci(t.stateNode.containerInfo.firstChild),Ia=t,Da=!0,Na=null,n=qa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Ba(),r===i){t=Hs(e,t,n);break e}Ss(e,t,r,n)}t=t.child}return t;case 5:return to(t),null===e&&Ua(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Ps(e,t),Ss(e,t,s,n),t.child;case 6:return null===e&&Ua(t),null;case 13:return Ms(e,t,n);case 4:return Za(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Wa(t,null,r,n):Ss(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ts(e,t,r,i=t.elementType===r?i:Hi(r,i),n);case 7:return Ss(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ss(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ci(Ki,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!_i.current){t=Hs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=ia(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Yi(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Yi(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}Ss(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Xi(t,n),r=r(i=Zi(i)),t.flags|=1,Ss(e,t,r,n),t.child;case 14:return i=Hi(r=t.type,t.pendingProps),Es(e,t,r,i=Hi(r.type,i),n);case 15:return xs(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Hi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Di(r)?(e=!0,Mi(t)):e=!1,Xi(t,n),pa(t,r,i),ma(t,r,i,n),Is(null,t,r,!0,e,n);case 19:return zs(e,t,n);case 22:return Cs(e,t,n)}throw Error(a(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=Hc(o);s.call(e)}}zc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Hc(o);a.call(e)}}var o=Gc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=o,e[pi]=o.current,Gr(8===e.nodeType?e.parentNode:e),cc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=Hc(u);s.call(e)}}var u=jc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=u,e[pi]=u.current,Gr(8===e.nodeType?e.parentNode:e),cc((function(){zc(t,u,n,r)})),u}(n,t,e,i,r);return Hc(o)}Jc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));zc(e,t,null,null)},Jc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;cc((function(){zc(null,e,null,null)})),t[pi]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nt.length&&0!==t&&t<Nt[n].priority;n++);Nt.splice(n,0,e),0===n&&Ut(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),nc(t,Ye()),0===(6&xu)&&(ju=Ye()+500,Gi()))}break;case 13:var r=Yu();cc((function(){return Zu(e,1,r)})),Wc(e,1)}},St=function(e){13===e.tag&&(Zu(e,134217728,Yu()),Wc(e,134217728))},Tt=function(e){if(13===e.tag){var t=Yu(),n=Xu(e);Zu(e,n,t),Wc(e,n)}},Et=function(){return kt},xt=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},Se=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(a(90));q(r),X(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Re=uc,_e=cc;var el={usingClientEntryPoint:!1,Events:[ki,bi,wi,Ce,Pe,uc]},tl={findFiberByHostInstance:yi,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},nl={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rl.isDisabled&&rl.supportsFiber)try{it=rl.inject(nl),at=rl}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=el,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(a(200));return Bc(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(a(299));var n=!1,r="",i=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=jc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Gr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return cc(e)},t.hydrate=function(e,t,n){if(!Yc(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Gc(t,null,e,1,null!=n?n:null,i,0,o,s),e[pi]=t.current,Gr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Jc(t)},t.render=function(e,t,n){if(!Yc(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yc(e))throw Error(a(40));return!!e._reactRootContainer&&(cc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,r)},t.version="18.1.0-next-22edb9f77-20220426"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){"use strict";var r=n(791),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:l,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function k(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var b=k.prototype=new y;b.constructor=k,v(b,g.prototype),b.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,T={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)S.call(t,i)&&!E.hasOwnProperty(i)&&(a[i]=t[i]);var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];a.children=c}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===a[i]&&(a[i]=u[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:T.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===a?"."+R(u,0):a,w(o)?(i="",null!=e&&(i=e.replace(P,"$&/")+"/"),_(o,t,i,"",(function(e){return e}))):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(P,"$&/")+"/")+e)),t.push(o)),1;if(u=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var l=a+R(s=e[c],c);u+=_(s,t,i,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=_(s=s.value,t,i,l=a+R(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function I(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},N={transition:null},O={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:N,ReactCurrentOwner:T};t.Children={map:I,forEach:function(e,t,n){I(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return I(e,(function(){t++})),t},toArray:function(e){return I(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=i,t.Profiler=o,t.PureComponent=k,t.StrictMode=a,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=v({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=T.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)S.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=x,t.createFactory=function(e){var t=x.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.transition;N.transition={};try{e()}finally{N.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.1.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>a(u,n))c<i&&0>a(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<i&&0>a(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],d=1,h=null,f=3,p=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(m=!1,b(e),!v)if(null!==r(c))v=!0,N(S);else{var t=r(l);null!==t&&O(w,t.startTime-e)}}function S(e,n){v=!1,m&&(m=!1,y(C),C=-1),p=!0;var a=f;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!_());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&i(c),b(n)}else i(c);h=r(c)}if(null!==h)var u=!0;else{var d=r(l);null!==d&&O(w,d.startTime-n),u=!1}return u}finally{h=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,E=!1,x=null,C=-1,P=5,R=-1;function _(){return!(t.unstable_now()-R<P)}function I(){if(null!==x){var e=t.unstable_now();R=e;var n=!0;try{n=x(!0,e)}finally{n?T():(E=!1,x=null)}}else E=!1}if("function"===typeof k)T=function(){k(I)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=I,T=function(){D.postMessage(null)}}else T=function(){g(I,0)};function N(e){x=e,E||(E=!0,T())}function O(e,n){C=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,N(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(l,e),null===r(c)&&e===r(l)&&(m?(y(C),C=-1):m=!0,O(w,a-o))):(e.sortIndex=s,n(c,e),v||p||(v=!0,N(S))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},712:function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},861:function(e,t,n){var r=n(775),i=n(921);t.cW=i,t.Qc=r.parse,r.parseParams,r.parseFmtpConfig,r.parsePayloads,r.parseRemoteCandidates,r.parseImageAttributes,r.parseSimulcastStreamList},775:function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var a=0;a<n.length;a+=1)null!=e[a+1]&&(t[n[a]]=r(e[a+1]))}(n.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},a=n(712),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var u=a[t][s];if(u.reg.test(o))return i(u,r,o)}})),t.media=n,t};var s=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},921:function(e,t,n){var r=n(712),i=/%[sdv%]/g,a=function(e){var t=1,n=arguments,r=n.length;return e.replace(i,(function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},o=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var o=t.names[i];t.name?r.push(n[t.name][o]):r.push(n[t.names[i]])}else r.push(n[t.name]);return a.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],u=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||s,i=t.innerOrder||u,a=[];return n.forEach((function(t){r[t].forEach((function(n){n.name in e&&null!=e[n.name]?a.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){a.push(o(t,n,e))}))}))})),e.media.forEach((function(e){a.push(o("m",r.m[0],e)),i.forEach((function(t){r[t].forEach((function(n){n.name in e&&null!=e[n.name]?a.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){a.push(o(t,n,e))}))}))}))})),a.join("\r\n")+"\r\n"}},800:function(e){"use strict";var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:void 0===n[t[r]]&&(n[t[r]]=t[r+1])}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation);var n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){void 0!==e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){var t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var a=r[i],o=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(o){var s=t.parseRtpMap(o),u=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(s.parameters=u.length?t.parseFmtp(u[0]):{},s.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(t.parseRtcpFb),n.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(s.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),a=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),u=s.length>0&&s[0].ssrc,c=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));c.length>0&&c[0].length>1&&c[0][0]===u&&(n=c[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:u,codecPayloadType:parseInt(e.parameters.apt,10)};u&&n&&(t.rtx={ssrc:n}),r.push(t),a&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:u,mechanism:o?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&u&&r.push({ssrc:u});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var a=t.matchPrefix(e,"a=rtcp-mux");return n.mux=a.length>0,n},t.writeRtcpParameters=function(e){var t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var a=t.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};var o=t.matchPrefix(e,"a=sctpmap:");if(o.length>0){var s=o[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t},210:function(e,t,n){var r;!function(i,a){"use strict";var o="function",s="undefined",u="object",c="string",l="model",d="name",h="type",f="vendor",p="version",v="architecture",m="console",g="mobile",y="tablet",k="smarttv",b="wearable",w="embedded",S="Amazon",T="Apple",E="ASUS",x="BlackBerry",C="Firefox",P="Google",R="Huawei",_="LG",I="Microsoft",A="Motorola",D="Opera",N="Samsung",O="Sony",L="Xiaomi",M="Zebra",U="Facebook",F=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},j=function(e,t){return typeof e===c&&-1!==B(t).indexOf(B(e))},B=function(e){return e.toLowerCase()},V=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255)},G=function(e,t){for(var n,r,i,s,c,l,d=0;d<t.length&&!c;){var h=t[d],f=t[d+1];for(n=r=0;n<h.length&&!c;)if(c=h[n++].exec(e))for(i=0;i<f.length;i++)l=c[++r],typeof(s=f[i])===u&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,l):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=l?l.replace(s[1],s[2]):a:this[s[0]]=l?s[1].call(this,l,s[2]):a:4===s.length&&(this[s[0]]=l?s[3].call(this,l.replace(s[1],s[2])):a):this[s]=l||a;d+=2}},z=function(e,t){for(var n in t)if(typeof t[n]===u&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(j(t[n][r],e))return"?"===n?a:n}else if(j(t[n],e))return"?"===n?a:n;return e},H={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},K={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,p],[/opios[\/ ]+([\w\.]+)/i],[p,[d,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[p,[d,D]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[d,p],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[d,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[p,[d,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[p,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[d,"IE"]],[/yabrowser\/([\w\.]+)/i],[p,[d,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure Browser"],p],[/\bfocus\/([\w\.]+)/i],[p,[d,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[p,[d,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[d,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[d,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[p,[d,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[d,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 Browser"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[d,p],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,U],p],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[d,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[d,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[d,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,"Chrome WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[d,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,p],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[p,[d,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[p,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[p,z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[d,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[d,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[v,"amd64"]],[/(ia32(?=;))/i],[[v,B]],[/((?:i[346]|x)86)[;\)]/i],[[v,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[v,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[v,"armhf"]],[/windows (ce|mobile); ppc;/i],[[v,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[v,/ower/,"",B]],[/(sun4\w)[;\)]/i],[[v,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[v,B]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[f,N],[h,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[f,N],[h,g]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[f,T],[h,g]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[f,T],[h,y]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[f,R],[h,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[l,[f,R],[h,g]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[f,L],[h,g]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[f,L],[h,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[f,"OPPO"],[h,g]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[f,"Vivo"],[h,g]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[f,"Realme"],[h,g]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[f,A],[h,g]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[f,A],[h,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[f,_],[h,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[f,_],[h,g]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[f,"Lenovo"],[h,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[f,"Nokia"],[h,g]],[/(pixel c)\b/i],[l,[f,P],[h,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[f,P],[h,g]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[f,O],[h,g]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[f,O],[h,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[f,"OnePlus"],[h,g]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[f,S],[h,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[f,S],[h,g]],[/(playbook);[-\w\),; ]+(rim)/i],[l,f,[h,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[f,x],[h,g]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[f,E],[h,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[f,E],[h,g]],[/(nexus 9)/i],[l,[f,"HTC"],[h,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[f,[l,/_/g," "],[h,g]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[f,"Acer"],[h,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[f,"Meizu"],[h,g]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[f,"Sharp"],[h,g]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,l,[h,g]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,l,[h,y]],[/(surface duo)/i],[l,[f,I],[h,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[f,"Fairphone"],[h,g]],[/(u304aa)/i],[l,[f,"AT&T"],[h,g]],[/\bsie-(\w*)/i],[l,[f,"Siemens"],[h,g]],[/\b(rct\w+) b/i],[l,[f,"RCA"],[h,y]],[/\b(venue[\d ]{2,7}) b/i],[l,[f,"Dell"],[h,y]],[/\b(q(?:mv|ta)\w+) b/i],[l,[f,"Verizon"],[h,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[f,"Barnes & Noble"],[h,y]],[/\b(tm\d{3}\w+) b/i],[l,[f,"NuVision"],[h,y]],[/\b(k88) b/i],[l,[f,"ZTE"],[h,y]],[/\b(nx\d{3}j) b/i],[l,[f,"ZTE"],[h,g]],[/\b(gen\d{3}) b.+49h/i],[l,[f,"Swiss"],[h,g]],[/\b(zur\d{3}) b/i],[l,[f,"Swiss"],[h,y]],[/\b((zeki)?tb.*\b) b/i],[l,[f,"Zeki"],[h,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],l,[h,y]],[/\b(ns-?\w{0,9}) b/i],[l,[f,"Insignia"],[h,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[f,"NextBook"],[h,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],l,[h,g]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],l,[h,g]],[/\b(ph-1) /i],[l,[f,"Essential"],[h,g]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[f,"Envizen"],[h,y]],[/\b(trio[-\w\. ]+) b/i],[l,[f,"MachSpeed"],[h,y]],[/\btu_(1491) b/i],[l,[f,"Rotor"],[h,y]],[/(shield[\w ]+) b/i],[l,[f,"Nvidia"],[h,y]],[/(sprint) (\w+)/i],[f,l,[h,g]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[f,I],[h,g]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[f,M],[h,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[f,M],[h,g]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,l,[h,m]],[/droid.+; (shield) bui/i],[l,[f,"Nvidia"],[h,m]],[/(playstation [345portablevi]+)/i],[l,[f,O],[h,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[f,I],[h,m]],[/smart-tv.+(samsung)/i],[f,[h,k]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[f,N],[h,k]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,_],[h,k]],[/(apple) ?tv/i],[f,[l,"Apple TV"],[h,k]],[/crkey/i],[[l,"Chromecast"],[f,P],[h,k]],[/droid.+aft(\w)( bui|\))/i],[l,[f,S],[h,k]],[/\(dtv[\);].+(aquos)/i],[l,[f,"Sharp"],[h,k]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[f,V],[l,V],[h,k]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,k]],[/((pebble))app/i],[f,l,[h,b]],[/droid.+; (glass) \d/i],[l,[f,P],[h,b]],[/droid.+; (wt63?0{2,3})\)/i],[l,[f,M],[h,b]],[/(quest( 2)?)/i],[l,[f,U],[h,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,w]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[h,g]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[h,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,y]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[h,g]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[d,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,p],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[d,[p,z,H]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[d,"Windows"],[p,z,H]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,"Mac OS"],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[p,d],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[d,p],[/\(bb(10);/i],[p,[d,x]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[d,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[d,"webOS"]],[/crkey\/([\d\.]+)/i],[p,[d,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[d,"Chromium OS"],p],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,p],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[d,p]]},W=function e(t,n){if(typeof t===u&&(n=t,t=a),!(this instanceof e))return new e(t,n).getResult();var r=t||(typeof i!==s&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),o=n?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2===0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(K,n):K;return this.getBrowser=function(){var e,t={};return t.name=a,t.version=a,G.call(t,r,o.browser),t.major=typeof(e=t.version)===c?e.replace(/[^\d\.]/g,"").split(".")[0]:a,t},this.getCPU=function(){var e={};return e.architecture=a,G.call(e,r,o.cpu),e},this.getDevice=function(){var e={};return e.vendor=a,e.model=a,e.type=a,G.call(e,r,o.device),e},this.getEngine=function(){var e={};return e.name=a,e.version=a,G.call(e,r,o.engine),e},this.getOS=function(){var e={};return e.name=a,e.version=a,G.call(e,r,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===c&&e.length>255?V(e,255):e,this},this.setUA(r),this};W.VERSION="1.0.2",W.BROWSER=F([d,p,"major"]),W.CPU=F([v]),W.DEVICE=F([l,f,h,m,g,k,y,b,w]),W.ENGINE=W.OS=F([d,p]),typeof t!==s?(e.exports&&(t=e.exports=W),t.UAParser=W):n.amdO?(r=function(){return W}.call(t,n,t,e))===a||(e.exports=r):typeof i!==s&&(i.UAParser=W);var q=typeof i!==s&&(i.jQuery||i.Zepto);if(q&&!q.ua){var Q=new W;q.ua=Q.getResult(),q.ua.get=function(){return Q.getUA()},q.ua.set=function(e){Q.setUA(e);var t=Q.getResult();for(var n in t)q.ua[n]=t[n]}}}("object"===typeof window?window:this)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".3051c35f.chunk.js"},n.miniCssF=function(e){},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="zoomclone:";n.l=function(r,i,a,o){if(e[r])e[r].push(i);else{var s,u;if(void 0!==a)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var h=function(t,n){s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((function(n,r){i=e[t]=[n,r]}));r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var i,a,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)u(n)}for(t&&t(r);c<o.length;c++)a=o[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkzoomclone=self.webpackChunkzoomclone||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e={};n.r(e),n.d(e,{fixNegotiationNeeded:function(){return nt},shimAddTrackRemoveTrack:function(){return et},shimAddTrackRemoveTrackWithNative:function(){return Ze},shimGetDisplayMedia:function(){return qe},shimGetSendersWithDtmf:function(){return $e},shimGetStats:function(){return Ye},shimGetUserMedia:function(){return We},shimMediaStream:function(){return Qe},shimOnTrack:function(){return Je},shimPeerConnection:function(){return tt},shimSenderReceiverGetStats:function(){return Xe}});var t={};n.r(t),n.d(t,{shimAddTransceiver:function(){return dt},shimCreateAnswer:function(){return pt},shimCreateOffer:function(){return ft},shimGetDisplayMedia:function(){return it},shimGetParameters:function(){return ht},shimGetUserMedia:function(){return rt},shimOnTrack:function(){return at},shimPeerConnection:function(){return ot},shimRTCDataChannel:function(){return lt},shimReceiverGetStats:function(){return ut},shimRemoveStream:function(){return ct},shimSenderGetStats:function(){return st}});var r={};n.r(r),n.d(r,{shimAudioContext:function(){return Tt},shimCallbacksAPI:function(){return gt},shimConstraints:function(){return kt},shimCreateOfferLegacy:function(){return St},shimGetUserMedia:function(){return yt},shimLocalStreamsAPI:function(){return vt},shimRTCIceServerUrls:function(){return bt},shimRemoteStreamsAPI:function(){return mt},shimTrackEventTransceiver:function(){return wt}});var i={};n.r(i),n.d(i,{removeExtmapAllowMixed:function(){return It},shimAddIceCandidateNullOrEmpty:function(){return At},shimConnectionState:function(){return _t},shimMaxMessageSize:function(){return Pt},shimParameterlessSetLocalDescription:function(){return Dt},shimRTCIceCandidate:function(){return Ct},shimSendThrowTypeError:function(){return Rt}});var a=n(791),o=n(250);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(){u=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(R){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,a=Object.create(i.prototype),o=new x(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return P()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}e.wrap=l;var h={};function f(){}function p(){}function v(){}var m={};c(m,i,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(C([])));y&&y!==t&&n.call(y,i)&&(m=y);var k=v.prototype=f.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(i,a,o,u){var c=d(e[i],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==s(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,o,u)}),(function(e){r("throw",e,o,u)})):t.resolve(h).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,u)}))}u(c.arg)}var i;this._invoke=function(e,n){function a(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(a,a):a()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=d(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,h;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=v,c(k,"constructor",v),c(v,"constructor",p),p.displayName=c(v,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,o,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new w(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(k),c(k,o,"Generator"),c(k,i,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}function c(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||h(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function b(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function w(e){return!!e&&!!e[ue]}function S(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===ce}(e)||Array.isArray(e)||!!e[se]||!!e.constructor[se]||_(e)||I(e))}function T(e,t,n){void 0===n&&(n=!1),0===E(e)?(n?Object.keys:le)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function E(e){var t=e[ue];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:_(e)?2:I(e)?3:0}function x(e,t){return 2===E(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function C(e,t){return 2===E(e)?e.get(t):e[t]}function P(e,t,n){var r=E(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function R(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function _(e){return re&&e instanceof Map}function I(e){return ie&&e instanceof Set}function A(e){return e.o||e.t}function D(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=de(e);delete t[ue];for(var n=le(t),r=0;r<n.length;r++){var i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function N(e,t){return void 0===t&&(t=!1),L(e)||w(e)||!S(e)||(E(e)>1&&(e.set=e.add=e.clear=e.delete=O),Object.freeze(e),t&&T(e,(function(e,t){return N(t,!0)}),!0)),e}function O(){b(2)}function L(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function M(e){var t=he[e];return t||b(18,e),t}function U(){return te}function F(e,t){t&&(M("Patches"),e.u=[],e.s=[],e.v=t)}function j(e){B(e),e.p.forEach(G),e.p=null}function B(e){e===te&&(te=e.l)}function V(e){return te={p:[],l:te,h:e,m:!0,_:0}}function G(e){var t=e[ue];0===t.i||1===t.i?t.j():t.O=!0}function z(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||M("ES5").S(t,e,r),r?(n[ue].P&&(j(t),b(4)),S(e)&&(e=H(t,e),t.l||W(t,e)),t.u&&M("Patches").M(n[ue].t,e,t.u,t.s)):e=H(t,n,[]),j(t),t.u&&t.v(t.u,t.s),e!==oe?e:void 0}function H(e,t,n){if(L(t))return t;var r=t[ue];if(!r)return T(t,(function(i,a){return K(e,r,t,i,a,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return W(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=D(r.k):r.o;T(3===r.i?new Set(i):i,(function(t,a){return K(e,r,i,t,a,n)})),W(e,i,!1),n&&e.u&&M("Patches").R(r,n,e.u,e.s)}return r.o}function K(e,t,n,r,i,a){if(w(i)){var o=H(e,i,a&&t&&3!==t.i&&!x(t.D,r)?a.concat(r):void 0);if(P(n,r,o),!w(o))return;e.m=!1}if(S(i)&&!L(i)){if(!e.h.F&&e._<1)return;H(e,i),t&&t.A.l||W(e,i)}}function W(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&N(t,n)}function q(e,t){var n=e[ue];return(n?A(n):e)[t]}function Q(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function J(e){e.P||(e.P=!0,e.l&&J(e.l))}function $(e){e.o||(e.o=D(e.t))}function Y(e,t,n){var r=_(t)?M("MapSet").N(t,n):I(t)?M("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:U(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,a=fe;n&&(i=[r],a=pe);var o=Proxy.revocable(i,a),s=o.revoke,u=o.proxy;return r.k=u,r.j=s,u}(t,n):M("ES5").J(t,n);return(n?n.A:U()).p.push(r),r}function X(e){return w(e)||b(22,e),function e(t){if(!S(t))return t;var n,r=t[ue],i=E(t);if(r){if(!r.P&&(r.i<4||!M("ES5").K(r)))return r.t;r.I=!0,n=Z(t,i),r.I=!1}else n=Z(t,i);return T(n,(function(t,i){r&&C(r.t,t)===i||P(n,t,e(i))})),3===i?new Set(n):n}(e)}function Z(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return D(e)}var ee,te,ne="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),re="undefined"!=typeof Map,ie="undefined"!=typeof Set,ae="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,oe=ne?Symbol.for("immer-nothing"):((ee={})["immer-nothing"]=!0,ee),se=ne?Symbol.for("immer-draftable"):"__$immer_draftable",ue=ne?Symbol.for("immer-state"):"__$immer_state",ce=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),le="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,de=Object.getOwnPropertyDescriptors||function(e){var t={};return le(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},he={},fe={get:function(e,t){if(t===ue)return e;var n=A(e);if(!x(n,t))return function(e,t,n){var r,i=Q(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!S(r)?r:r===q(e.t,t)?($(e),e.o[t]=Y(e.A.h,r,e)):r},has:function(e,t){return t in A(e)},ownKeys:function(e){return Reflect.ownKeys(A(e))},set:function(e,t,n){var r=Q(A(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=q(A(e),t),a=null==i?void 0:i[ue];if(a&&a.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(R(n,i)&&(void 0!==n||x(e.t,t)))return!0;$(e),J(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==q(e.t,t)||t in e.t?(e.D[t]=!1,$(e),J(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=A(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){b(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){b(12)}},pe={};T(fe,(function(e,t){pe[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),pe.deleteProperty=function(e,t){return pe.set.call(this,e,t,void 0)},pe.set=function(e,t,n){return fe.set.call(this,e[0],t,n,e[0])};var ve=function(){function e(e){var t=this;this.g=ae,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return a.produce(e,(function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))}))}}var o;if("function"!=typeof n&&b(6),void 0!==r&&"function"!=typeof r&&b(7),S(e)){var s=V(t),u=Y(t,e,void 0),c=!0;try{o=n(u),c=!1}finally{c?j(s):B(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return F(s,r),z(e,s)}),(function(e){throw j(s),e})):(F(s,r),z(o,s))}if(!e||"object"!=typeof e){if(void 0===(o=n(e))&&(o=e),o===oe&&(o=void 0),t.F&&N(o,!0),r){var l=[],d=[];M("Patches").M(e,o,l,d),r(l,d)}return o}b(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,(function(t){return e.apply(void 0,[t].concat(i))}))};var r,i,a=t.produce(e,n,(function(e,t){r=e,i=t}));return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return[e,r,i]})):[a,r,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){S(e)||b(8),w(e)&&(e=X(e));var t=V(this),n=Y(this,e,void 0);return n[ue].C=!0,B(t),n},t.finishDraft=function(e,t){var n=(e&&e[ue]).A;return F(n,t),z(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!ae&&b(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));var i=M("Patches").$;return w(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),me=new ve,ge=me.produce,ye=(me.produceWithPatches.bind(me),me.setAutoFreeze.bind(me),me.setUseProxies.bind(me),me.applyPatches.bind(me),me.createDraft.bind(me),me.finishDraft.bind(me),ge);var ke=function(e){var t,n=new Set,r=function(e,r){var i="function"===typeof e?e(t):e;if(i!==t){var a=t;t=r?i:Object.assign({},t,i),n.forEach((function(e){return e(t,a)}))}},i=function(){return t},a={setState:r,getState:i,subscribe:function(e,r,a){return r||a?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is,o=r(t);function s(){var n=r(t);if(!a(o,n)){var i=o;e(o=n,i)}}return n.add(s),function(){return n.delete(s)}}(e,r,a):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,i,a),a};var be=function(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0};function we(e){return we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},we(e)}function Se(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=we(e)););return e}function Te(){return Te="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Se(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},Te.apply(this,arguments)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xe(e,t){return xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xe(e,t)}function Ce(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xe(e,t)}function Pe(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function Re(e,t){if(t&&("object"===s(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ee(e)}function _e(e){var t=Pe();return function(){var n,r=we(e);if(t){var i=we(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Re(this,n)}}function Ie(e,t,n){return Ie=Pe()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&xe(i,n.prototype),i},Ie.apply(null,arguments)}function Ae(e){var t="function"===typeof Map?new Map:void 0;return Ae=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Ie(e,arguments,we(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),xe(n,e)},Ae(e)}var De=!0,Ne=!0;function Oe(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function Le(e,t,n){if(e.RTCPeerConnection){var r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);var a=function(e){var t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,a),i.apply(this,[e,a])};var a=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);var r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function Me(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(De=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Ue(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Ne=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Fe(){if("object"===typeof window){if(De)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function je(e,t){Ne&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Be(e){var t={browser:null,version:null};if("undefined"===typeof e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=Oe(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=Oe(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Oe(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function Ve(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ge(e){return Ve(e)?Object.keys(e).reduce((function(t,n){var r=Ve(e[n]),i=r?Ge(e[n]):e[n],a=r&&!Object.keys(i).length;return void 0===i||a?t:Object.assign(t,p({},n,i))}),{}):e}function ze(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(r){r.endsWith("Id")?ze(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach((function(t){ze(e,e.get(t),n)}))})))}function He(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(n){n.type===r&&n.trackId===t.id&&ze(e,n,i)}))})),i}var Ke=Fe;function We(e,t){var n=e&&e.navigator;if(n.mediaDevices){var r=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"===typeof r.exact&&(r.min=r.max=r.exact);var i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"===typeof r.ideal?(a[i("min",n)]=r.ideal,t.optional.push(a),(a={})[i("max",n)]=r.ideal,t.optional.push(a)):(a[i("",n)]=r.ideal,t.optional.push(a))}void 0!==r.exact&&"number"!==typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){var a=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};a((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),a(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"===typeof e.video){var o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});var s,u=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||u))if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?s=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(s=["front"]),s)return n.mediaDevices.enumerateDevices().then((function(t){t=t.filter((function(e){return"videoinput"===e.kind}));var n=t.find((function(e){return s.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&s.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=o.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),Ke("chrome: "+JSON.stringify(e)),i(e)}));e.video=r(e.video)}return Ke("chrome: "+JSON.stringify(e)),i(e)},a=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){r&&r(a(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return o(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(a(e))}))}))}}}}function qe(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"===typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function Qe(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Je(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.track.id})):{track:r.track};var a=new Event("track");a.track=r.track,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)})),t.stream.getTracks().forEach((function(r){var i;i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===r.id})):{track:r};var a=new Event("track");a.track=r,a.receiver=i,a.transceiver={receiver:i},a.streams=[t.stream],n.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Le(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))}function $e(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Ye(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],a=n[2];if(arguments.length>0&&"function"===typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!==typeof r))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},s=function(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var u=function(e){i(s(o(e)))};return t.apply(this,[u,r])}return new Promise((function(n,r){t.apply(e,[function(e){n(s(o(e)))},r])})).then(i,a)}}}function Xe(e){if("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return He(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),Le(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return He(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,a=arguments[0];return this.getSenders().forEach((function(e){e.track===a&&(t?r=!0:t=e)})),this.getReceivers().forEach((function(e){return e.track===a&&(n?r=!0:n=e),e.track===a})),r||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function Ze(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter((function(e){return-1===r.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),i.apply(this,arguments)}}function et(e,t){if(e.RTCPeerConnection){if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Ze(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}r.apply(this,[t])};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=this.getSenders().find((function(e){return e.track===t}));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var o=this._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then((function(){r.dispatchEvent(new Event("negotiationneeded"))}));else{var s=new e.MediaStream([t]);this._streams[n.id]=s,this._reverseStreams[s.id]=n,this.addStream(s)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=p({},t,(function(){var e=this,t=arguments,r=arguments.length&&"function"===typeof arguments[0];return r?n.apply(this,[function(n){var r=s(e,n);t[0].apply(null,[r])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return s(e,t)}))}));e.RTCPeerConnection.prototype[t]=r[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=u(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var o=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=o.get.apply(this);return""===e.type?e:s(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},Object.keys(this._streams).forEach((function(r){n._streams[r].getTracks().find((function(t){return e.track===t}))&&(t=n._streams[r])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function s(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function u(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}}function tt(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=p({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}))}function nt(e,t){Le(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}function rt(e,t){var n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){je("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===typeof e&&"object"===typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===typeof e&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function it(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){var r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}function at(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function ot(e,t){if("object"===typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],r=p({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=r[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),i=e[0],a=e[1],o=e[2];return r.apply(this,[i||null]).then((function(e){if(t.version<53&&!a)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(r){if("TypeError"!==r.name)throw r;e.forEach((function(t,r){e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(a,o)}}}function st(e){if("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}}function ut(e){if("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n}),Le(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function ct(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;je("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))})}function lt(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function dt(e){if("object"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var r=t.apply(this,arguments);if(n){var i=r.sender,a=i.getParameters();(!("encodings"in a)||1===a.encodings.length&&0===Object.keys(a.encodings[0]).length)&&(a.encodings=e.sendEncodings,i.sendEncodings=e.sendEncodings,this.setParametersPromises.push(i.setParameters(a).then((function(){delete i.sendEncodings})).catch((function(){delete i.sendEncodings}))))}return r})}}function ht(e){if("object"===typeof e&&e.RTCRtpSender){var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}}function ft(e){if("object"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}function pt(e){if("object"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){var e=arguments,n=this;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(n,e)})).finally((function(){n.setParametersPromises=[]})):t.apply(this,arguments)}}}function vt(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(r){return t.call(n,r,e)})),e.getVideoTracks().forEach((function(r){return t.call(n,r,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=this,r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return i&&i.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach((function(e){r.includes(e.track)&&t.removeTrack(e)}))}})}}function mt(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}}function gt(e){if("object"===typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,a=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),Promise.resolve()):i},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var s=function(e,t,n){var r=i.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r};t.setLocalDescription=s,s=function(e,t,n){var r=a.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.setRemoteDescription=s,s=function(e,t,n){var r=o.apply(this,[e]);return n?(r.then(t,n),Promise.resolve()):r},t.addIceCandidate=s}}function yt(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,r=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return r(kt(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function kt(e){return e&&void 0!==e.video?Object.assign({},e,{video:Ge(e.video)}):e}function bt(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var a=e.iceServers[i];!a.hasOwnProperty("urls")&&a.hasOwnProperty("url")?(je("RTCIceServer.url","RTCIceServer.urls"),(a=JSON.parse(JSON.stringify(a))).urls=a.url,delete a.url,r.push(a)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}}function wt(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function St(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function Tt(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var Et=n(800),xt=n.n(Et);function Ct(e){if(!(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),r=xt().parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Le(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function Pt(e,t){if(e.RTCPeerConnection){"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp}});var n=function(e){if(!e||!e.sdp)return!1;var t=xt().splitSections(e.sdp);return t.shift(),t.some((function(e){var t=xt().parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!==n?-1:n},i=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},a=function(e,n){var r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);var i=xt().matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),s=e.sdpSemantics;"plan-b"===s&&Object.defineProperty(this,"sctp",{get:function(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var u,c=r(arguments[0]),l=i(c),d=a(arguments[0],c);u=0===l&&0===d?Number.POSITIVE_INFINITY:0===l||0===d?Math.max(l,d):Math.min(l,d);var h={};Object.defineProperty(h,"maxMessageSize",{get:function(){return u}}),this._sctp=h}return o.apply(this,arguments)}}}function Rt(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=t.apply(this,arguments);return n(e,this),e},Le(e,"datachannel",(function(e){return n(e.channel,e.target),e}))}function n(e,t){var n=e.send;e.send=function(){var r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}function _t(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}}function It(e,t){if(e.RTCPeerConnection&&!("chrome"===t.browser&&t.version>=71)&&!("safari"===t.browser&&t.version>=605)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var r=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:r}):t.sdp=r}return n.apply(this,arguments)}}}function At(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}}function Dt(e,t){if(e.RTCPeerConnection&&e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this,t=arguments[0]||{};if("object"!==typeof t||t.type&&t.sdp)return n.apply(this,arguments);if(!(t={type:t.type,sdp:t.sdp}).type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":t.type="offer";break;default:t.type="answer"}if(t.sdp||"offer"!==t.type&&"answer"!==t.type)return n.apply(this,[t]);var r="offer"===t.type?this.createOffer:this.createAnswer;return r.apply(this).then((function(t){return n.apply(e,[t])}))})}}var Nt,Ot=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.window,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0},s=Fe,u=Be(a),c={browserDetails:u,commonShim:i,extractVersion:Oe,disableLog:Me,disableWarnings:Ue,sdp:Et};switch(u.browser){case"chrome":if(!e||!tt||!o.shimChrome)return s("Chrome shim is not included in this adapter release."),c;if(null===u.version)return s("Chrome shim can not determine version, not shimming."),c;s("adapter.js shimming chrome."),c.browserShim=e,At(a,u),Dt(a),We(a,u),Qe(a),tt(a,u),Je(a),et(a,u),$e(a),Ye(a),Xe(a),nt(a,u),Ct(a),_t(a),Pt(a,u),Rt(a),It(a,u);break;case"firefox":if(!t||!ot||!o.shimFirefox)return s("Firefox shim is not included in this adapter release."),c;s("adapter.js shimming firefox."),c.browserShim=t,At(a,u),Dt(a),rt(a,u),ot(a,u),at(a),ct(a),st(a),ut(a),lt(a),dt(a),ht(a),ft(a),pt(a),Ct(a),_t(a),Pt(a,u),Rt(a);break;case"safari":if(!r||!o.shimSafari)return s("Safari shim is not included in this adapter release."),c;s("adapter.js shimming safari."),c.browserShim=r,At(a,u),Dt(a),bt(a),St(a),gt(a),vt(a),mt(a),wt(a),yt(a),Tt(a),Ct(a),Pt(a,u),Rt(a),It(a,u);break;default:s("Unsupported browser!")}return c}({window:"undefined"===typeof window?void 0:window}),Lt=Ot,Mt=n(861),Ut=n(210),Ft=new Uint8Array(16);function jt(){if(!Nt&&!(Nt="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nt(Ft)}var Bt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var Vt=function(e){return"string"===typeof e&&Bt.test(e)},Gt=[],zt=0;zt<256;++zt)Gt.push((zt+256).toString(16).substr(1));var Ht=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Gt[e[t+0]]+Gt[e[t+1]]+Gt[e[t+2]]+Gt[e[t+3]]+"-"+Gt[e[t+4]]+Gt[e[t+5]]+"-"+Gt[e[t+6]]+Gt[e[t+7]]+"-"+Gt[e[t+8]]+Gt[e[t+9]]+"-"+Gt[e[t+10]]+Gt[e[t+11]]+Gt[e[t+12]]+Gt[e[t+13]]+Gt[e[t+14]]+Gt[e[t+15]]).toLowerCase();if(!Vt(n))throw TypeError("Stringified UUID is invalid");return n};var Kt,Wt,qt=function(e,t,n){var r=(e=e||{}).random||(e.rng||jt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return Ht(r)},Qt=n(371),Jt=Object.defineProperty,$t=Object.defineProperties,Yt=Object.getOwnPropertyDescriptors,Xt=Object.getOwnPropertySymbols,Zt=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable,tn=function(e,t,n){return t in e?Jt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},nn=function(e,t){for(var n in t||(t={}))Zt.call(t,n)&&tn(e,n,t[n]);if(Xt){var r,i=k(Xt(t));try{for(i.s();!(r=i.n()).done;){n=r.value;en.call(t,n)&&tn(e,n,t[n])}}catch(a){i.e(a)}finally{i.f()}}return e},rn=function(e,t){return $t(e,Yt(t))},an=function(e,t,n){return new Promise((function(r,i){var a=function(e){try{s(n.next(e))}catch(x){i(x)}},o=function(e){try{s(n.throw(e))}catch(x){i(x)}},s=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(a,o)};s((n=n.apply(e,t)).next())}))};!function(e){e[e.VERBOSE=0]="VERBOSE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.TIME=4]="TIME",e[e.TIMEEND=5]="TIMEEND",e[e.ERROR=6]="ERROR",e[e.NONE=7]="NONE"}(Wt||(Wt={}));var on,sn,un,cn,ln,dn="undefined"!=typeof window&&"undefined"!=typeof window.expect,hn=function(){function e(){m(this,e)}return y(e,null,[{key:"v",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[0,e].concat(n))}},{key:"d",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[1,e].concat(n))}},{key:"i",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[2,e].concat(n))}},{key:"w",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[3,e].concat(n))}},{key:"e",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[6,e].concat(n))}},{key:"time",value:function(e){this.log(4,"[HMSPerformanceTiming]",e)}},{key:"timeEnd",value:function(e){this.log(5,"[HMSPerformanceTiming]",e,e)}},{key:"cleanUp",value:function(){performance.clearMarks(),performance.clearMeasures()}},{key:"log",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!(this.level.valueOf()>e.valueOf()))switch(e){case 0:var a;(a=console).log.apply(a,[t].concat(r));break;case 1:var o;(o=console).debug.apply(o,[t].concat(r));break;case 2:var s;(s=console).info.apply(s,[t].concat(r));break;case 3:var u;(u=console).warn.apply(u,[t].concat(r));break;case 6:var c;(c=console).error.apply(c,[t].concat(r));break;case 4:performance.mark(r[0]);break;case 5:var l=r[0];try{var d=performance.measure(l,l);this.log(1,t,l,null==d?void 0:d.duration),performance.clearMarks(l),performance.clearMeasures(l)}catch(d){this.log(1,t,l,d)}}}}]),e}();hn.level=dn?7:0,function(e){e[e.PEER_ADDED=0]="PEER_ADDED",e[e.PEER_REMOVED=1]="PEER_REMOVED",e[e.PEER_KNOCKED=2]="PEER_KNOCKED",e[e.ROOM_TYPE_CHANGED=3]="ROOM_TYPE_CHANGED",e[e.METADATA_UPDATED=4]="METADATA_UPDATED",e[e.SCREENSHARE_STARTED=5]="SCREENSHARE_STARTED",e[e.SCREENSHARE_STOPPED=6]="SCREENSHARE_STOPPED",e[e.DEFAULT_UPDATE=7]="DEFAULT_UPDATE",e[e.RECORDING_STATE_UPDATED=8]="RECORDING_STATE_UPDATED",e[e.BROWSER_RECORDING_STATE_UPDATED=9]="BROWSER_RECORDING_STATE_UPDATED",e[e.SERVER_RECORDING_STATE_UPDATED=10]="SERVER_RECORDING_STATE_UPDATED",e[e.RTMP_STREAMING_STATE_UPDATED=11]="RTMP_STREAMING_STATE_UPDATED",e[e.HLS_STREAMING_STATE_UPDATED=12]="HLS_STREAMING_STATE_UPDATED",e[e.ROOM_STATE=13]="ROOM_STATE"}(on||(on={})),function(e){e[e.PEER_JOINED=0]="PEER_JOINED",e[e.PEER_LEFT=1]="PEER_LEFT",e[e.AUDIO_TOGGLED=2]="AUDIO_TOGGLED",e[e.VIDEO_TOGGLED=3]="VIDEO_TOGGLED",e[e.BECAME_DOMINANT_SPEAKER=4]="BECAME_DOMINANT_SPEAKER",e[e.RESIGNED_DOMINANT_SPEAKER=5]="RESIGNED_DOMINANT_SPEAKER",e[e.STARTED_SPEAKING=6]="STARTED_SPEAKING",e[e.STOPPED_SPEAKING=7]="STOPPED_SPEAKING",e[e.ROLE_UPDATED=8]="ROLE_UPDATED",e[e.PEER_LIST=9]="PEER_LIST",e[e.NAME_UPDATED=10]="NAME_UPDATED",e[e.METADATA_UPDATED=11]="METADATA_UPDATED"}(sn||(sn={})),function(e){e[e.TRACK_ADDED=0]="TRACK_ADDED",e[e.TRACK_REMOVED=1]="TRACK_REMOVED",e[e.TRACK_MUTED=2]="TRACK_MUTED",e[e.TRACK_UNMUTED=3]="TRACK_UNMUTED",e[e.TRACK_DESCRIPTION_CHANGED=4]="TRACK_DESCRIPTION_CHANGED",e[e.TRACK_DEGRADED=5]="TRACK_DEGRADED",e[e.TRACK_RESTORED=6]="TRACK_RESTORED"}(un||(un={})),function(e){e[e.DEFAULT=0]="DEFAULT"}(cn||(cn={})),function(e){e.NONE="none",e.LOW="low",e.MEDIUM="medium",e.HIGH="high"}(ln||(ln={}));var fn,pn,vn,mn,gn={f:ln.HIGH,h:ln.MEDIUM,q:ln.LOW};!function(e){e.VP8="vp8",e.VP9="vp9",e.H264="h264"}(fn||(fn={})),function(e){e.OPUS="opus"}(pn||(pn={})),function(e){e.audio="audio",e.video="video"}(vn||(vn={})),function(e){e[e.Publish=0]="Publish",e[e.Subscribe=1]="Subscribe"}(mn||(mn={}));var yn,kn={WebSocketConnectionErrors:{FAILED_TO_CONNECT:1e3,WEBSOCKET_CONNECTION_LOST:1003},InitAPIErrors:{SERVER_ERRORS:2e3,INIT_CONFIG_NOT_AVAILABLE:2002,ENDPOINT_UNREACHABLE:2003,INVALID_TOKEN_FORMAT:2004},TracksErrors:{GENERIC_TRACK:3e3,CANT_ACCESS_CAPTURE_DEVICE:3001,DEVICE_NOT_AVAILABLE:3002,DEVICE_IN_USE:3003,DEVICE_LOST_MIDWAY:3008,NOTHING_TO_RETURN:3005,INVALID_VIDEO_SETTINGS:3006,CODEC_CHANGE_NOT_PERMITTED:3007,AUTOPLAY_ERROR:3008,OVER_CONSTRAINED:3009,NO_AUDIO_DETECTED:3010,SYSTEM_DENIED_PERMISSION:3011},WebrtcErrors:{CREATE_OFFER_FAILED:4001,CREATE_ANSWER_FAILED:4002,SET_LOCAL_DESCRIPTION_FAILED:4003,SET_REMOTE_DESCRIPTION_FAILED:4004,ICE_FAILURE:4005},WebsocketMethodErrors:{SERVER_ERRORS:5e3,ALREADY_JOINED:5001,CANNOT_JOIN_PREVIEW_IN_PROGRESS:5002},GenericErrors:{NOT_CONNECTED:6e3,SIGNALLING:6001,UNKNOWN:6002,NOT_READY:6003,JSON_PARSING_FAILED:6004,TRACK_METADATA_MISSING:6005,RTC_TRACK_MISSING:6006,PEER_METADATA_MISSING:6007,INVALID_ROLE:6008,PREVIEW_IN_PROGRESS:6009,MISSING_MEDIADEVICES:6010,MISSING_RTCPEERCONNECTION:6011},PlaylistErrors:{NO_ENTRY_TO_PLAY:8001,NO_ENTRY_IS_PLAYING:8002}},bn=function(e){Ce(n,e);var t=_e(n);function n(e,r,i,a,o){var s,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return m(this,n),(s=t.call(this,a)).code=e,s.name=r,s.message=a,s.description=o,s.isTerminal=u,Object.setPrototypeOf(Ee(s),n.prototype),s.action=i.toString(),s}return y(n,[{key:"toAnalyticsProperties",value:function(){return{error_name:this.name,error_code:this.code,error_message:this.message,error_description:this.description,action:this.action,is_terminal:this.isTerminal}}},{key:"addNativeError",value:function(e){this.nativeError=e}}]),n}(Ae(Error));!function(e){e.NONE="NONE",e.TRACK="TRACK",e.INIT="INIT",e.PUBLISH="PUBLISH",e.UNPUBLISH="UNPUBLISH",e.JOIN="JOIN",e.SUBSCRIBE="SUBSCRIBE",e.DATA_CHANNEL_SEND="DATA_CHANNEL_SEND",e.RESTART_ICE="RESTART_ICE",e.VIDEO_PLUGINS="VIDEO_PLUGINS",e.AUDIO_PLUGINS="AUDIO_PLUGINS",e.AUTOPLAY="AUTOPLAY",e.RECONNECT_SIGNAL="RECONNECT_SIGNAL",e.VALIDATION="VALIDATION",e.PLAYLIST="PLAYLIST",e.PREVIEW="PREVIEW"}(yn||(yn={}));var wn={FailedToConnect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebSocketConnectionErrors.FAILED_TO_CONNECT,"WebsocketFailedToConnect",e,"[WS]: ".concat(t),"[WS]: ".concat(t))},WebSocketConnectionLost:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,"WebSocketConnectionLost",e,"Network connection lost ",t)}},Sn={ServerErrors:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(e,"ServerErrors",t,"[INIT]: Server error",n,!0)},EndpointUnreachable:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.InitAPIErrors.ENDPOINT_UNREACHABLE,"EndpointUnreachable",e,"Endpoint is not reachable.",t)},InvalidTokenFormat:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.InitAPIErrors.INVALID_TOKEN_FORMAT,"InvalidTokenFormat",e,"Token is not in proper JWT format - ".concat(t),t,!0)},InitConfigNotAvailable:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.InitAPIErrors.INIT_CONFIG_NOT_AVAILABLE,"InitError",e,"[INIT]: ".concat(t),"[INIT]: ".concat(t))}},Tn={GenericTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.TracksErrors.GENERIC_TRACK,"GenericTrack",e,"[TRACK]: ".concat(t),"[TRACK]: ".concat(t))},CantAccessCaptureDevice:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,"CantAccessCaptureDevice",e,"User denied permission to access capture device - ".concat(t),n)},DeviceNotAvailable:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.DEVICE_NOT_AVAILABLE,"DeviceNotAvailable",e,"[TRACK]: Capture device is no longer available - ".concat(t),n)},DeviceInUse:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.DEVICE_IN_USE,"DeviceInUse",e,"[TRACK]: Capture device is in use by another application - ".concat(t),n)},DeviceLostMidway:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.DEVICE_LOST_MIDWAY,"DeviceLostMidway",e,"Lost access to capture device midway - ".concat(t),n)},NothingToReturn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.TracksErrors.NOTHING_TO_RETURN,"NothingToReturn",e,"There is no media to return. Please select either video or audio or both.",t)},InvalidVideoSettings:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.TracksErrors.INVALID_VIDEO_SETTINGS,"InvalidVideoSettings",e,"Cannot enable simulcast when no video settings are provided",t)},AutoplayBlocked:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.TracksErrors.AUTOPLAY_ERROR,"AutoplayBlocked",e,"Autoplay blocked because the user didn't interact with the document first",t)},CodecChangeNotPermitted:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.TracksErrors.CODEC_CHANGE_NOT_PERMITTED,"CodecChangeNotPermitted",e,"Codec can't be changed mid call.",t)},OverConstrained:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.OVER_CONSTRAINED,"OverConstrained",e,"[TRACK]: Requested constraints cannot be satisfied with the device hardware - ".concat(t),n)},NoAudioDetected:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Please check the mic or use another audio input";return new bn(kn.TracksErrors.NO_AUDIO_DETECTED,"NoAudioDetected",e,"No audio input detected from microphone",t)},SystemDeniedPermission:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.TracksErrors.SYSTEM_DENIED_PERMISSION,"SystemDeniedPermission",e,"Operating System denied permission to access capture device - ".concat(t),n)}},En={CreateOfferFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebrtcErrors.CREATE_OFFER_FAILED,"CreateOfferFailed",e,"[".concat(e.toString(),"]: Failed to create offer. "),t)},CreateAnswerFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebrtcErrors.CREATE_ANSWER_FAILED,"CreateAnswerFailed",e,"[".concat(e.toString(),"]: Failed to create answer. "),t)},SetLocalDescriptionFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebrtcErrors.SET_LOCAL_DESCRIPTION_FAILED,"SetLocalDescriptionFailed",e,"[".concat(e.toString(),"]: Failed to set offer. "),t)},SetRemoteDescriptionFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebrtcErrors.SET_REMOTE_DESCRIPTION_FAILED,"SetRemoteDescriptionFailed",e,"[".concat(e.toString(),"]: Failed to set answer. "),t)},ICEFailure:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebrtcErrors.ICE_FAILURE,"ICEFailure",e,"[".concat(e.toString(),"]: Ice connection state FAILED"),t)}},xn={ServerErrors:function(e,t,n){return new bn(e,"ServerErrors",t,n,n,!0)},AlreadyJoined:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebsocketMethodErrors.ALREADY_JOINED,"AlreadyJoined",e,"[JOIN]: You have already joined this room.",t)},CannotJoinPreviewInProgress:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.WebsocketMethodErrors.CANNOT_JOIN_PREVIEW_IN_PROGRESS,"CannotJoinPreviewInProgress",e,"[JOIN]: Cannot join if preview is in progress",t)}},Cn={NotConnected:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.NOT_CONNECTED,"NotConnected",e,"Client is not connected",t)},Signalling:function(e,t){return new bn(kn.GenericErrors.SIGNALLING,"Signalling",e,"Unknown signalling error: ".concat(e.toString()," ").concat(t," "),t)},Unknown:function(e,t){return new bn(kn.GenericErrors.UNKNOWN,"Unknown",e,"Unknown exception: ".concat(t),t)},NotReady:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.NOT_READY,"NotReady",e,t,t)},JsonParsingFailed:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new bn(kn.GenericErrors.JSON_PARSING_FAILED,"JsonParsingFailed",e,"Failed to parse JSON message - ".concat(t),n)},TrackMetadataMissing:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.TRACK_METADATA_MISSING,"TrackMetadataMissing",e,"Track Metadata Missing",t)},RTCTrackMissing:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.RTC_TRACK_MISSING,"RTCTrackMissing",e,"RTC Track missing",t)},PeerMetadataMissing:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.PEER_METADATA_MISSING,"PeerMetadataMissing",e,"Peer Metadata Missing",t)},ValidationFailed:function(e,t){return new bn(kn.GenericErrors.INVALID_ROLE,"ValidationFailed",yn.VALIDATION,e,t?JSON.stringify(t):"")},InvalidRole:function(e,t){return new bn(kn.GenericErrors.INVALID_ROLE,"InvalidRole",e,"Invalid role. Join with valid role",t,!0)},PreviewAlreadyInProgress:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(kn.GenericErrors.PREVIEW_IN_PROGRESS,"PreviewAlreadyInProgress",e,"[Preview]: Cannot join if preview is in progress",t)},MissingMediaDevices:function(){return new bn(kn.GenericErrors.MISSING_MEDIADEVICES,"MissingMediaDevices",yn.JOIN,"navigator.mediaDevices is undefined. 100ms SDK won't work on this website as WebRTC is not supported on HTTP endpoints(missing navigator.mediaDevices). Please ensure you're using the SDK either on localhost or a valid HTTPS endpoint.","",!0)},MissingRTCPeerConnection:function(){return new bn(kn.GenericErrors.MISSING_RTCPEERCONNECTION,"MissingRTCPeerConnection",yn.JOIN,"RTCPeerConnection which is a core requirement for WebRTC call was not found, this could be due to an unsupported browser or browser extensions blocking WebRTC","",!0)}},Pn={PlatformNotSupported:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(7001,"PlatformNotSupported",e,"Check HMS Docs to see the list of supported platforms",t)},InitFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(7002,"InitFailed",e,"Plugin init failed",t)},ProcessingFailed:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(7003,"ProcessingFailed",e,"Plugin processing failed",t)},AddAlreadyInProgress:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(7004,"AddAlreadyInProgress",e,"Plugin add already in progress",t)},DeviceNotSupported:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new bn(7005,"DeviceNotSupported",e,"Check HMS Docs to see the list of supported devices",t)}},Rn={NoEntryToPlay:function(e,t){return new bn(kn.PlaylistErrors.NO_ENTRY_TO_PLAY,"NoEntryToPlay",e,"Reached end of playlist",t)},NoEntryPlaying:function(e,t){return new bn(kn.PlaylistErrors.NO_ENTRY_IS_PLAYING,"NoEntryIsPlaying",e,"No entry is playing at this time",t)}},_n="VALIDATIONS";function In(e){return null!=e}var An=function(){if(!In(RTCPeerConnection)){var e=Cn.MissingRTCPeerConnection();throw hn.e(_n,e),e}},Dn=function(){if(!In(navigator.mediaDevices)){var e=Cn.MissingMediaDevices();throw hn.e(_n,e),e}};function Nn(e,t){var n,r=(0,Mt.Qc)(e.sdp);if(!(null==(n=r.origin)?void 0:n.username.startsWith("mozilla")))return e;var i=Array.from(t.values());return r.media.forEach((function(e){var t,n,r,a=null==(t=e.msid)?void 0:t.split(" ")[0],o=null==(n=i.find((function(t){return t.type===e.type&&t.stream_id===a})))?void 0:n.track_id;o&&(e.msid=null==(r=e.msid)?void 0:r.replace(/\s(.+)/," ".concat(o)))})),{type:e.type,sdp:(0,Mt.cW)(r)}}function On(e){return e.sdp.includes("usedtx=1")?e:{type:e.type,sdp:e.sdp.replace("useinbandfec=1","useinbandfec=1;usedtx=1")}}var Ln,Mn="HMSConnection",Un=function(){function e(t,n){m(this,e),this.candidates=new Array,this.role=t,this.signal=n}return y(e,[{key:"iceConnectionState",get:function(){return this.nativeConnection.iceConnectionState}},{key:"connectionState",get:function(){return this.nativeConnection.connectionState}},{key:"action",get:function(){return this.role===mn.Publish?yn.PUBLISH:yn.SUBSCRIBE}},{key:"addTransceiver",value:function(e,t){return this.nativeConnection.addTransceiver(e,t)}},{key:"createOffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1?arguments[1]:void 0;return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.nativeConnection.createOffer(e);case 3:return r=n.sent,n.abrupt("return",(hn.d(Mn,"[role=".concat(this.role,"] createOffer offer=").concat(JSON.stringify(r,null,1))),On(Nn(r,t))));case 7:throw n.prev=7,n.t0=n.catch(0),En.CreateOfferFailed(this.action,n.t0.message);case 10:case"end":return n.stop()}}),n,this,[[0,7]])})))}},{key:"createAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.nativeConnection.createAnswer(e);case 3:return n=t.sent,t.abrupt("return",(hn.d(Mn,"[role=".concat(this.role,"] createAnswer answer=").concat(JSON.stringify(n,null,1))),n));case 7:throw t.prev=7,t.t0=t.catch(0),En.CreateAnswerFailed(this.action,t.t0.message);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"setLocalDescription",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,hn.d(Mn,"[role=".concat(this.role,"] setLocalDescription description=").concat(JSON.stringify(e,null,1))),t.next=4,this.nativeConnection.setLocalDescription(e);case 4:t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),En.SetLocalDescriptionFailed(this.action,t.t0.message);case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"setRemoteDescription",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,hn.d(Mn,"[role=".concat(this.role,"] setRemoteDescription description=").concat(JSON.stringify(e,null,1))),t.next=4,this.nativeConnection.setRemoteDescription(e);case 4:t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),En.SetRemoteDescriptionFailed(this.action,t.t0.message);case 9:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"addIceCandidate",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return hn.d(Mn,"[role=".concat(this.role,"] addIceCandidate candidate=").concat(JSON.stringify(e,null,1))),t.next=3,this.nativeConnection.addIceCandidate(e);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"remoteDescription",get:function(){return this.nativeConnection.remoteDescription}},{key:"getSenders",value:function(){return this.nativeConnection.getSenders()}},{key:"removeTrack",value:function(e){this.nativeConnection.removeTrack(e)}},{key:"setMaxBitrate",value:function(e,t){return an(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.getSenders().find((function(e){var n;return(null==(n=null==e?void 0:e.track)?void 0:n.id)===t.getTrackIDBeingSent()})),!r){n.next=8;break}return(i=r.getParameters()).encodings.length>0&&(i.encodings[0].maxBitrate=1e3*e),n.next=6,r.setParameters(i);case 6:n.next=9;break;case 8:hn.w(Mn,"no sender found to setMaxBitrate for track - ".concat(t.trackId,", sentTrackId - ").concat(t.getTrackIDBeingSent()));case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getStats",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.nativeConnection.getStats();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.nativeConnection.close();case 1:case"end":return e.stop()}}),e,this)})))}}]),e}(),Fn="renegotiation-callback-id",jn="ion-sfu",Bn="SUBSCRIBE_ICE_CONNECTION_CALLBACK_ID",Vn="device-change",Gn="local-audio-enabled",zn="local-video-enabled",Hn="stats-update",Kn="track-degraded",Wn="track-restored",qn="track-audio-level-update",Qn="local-audio-silence",Jn="analytics",$n="audio-plugin-failed",Yn="policy-change",Xn="local-role-update",Zn="audio-track-update",er="audio-track-added",tr="audio-track-removed",nr="autoplay-error",rr=function(e){Ce(n,e);var t=_e(n);function n(e,r,i,a){var o;return m(this,n),(o=t.call(this,mn.Publish,e)).observer=i,o.transport=a,o.nativeConnection=new RTCPeerConnection(r),o.nativeConnection.createDataChannel(jn,{protocol:"SCTP"}),o.nativeConnection.onicecandidate=function(t){var n=t.candidate;n&&e.trickle(o.role,n)},o.nativeConnection.oniceconnectionstatechange=function(){o.observer.onIceConnectionChange(o.nativeConnection.iceConnectionState)},o.nativeConnection.onconnectionstatechange=function(){o.observer.onConnectionStateChange(o.nativeConnection.connectionState)},o}return y(n,[{key:"initAfterJoin",value:function(){var e=this;this.nativeConnection.onnegotiationneeded=function(){return an(e,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return hn.d("HMSPublishConnection","onnegotiationneeded"),e.next=3,this.observer.onRenegotiationNeeded();case 3:case"end":return e.stop()}}),e,this)})))}}},{key:"trackUpdate",value:function(e){this.transport.trackUpdate(e)}}]),n}(Un),ir=y((function e(t){m(this,e),this.tracks=new Array,this.nativeStream=t,this.id=t.id})),ar=function(e){Ce(n,e);var t=_e(n);function n(e,r){var i;return m(this,n),(i=t.call(this,e)).audio=!0,i.video=ln.NONE,i.connection=r,i}return y(n,[{key:"setAudio",value:function(e){this.audio!==e&&(this.audio=e,this.syncWithApiChannel(!1))}},{key:"setVideoLayerLocally",value:function(e,t){this.video=e,hn.d("[Remote stream] ".concat(t," - ").concat(this.id),"Setting layer field to - ".concat(e))}},{key:"setVideoLayer",value:function(e,t){this.setVideoLayerLocally(e,t),hn.d("[Remote stream] ".concat(t," - ").concat(this.id),"Switching to ".concat(e," layer")),this.syncWithApiChannel()}},{key:"getSimulcastLayer",value:function(){return this.video}},{key:"isAudioSubscribed",value:function(){return this.audio}},{key:"syncWithApiChannel",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={streamId:this.id,audio:this.audio};e&&(t.video=this.video,t.framerate=this.video),this.connection.sendOverApiDataChannel(JSON.stringify(t))}}]),n}(ir),or=function(){function e(t,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";m(this,e),this.TAG="HMSDataChannel",this.nativeChannel=t,this.observer=n,this.metadata=i,t.onmessage=function(e){r.observer.onMessage(e.data)}}return y(e,[{key:"id",get:function(){return this.nativeChannel.id}},{key:"label",get:function(){return this.nativeChannel.label}},{key:"readyState",get:function(){return this.nativeChannel.readyState}},{key:"send",value:function(e){hn.d(this.TAG,"[".concat(this.metadata,"] Sending [size=").concat(e.length,"] message=").concat(e)),this.nativeChannel.send(e)}},{key:"close",value:function(){this.nativeChannel.close()}}]),e}(),sr=function(){function e(t,n,r){m(this,e),this.logIdentifier="",this.stream=t,this.nativeTrack=n,this.source=r}return y(e,[{key:"enabled",get:function(){return this.nativeTrack.enabled}},{key:"trackId",get:function(){return this.firstTrackId||this.sdpTrackId||this.nativeTrack.id}},{key:"getMediaTrackSettings",value:function(){return this.nativeTrack.getSettings()}},{key:"setEnabled",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.nativeTrack.enabled=e;case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setSdpTrackId",value:function(e){this.sdpTrackId=e}},{key:"setFirstTrackId",value:function(e){this.firstTrackId=e}},{key:"cleanup",value:function(){var e;null==(e=this.nativeTrack)||e.stop()}}]),e}();!function(e){e.AUDIO="audio",e.VIDEO="video"}(Ln||(Ln={}));var ur,cr=function(e){Ce(n,e);var t=_e(n);function n(e,r,i){var a;if(m(this,n),(a=t.call(this,e,r,i)).type=Ln.AUDIO,a.audioElement=null,"audio"!==r.kind)throw new Error("Expected 'track' kind = 'audio'");return a}return y(n,[{key:"getVolume",value:function(){return this.audioElement?100*this.audioElement.volume:null}},{key:"setVolume",value:function(e){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");this.subscribeToAudio(0!==e&&this.enabled),this.audioElement&&(this.audioElement.volume=e/100)}},{key:"setAudioElement",value:function(e){this.audioElement=e}},{key:"getAudioElement",value:function(){return this.audioElement}},{key:"getOutputDevice",value:function(){return this.outputDevice}},{key:"cleanup",value:function(){Te(we(n.prototype),"cleanup",this).call(this),this.audioElement&&(this.audioElement.srcObject=null,this.audioElement.remove(),this.audioElement=null)}},{key:"setOutputDevice",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.audioElement){t.next=3;break}return hn.d("audio-track","no audio element to set output"),t.abrupt("return");case 3:if(t.prev=3,t.t0="function"==typeof this.audioElement.setSinkId,!t.t0){t.next=9;break}return t.next=8,null==(n=this.audioElement)?void 0:n.setSinkId(e.deviceId);case 8:this.outputDevice=e;case 9:t.next=14;break;case 11:t.prev=11,t.t1=t.catch(3),hn.d("audio-track",t.t1);case 14:case"end":return t.stop()}}),t,this,[[3,11]])})))}},{key:"removeSink",value:function(){var e;this.audioElement&&(null==(e=window.HMS)?void 0:e.AUDIO_SINK)&&(this.audioElement.srcObject=null,this.subscribeToAudio(!1))}},{key:"addSink",value:function(){var e,t;if(this.nativeTrack&&this.audioElement&&(null==(e=window.HMS)?void 0:e.AUDIO_SINK)){var n=this.audioElement.srcObject;n instanceof MediaStream&&(null==(t=n.getAudioTracks()[0])?void 0:t.id)===this.nativeTrack.id||(this.audioElement.srcObject=new MediaStream([this.nativeTrack]),this.subscribeToAudio(!0))}}},{key:"subscribeToAudio",value:function(e){this.stream instanceof ar&&this.stream.setAudio(e)}}]),n}(sr),lr=function(e){Ce(n,e);var t=_e(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"setEnabled",value:function(e){var t=this,r=function(e){return Te(we(n.prototype),e,t)};return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e!==this.enabled,!t.t0){t.next=5;break}return t.next=4,r("setEnabled").call(this,e);case 4:this.subscribeToAudio(e);case 5:case"end":return t.stop()}}),t,this)})))}}]),n}(cr),dr=function(e){Ce(n,e);var t=_e(n);function n(e,r,i){var a;if(m(this,n),(a=t.call(this,e,r,i)).type=Ln.VIDEO,a.sinkCount=0,"video"!==r.kind)throw new Error("Expected 'track' kind = 'video'");return a}return y(n,[{key:"hasSinks",value:function(){return this.sinkCount>0}},{key:"addSink",value:function(e){this.addSinkInternal(e,this.nativeTrack)}},{key:"removeSink",value:function(e){null!==e.srcObject&&(e.srcObject=null,this.sinkCount>0&&this.sinkCount--)}},{key:"addSinkInternal",value:function(e,t){var n,r=e.srcObject;null!==r&&r instanceof MediaStream&&(null==(n=r.getVideoTracks()[0])?void 0:n.id)===t.id||(e.srcObject=new MediaStream([t]),this.sinkCount++)}}]),n}(sr),hr=function(e){Ce(n,e);var t=_e(n);function n(){var e;return m(this,n),(e=t.apply(this,arguments))._degraded=!1,e._degradedAt=null,e._layerDefinitions=[],e.history=new fr,e}return y(n,[{key:"degraded",get:function(){return this._degraded}},{key:"degradedAt",get:function(){return this._degradedAt}},{key:"setEnabled",value:function(e){var t=this,r=function(e){return Te(we(n.prototype),e,t)};return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e!==this.enabled,!t.t0){t.next=4;break}return t.next=4,r("setEnabled").call(this,e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"preferLayer",value:function(e){!this.shouldSendVideoLayer(e,"preferLayer")||(this.stream.setVideoLayer(e,this.logIdentifier),this.pushInHistory("uiPreferLayer-".concat(e)))}},{key:"getSimulcastLayer",value:function(){return this.stream.getSimulcastLayer()}},{key:"addSink",value:function(e){Te(we(n.prototype),"addSink",this).call(this,e),this.updateLayer("addSink"),this.pushInHistory("uiSetLayer-high")}},{key:"removeSink",value:function(e){Te(we(n.prototype),"removeSink",this).call(this,e),this.updateLayer("removeSink"),this._degraded=!1,this.pushInHistory("uiSetLayer-none")}},{key:"getSimulcastDefinitions",value:function(){return v(this._layerDefinitions)}},{key:"setSimulcastDefinitons",value:function(e){this._layerDefinitions=e}},{key:"setLayerFromServer",value:function(e,t){this._degraded=t,this._degradedAt=t?new Date:this._degradedAt,this.stream.setVideoLayerLocally(e,this.logIdentifier),this.pushInHistory("sfuLayerUpdate-".concat(e))}},{key:"setDegradedFromSdk",value:function(e){this._degraded=e,this._degradedAt=e?new Date:this._degradedAt,this.updateLayer("sdkDegradation"),this.pushInHistory(e?"sdkDegraded-none":"sdkRecovered-high")}},{key:"updateLayer",value:function(e){var t=this.degraded||!this.hasSinks()?ln.NONE:ln.HIGH;!this.shouldSendVideoLayer(t,e)||this.stream.setVideoLayer(t,this.logIdentifier)}},{key:"pushInHistory",value:function(e){}},{key:"shouldSendVideoLayer",value:function(e,t){var n=this.getSimulcastLayer();return!(!this.degraded||e!==ln.NONE)||(n!==e||(hn.d("[Remote Track] ".concat(this.logIdentifier),"Not sending update, already on layer ".concat(e,", source=").concat(t)),!1))}}]),n}(dr),fr=function(){function e(){m(this,e),this.history=[]}return y(e,[{key:"push",value:function(e){e.time=(new Date).toISOString().split("T")[1],this.history.push(e)}}]),e}(),pr=function(e){Ce(n,e);var t=_e(n);function n(e,r,i){var a;return m(this,n),(a=t.call(this,mn.Subscribe,e)).TAG="[HMSSubscribeConnection]",a.remoteStreams=new Map,a.pendingMessageQueue=[],a.handlePendingApiMessages=function(){a.pendingMessageQueue.length>0&&(hn.d(a.TAG,"Found pending message queue, sending messages"),a.pendingMessageQueue.forEach((function(e){return a.sendOverApiDataChannel(e)})),a.pendingMessageQueue.length=0)},a.observer=i,a.nativeConnection=new RTCPeerConnection(r),a.initNativeConnectionCallbacks(),a}return y(n,[{key:"initNativeConnectionCallbacks",value:function(){var e=this;this.nativeConnection.oniceconnectionstatechange=function(){e.observer.onIceConnectionChange(e.nativeConnection.iceConnectionState)},this.nativeConnection.onconnectionstatechange=function(){e.observer.onConnectionStateChange(e.nativeConnection.connectionState)},this.nativeConnection.ondatachannel=function(t){t.channel.label===jn&&(e.apiChannel=new or(t.channel,{onMessage:function(t){e.observer.onApiChannelMessage(t)}},"role=".concat(e.role)),t.channel.onopen=e.handlePendingApiMessages)},this.nativeConnection.onicecandidate=function(t){null!==t.candidate&&e.signal.trickle(e.role,t.candidate)},this.nativeConnection.ontrack=function(t){var n,r=t.streams[0],i=r.id;if(!e.remoteStreams.has(i)){var a=new ar(r,e);e.remoteStreams.set(i,a),r.onremovetrack=function(t){var n=a.tracks.findIndex((function(e){return e.nativeTrack.id===t.track.id}));if(n>=0){var r=a.tracks[n];e.observer.onTrackRemove(r),a.tracks.splice(n,1),0===a.tracks.length&&e.remoteStreams.delete(i)}}}var o=e.remoteStreams.get(i),s=new("audio"===t.track.kind?lr:hr)(o,t.track),u=function(e,t){var n;if((null==e?void 0:e.sdp)&&t){var r=(0,Mt.Qc)(e.sdp).media.find((function(e){return In(e.mid)&&parseInt(e.mid)===parseInt(t)}));return null==(n=null==r?void 0:r.msid)?void 0:n.split(" ")[1]}}(e.remoteDescription,null==(n=t.transceiver)?void 0:n.mid);u&&s.setSdpTrackId(u),o.tracks.push(s),e.observer.onTrackAdd(s)}}},{key:"sendOverApiDataChannel",value:function(e){this.apiChannel&&"open"===this.apiChannel.readyState?this.apiChannel.send(e):(hn.w(this.TAG,"API Data channel not ".concat(this.apiChannel?"open":"present",", queueing"),e),this.pendingMessageQueue.push(e))}},{key:"close",value:function(){var e=this,t=function(t){return Te(we(n.prototype),t,e)};return an(this,null,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("close").call(this);case 2:null==(n=this.apiChannel)||n.close();case 3:case"end":return e.stop()}}),e,this)})))}}]),n}(Un),vr=function(){function e(t){m(this,e),this.key=t,this.storage=null}return y(e,[{key:"getStorage",value:function(){return kr&&(this.storage=window.localStorage),this.storage}},{key:"get",value:function(){var e,t=null==(e=this.getStorage())?void 0:e.getItem(this.key);return t?JSON.parse(t):void 0}},{key:"set",value:function(e){var t,n=JSON.stringify(e);null==(t=this.getStorage())||t.setItem(this.key,n)}},{key:"clear",value:function(){var e;null==(e=this.getStorage())||e.removeItem(this.key)}}]),e}(),mr="0.2.0",gr=new Ut.UAParser,yr="undefined"==typeof window&&!(null==(ur=gr.getBrowser().name)?void 0:ur.toLowerCase().includes("electron")),kr="undefined"!=typeof window;var br,wr=function(){if(yr)return"hmsclient/".concat(mr);var e=gr.getDevice(),t=gr.getBrowser(),n=gr.getOS();return e.type?"hmsclient/".concat(mr," ").concat(n.name,"/").concat(n.version," (").concat(e.vendor,"_").concat(e.type,"_/_").concat(t.name,"_").concat(t.version,")"):"hmsclient/".concat(mr," ").concat(n.name,"/").concat(n.version," (").concat(t.name,"_").concat(t.version,")")}(),Sr="InitService",Tr=function(){function e(){m(this,e)}return y(e,null,[{key:"handleError",value:function(e,t){switch(e.status){case 404:throw Sn.EndpointUnreachable(yn.INIT,t.message||e.statusText);case 200:break;default:throw Sn.ServerErrors(t.code||e.status,yn.INIT,t.message||(null==e?void 0:e.statusText))}}},{key:"fetchInitConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://prod-init.100ms.live",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return an(this,null,u().mark((function i(){var a,o,s,c;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return hn.d(Sr,"fetchInitConfig: initEndpoint=".concat(n," token=").concat(e," peerId=").concat(t," region=").concat(r," ")),a=Er(n,t,r),i.prev=2,i.next=5,fetch(a,{headers:{Authorization:"Bearer ".concat(e)}});case 5:return o=i.sent,i.next=8,o.json();case 8:return s=i.sent,i.abrupt("return",(this.handleError(o,s),hn.d(Sr,"config is ".concat(JSON.stringify(s,null,2))),xr(s)));case 12:throw i.prev=12,i.t0=i.catch(2),c=i.t0,["Failed to fetch","NetworkError"].some((function(e){return c.message.includes(e)}))?Sn.EndpointUnreachable(yn.INIT,c.message):c;case 16:case"end":return i.stop()}}),i,this,[[2,12]])})))}}]),e}();function Er(e,t,n){try{var r=new URL("/init",e);return n&&n.trim().length>0&&r.searchParams.set("region",n.trim()),r.searchParams.set("peer_id",t),r.searchParams.set("user_agent",wr),r.toString()}catch(r){var i=r;throw hn.e(Sr,i.name,i.message),i}}function xr(e){var t;return rn(nn({},e),{rtcConfiguration:rn(nn({},e.rtcConfiguration),{iceServers:null==(t=e.rtcConfiguration)?void 0:t.ice_servers})})}function Cr(e){switch(e){case br.JOIN:return yn.JOIN;case br.OFFER:return yn.PUBLISH;case br.ANSWER:return yn.SUBSCRIBE;case br.TRACK_UPDATE:return yn.TRACK;default:return yn.NONE}}!function(e){e.JOIN="join",e.OFFER="offer",e.ANSWER="answer",e.TRICKLE="trickle",e.TRACK_UPDATE="track-update",e.BROADCAST="broadcast",e.ANALYTICS="analytics",e.SERVER_ERROR="on-error",e.SERVER_WARNING="on-warning",e.SDK_NOTIFICATION="sdk-notification",e.LEAVE="leave",e.END_ROOM="end-room",e.PING="ping",e.ROLE_CHANGE_REQUEST="role-change-request",e.ROLE_CHANGE="role-change",e.TRACK_UPDATE_REQUEST="track-update-request",e.PEER_LEAVE_REQUEST="peer-leave-request",e.CHANGE_TRACK_MUTE_STATE_REQUEST="change-track-mute-state-request",e.START_RTMP_OR_RECORDING_REQUEST="rtmp-start",e.STOP_RTMP_AND_RECORDING_REQUEST="rtmp-stop",e.UPDATE_PEER_METADATA="peer-update",e.START_HLS_STREAMING="hls-start",e.STOP_HLS_STREAMING="hls-stop"}(br||(br={}));var Pr,Rr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;m(this,e),this.capacity=t,this.storage=[]}return y(e,[{key:"size",value:function(){return this.storage.length}},{key:"toList",value:function(){return this.storage.slice(0)}},{key:"enqueue",value:function(e){this.size()===this.capacity&&this.dequeue(),this.storage.push(e)}},{key:"dequeue",value:function(){return this.storage.shift()}},{key:"aggregate",value:function(e){return e(this.storage)}}]),e}(),_r=function(){function e(t){var n=this;m(this,e),this.TAG="[ SIGNAL ]: ",this.pongResponseTimes=new Rr(5),this.isJoinCompleted=!1,this.pendingTrickle=[],this.socket=null,this.callbacks=new Map,this._isConnected=!1,this.id=0,this.observer=t,window.addEventListener("offline",(function(){hn.d(n.TAG,"Window network offline"),n.setIsConnected(!1,"Window network offline")})),window.addEventListener("online",(function(){hn.d(n.TAG,"Window network online"),n.observer.onNetworkOnline()})),this.onCloseHandler=this.onCloseHandler.bind(this),this.onMessageHandler=this.onMessageHandler.bind(this)}return y(e,[{key:"isConnected",get:function(){return this._isConnected}},{key:"setIsConnected",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";hn.d(this.TAG,"isConnected set",{id:this.id,old:this._isConnected,new:e}),this._isConnected!==e&&(this._isConnected&&!e?(this._isConnected=e,this.observer.onOffline(t)):!this._isConnected&&e&&(this._isConnected=e,this.observer.onOnline()))}},{key:"getPongResponseTimes",value:function(){return this.pongResponseTimes.toList()}},{key:"call",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a,o,s=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=qt(),a={method:e,params:t,id:i,jsonrpc:"2.0"},null==(r=this.socket)||r.send(JSON.stringify(a)),n.prev=2,n.next=5,new Promise((function(e,t){s.callbacks.set(i,{resolve:e,reject:t})}));case 5:return n.abrupt("return",n.sent);case 8:throw n.prev=8,n.t0=n.catch(2),o=n.t0,xn.ServerErrors(Number(o.code),Cr(e),o.message);case 12:case"end":return n.stop()}}),n,this,[[2,8]])})))}},{key:"notify",value:function(e,t){var n,r={method:e,params:t};null==(n=this.socket)||n.send(JSON.stringify(r))}},{key:"open",value:function(e){var t=this;return new Promise((function(n,r){t.socket&&(t.socket.removeEventListener("close",t.onCloseHandler),t.socket.removeEventListener("message",t.onMessageHandler)),t.socket=new WebSocket(e);var i=function(e){hn.e(t.TAG,"Error from websocket",e),r(wn.FailedToConnect(yn.JOIN,"Error opening websocket connection - ".concat(e)))};t.socket.addEventListener("error",i);t.socket.addEventListener("open",(function e(){var r,a;n(),t.setIsConnected(!0),t.id++,null==(r=t.socket)||r.removeEventListener("open",e),null==(a=t.socket)||a.removeEventListener("error",i),t.pingPongLoop(t.id)})),t.socket.addEventListener("close",t.onCloseHandler),t.socket.addEventListener("message",t.onMessageHandler)}))}},{key:"close",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.socket?(this.socket.close(1e3,"Normal Close"),this.setIsConnected(!1,"code: 1000, normal websocket close"),this.socket.removeEventListener("close",this.onCloseHandler),this.socket.removeEventListener("message",this.onMessageHandler)):this.setIsConnected(!1,"websocket not connected yet");case 1:case"end":return e.stop()}}),e,this)})))}},{key:"join",value:function(e,t,n,r,i){return an(this,null,u().mark((function a(){var o,s,c=this;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o={name:e,disableVidAutoSub:r,data:t,offer:n,server_sub_degrade:i},a.next=3,this.call(br.JOIN,o);case 3:return s=a.sent,a.abrupt("return",(this.isJoinCompleted=!0,this.pendingTrickle.forEach((function(e){var t=e.target,n=e.candidate;return c.trickle(t,n)})),this.pendingTrickle.length=0,hn.d(this.TAG,"join: response=".concat(JSON.stringify(s,null,1))),s));case 5:case"end":return a.stop()}}),a,this)})))}},{key:"trickle",value:function(e,t){this.isJoinCompleted?this.notify(br.TRICKLE,{target:e,candidate:t}):this.pendingTrickle.push({target:e,candidate:t})}},{key:"offer",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.call(br.OFFER,{desc:e,tracks:Object.fromEntries(t)});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"answer",value:function(e){this.notify(br.ANSWER,{desc:e})}},{key:"trackUpdate",value:function(e){this.notify(br.TRACK_UPDATE,{version:"1.0",tracks:Object.fromEntries(e)})}},{key:"broadcast",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.BROADCAST,nn({version:"1.0"},e.toSignalParams()));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"leave",value:function(){this.notify(br.LEAVE,{version:"1.0"})}},{key:"endRoom",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.call(br.END_ROOM,{lock:e,reason:t});case 2:case"end":return n.stop()}}),n,this)})))}},{key:"sendEvent",value:function(e){if(!this.isConnected)throw Error("".concat(this.TAG," not connected. Could not send event ").concat(e));this.notify(br.ANALYTICS,e.toSignalParams())}},{key:"ping",value:function(e){var t=Date.now(),n=new Promise((function(n){setTimeout((function(){n(Date.now()-t)}),e+1)})),r=this.call(br.PING,{timestamp:t}).then((function(){return Date.now()-t})).catch((function(){return Date.now()-t}));return Promise.race([n,r])}},{key:"requestRoleChange",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.ROLE_CHANGE_REQUEST,e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"acceptRoleChangeRequest",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.ROLE_CHANGE,e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"requestTrackStateChange",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.TRACK_UPDATE_REQUEST,e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"requestMultiTrackStateChange",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.CHANGE_TRACK_MUTE_STATE_REQUEST,e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"removePeer",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.PEER_LEAVE_REQUEST,e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"startRTMPOrRecording",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.START_RTMP_OR_RECORDING_REQUEST,nn({version:"1.0"},e));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"stopRTMPAndRecording",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call(br.STOP_RTMP_AND_RECORDING_REQUEST,{version:"1.0"});case 2:case"end":return e.stop()}}),e,this)})))}},{key:"startHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.START_HLS_STREAMING,nn({version:"1.0"},e));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"stopHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.STOP_HLS_STREAMING,nn({version:"1.0"},e));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"updatePeer",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(br.UPDATE_PEER_METADATA,nn({version:"1.0"},e));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"onCloseHandler",value:function(e){hn.d("Websocket closed code=".concat(e.code)),this.setIsConnected(!1,"code: ".concat(e.code).concat(1e3!==e.code?", unexpected websocket close":""))}},{key:"onMessageHandler",value:function(e){var t=e.data,n=JSON.parse(t);if(n.id)this.handleResponseWithId(n);else{if(!n.method)throw Error("WebSocket message has no 'method' or 'id' field, message=".concat(n));this.handleResponseWithMethod(n)}}},{key:"handleResponseWithId",value:function(e){var t=e,n=t.id;if(this.callbacks.has(n)){var r=this.callbacks.get(n);this.callbacks.delete(n),t.result?r.resolve(t.result):r.reject(t.error)}else this.observer.onNotification(t)}},{key:"handleResponseWithMethod",value:function(e){switch(e.method){case br.OFFER:this.observer.onOffer(e.params);break;case br.TRICKLE:this.observer.onTrickle(e.params);break;case br.SERVER_ERROR:this.observer.onServerError(xn.ServerErrors(Number(e.params.code),yn.NONE,e.params.message));break;case br.SERVER_WARNING:hn.w(this.TAG,e.params);break;default:this.observer.onNotification(e)}}},{key:"pingPongLoop",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(null==(n=window.HMS)?void 0:n.PING_TIMEOUT)||12e3,!this.isConnected){t.next=6;break}return t.next=4,this.ping(i);case 4:a=t.sent,this.pongResponseTimes.enqueue(a),a>i?(hn.d(this.TAG,"Pong timeout ".concat(e,", pageHidden=").concat("undefined"!=typeof document&&document.hidden)),this.id===e&&this.setIsConnected(!1,"ping pong failure")):setTimeout((function(){return o.pingPongLoop(e)}),(null==(r=window.HMS)?void 0:r.PING_INTERVAL)||1e3);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}(),Ir=function(){function e(){m(this,e),this._volume=1,this._codec=pn.OPUS,this._maxBitrate=32,this._deviceId="default",this._advanced=[{googEchoCancellation:{exact:!0}},{googExperimentalEchoCancellation:{exact:!0}},{autoGainControl:{exact:!0}},{noiseSuppression:{exact:!0}},{googHighpassFilter:{exact:!0}},{googAudioMirroring:{exact:!0}}]}return y(e,[{key:"volume",value:function(e){if(!(0<=e&&e<=1))throw Error("volume can only be in range [0.0, 1.0]");return this._volume=e,this}},{key:"codec",value:function(e){return this._codec=e,this}},{key:"maxBitrate",value:function(e){if(e&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate=e,this}},{key:"deviceId",value:function(e){return this._deviceId=e,this}},{key:"advanced",value:function(e){return this._advanced=e,this}},{key:"build",value:function(){return new Ar(this._volume,this._codec,this._maxBitrate,this._deviceId,this._advanced)}}]),e}(),Ar=function(){function e(t,n,r,i,a){m(this,e),this.volume=t,this.codec=n,this.maxBitrate=r,this.deviceId=i,this.advanced=a}return y(e,[{key:"toConstraints",value:function(){return{deviceId:this.deviceId,advanced:this.advanced}}},{key:"toAnalyticsProperties",value:function(){return{audio_bitrate:this.maxBitrate,audio_codec:this.codec}}}]),e}(),Dr=function(){function e(){m(this,e),this._width=320,this._height=180,this._codec=fn.VP8,this._maxFramerate=30,this._maxBitrate=150,this._advanced=[]}return y(e,[{key:"setWidth",value:function(e){return this._width=e,this}},{key:"setHeight",value:function(e){return this._height=e,this}},{key:"codec",value:function(e){return this._codec=e,this}},{key:"maxFramerate",value:function(e){if(e&&e<=0)throw Error("maxFramerate should be >= 1");return this._maxFramerate=e,this}},{key:"maxBitrate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("number"==typeof e&&e<=0)throw Error("maxBitrate should be >= 1");return this._maxBitrate=e,!this._maxBitrate&&t&&(this._maxBitrate=15e4),this}},{key:"deviceId",value:function(e){return this._deviceId=e,this}},{key:"advanced",value:function(e){return this._advanced=e,this}},{key:"build",value:function(){return new Nr(this._width,this._height,this._codec,this._maxFramerate,this._deviceId,this._advanced,this._maxBitrate)}}]),e}(),Nr=function(){function e(t,n,r,i,a,o,s){m(this,e),this.width=t,this.height=n,this.codec=r,this.maxFramerate=i,this.maxBitrate=s,this.deviceId=a,this.advanced=o}return y(e,[{key:"toConstraints",value:function(){return{width:this.width,height:this.height,frameRate:this.maxFramerate,deviceId:this.deviceId}}},{key:"toAnalyticsProperties",value:function(){return{width:this.width,height:this.height,video_bitrate:this.maxBitrate,framerate:this.maxFramerate,video_codec:this.codec}}}]),e}(),Or=function(){function e(){m(this,e),this._video=(new Dr).build(),this._audio=(new Ir).build(),this._screen=(new Dr).build(),this._simulcast=!1}return y(e,[{key:"video",value:function(e){return this._video=e,this}},{key:"audio",value:function(e){return this._audio=e,this}},{key:"screen",value:function(e){return this._screen=e,this}},{key:"simulcast",value:function(e){return this._simulcast=e,this}},{key:"build",value:function(){if(null===this._audio&&null===this._video)throw Tn.NothingToReturn(yn.TRACK);if(null===this._video&&this._simulcast)throw Tn.InvalidVideoSettings(yn.TRACK,"Cannot enable simulcast when no video settings are provided");return new Lr(this._video,this._audio,this._simulcast,this._screen||void 0)}}]),e}(),Lr=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;m(this,e),this.video=t,this.audio=n,this.simulcast=r,this.screen=i}return y(e,[{key:"toAnalyticsProperties",value:function(){var e={audio_enabled:null!==this.audio,video_enabled:null!==this.video};return this.audio&&(e=nn(nn({},this.audio.toAnalyticsProperties()),e)),this.video&&(e=nn(nn({},this.video.toAnalyticsProperties()),e)),e}}]),e}();!function(e){e.ROOM_STATE="room-state",e.PEER_JOIN="on-peer-join",e.PEER_LEAVE="on-peer-leave",e.PEER_LIST="peer-list",e.TRACK_METADATA_ADD="on-track-add",e.TRACK_UPDATE="on-track-update",e.CHANGE_TRACK_MUTE_STATE_UPDATE="on-change-track-mute-state-request",e.ACTIVE_SPEAKERS="active-speakers",e.CONNECTION_QUALITY="on-connection-quality-update",e.SFU_STATS="sfu-stats",e.ON_SFU_TRACK_LAYER_UPDATE="on-track-layer-update",e.BROADCAST="on-broadcast",e.ROLE_CHANGE="on-role-change",e.POLICY_CHANGE="on-policy-change",e.ROLE_CHANGE_REQUEST="on-role-change-request",e.TRACK_UPDATE_REQUEST="on-track-update-request",e.PEER_UPDATE="on-peer-update",e.PEER_LEAVE_REQUEST="on-peer-leave-request",e.UNSUPPORTED="unsupported",e.RTMP_START="on-rtmp-start",e.RTMP_STOP="on-rtmp-stop",e.RECORDING_START="on-record-start",e.RECORDING_STOP="on-record-stop",e.HLS_START="on-hls-start",e.HLS_STOP="on-hls-stop"}(Pr||(Pr={}));var Mr=function(){function e(t,n,r){m(this,e),this.store=t,this.listener=n,this.audioListener=r}return y(e,[{key:"handleActiveSpeakers",value:function(e){var t,n,r,i=this,a=e["speaker-list"],o=a.map((function(e){return{audioLevel:e.level,peer:i.store.getPeerById(e.peer_id),track:i.store.getTrackById(e.track_id)}}));null==(t=this.audioListener)||t.onAudioLevelUpdate(o),this.store.updateSpeakers(o);var s=a[0];if(s){var u=this.store.getPeerById(s.peer_id);null==(n=this.listener)||n.onPeerUpdate(sn.BECAME_DOMINANT_SPEAKER,u)}else null==(r=this.listener)||r.onPeerUpdate(sn.RESIGNED_DOMINANT_SPEAKER,null)}}]),e}(),Ur=function(){function e(t){var n=t.sender,r=t.message,i=t.type,a=void 0===i?"chat":i,o=t.recipientPeer,s=t.recipientRoles,u=t.time;m(this,e),this.sender=n,this.message=r,this.type=a,this.recipientPeer=o,this.recipientRoles=s,this.time=u}return y(e,[{key:"toSignalParams",value:function(){var e,t,n=null==(e=this.recipientRoles)?void 0:e.map((function(e){return e.name})),r=null==(t=this.recipientPeer)?void 0:t.peerId,i={info:{message:this.message,type:this.type}};return(null==n?void 0:n.length)&&(i.roles=n),r&&(i.peer_id=r),i}}]),e}(),Fr=function(){function e(t){var n=t.peerId,r=t.name,i=t.isLocal,a=t.customerUserId,o=t.metadata,s=t.role,u=t.joinedAt;m(this,e),this.customerUserId="",this.metadata="",this.auxiliaryTracks=[],this.name=r,this.peerId=n,this.isLocal=i,this.customerUserId=a,this.metadata=o,this.joinedAt=u,s&&(this.role=s)}return y(e,[{key:"updateRole",value:function(e){this.role=e}},{key:"updateName",value:function(e){this.name=e}},{key:"updateMetadata",value:function(e){this.metadata=e}}]),e}(),jr=y((function e(){m(this,e)}));jr.makePeerId=function(){return qt()};var Br,Vr=function(e){Ce(n,e);var t=_e(n);function n(e){var r;return m(this,n),(r=t.call(this,rn(nn({},e),{peerId:jr.makePeerId(),isLocal:!0}))).isLocal=!0,r.auxiliaryTracks=[],r}return y(n)}(Fr),Gr=function(e){Ce(n,e);var t=_e(n);function n(e){var r;return m(this,n),(r=t.call(this,rn(nn({},e),{isLocal:!1}))).isLocal=!1,r.auxiliaryTracks=[],r.fromRoomState=!1,r.fromRoomState=!!e.fromRoomState,r}return y(n)}(Fr),zr=function(){function e(t,n){m(this,e),this.store=t,this.listener=n}return y(e,[{key:"TAG",get:function(){return"[".concat(this.constructor.name,"]")}},{key:"handleNotification",value:function(e,t){e===Pr.BROADCAST&&this.handleBroadcast(t)}},{key:"handleBroadcast",value:function(e){var t,n=e.peer,r=e.info,i=e.roles,a=this.getSender(n),o=e.private?this.store.getLocalPeer():void 0,s=[];if(null==i?void 0:i.length){var u,c=this.store.getKnownRoles(),l=k(i);try{for(l.s();!(u=l.n()).done;){var d=u.value;c[d]&&s.push(c[d])}}catch(f){l.e(f)}finally{l.f()}}var h=new Ur(rn(nn({},r),{sender:a,recipientRoles:s,recipientPeer:o,time:new Date(e.timestamp)}));hn.d(this.TAG,"Received Message:: ",h),null==(t=this.listener)||t.onMessageReceived(h)}},{key:"getSender",value:function(e){var t=e?this.store.getPeerById(e.peer_id):void 0;return!t&&e&&(t=new Fr({peerId:e.peer_id,name:e.info.name,isLocal:!1,customerUserId:e.info.user_id,metadata:e.info.data})),t}}]),e}(),Hr=function(){function e(t,n,r,i){var a=this;m(this,e),this.store=t,this.peerManager=n,this.trackManager=r,this.listener=i,this.handleInitialPeerList=function(e){var t=Object.values(e.peers);a.peerManager.handlePeerList(t)},this.handleReconnectPeerList=function(e){a.handleRepeatedPeerList(e.peers)},this.handlePreviewRoomState=function(e){if(a.store.hasRoleDetailsArrived()){var t=e.peers||{};Object.keys(t).forEach((function(e){t[e].tracks={},t[e].is_from_room_state=!0})),a.handleRepeatedPeerList(t)}},this.handleRepeatedPeerList=function(e){var t=a.store.getRemotePeers(),n=Object.values(e),r=t.filter((function(t){return!e[t.peerId]}));hn.d(a.TAG,{peersToRemove:r}),r.forEach((function(e){var t,n={peer_id:e.peerId,role:(null==(t=e.role)?void 0:t.name)||"",info:{name:e.name,data:e.metadata||"",user_id:e.customerUserId||""},tracks:{}};a.peerManager.handlePeerLeave(n)})),n.forEach((function(e){var t=a.store.getPeerById(e.peer_id),n=Object.values(e.tracks);t?(a.store.getPeerTracks(t.peerId).forEach((function(n){var r;e.tracks[n.trackId]||(a.removePeerTrack(t,n.trackId),null==(r=a.listener)||r.onTrackUpdate(un.TRACK_REMOVED,n,t))})),n.forEach((function(e){a.store.getTrackById(e.track_id)||a.store.setTrackState({peerId:t.peerId,trackInfo:e})})),a.trackManager.handleTrackUpdate({peer:{info:e.info,peer_id:e.peer_id},tracks:e.tracks}),a.peerManager.handlePeerUpdate(e)):a.peerManager.handlePeerJoin(e)}))}}return y(e,[{key:"TAG",get:function(){return"[".concat(this.constructor.name,"]")}},{key:"handleNotification",value:function(e,t,n){if(e===Pr.PEER_LIST){var r=t;n?(hn.d(this.TAG,"RECONNECT_PEER_LIST event",r),this.handleReconnectPeerList(r)):(hn.d(this.TAG,"PEER_LIST event",r),this.handleInitialPeerList(r))}else if(e===Pr.ROOM_STATE){var i=t;this.handlePreviewRoomState(i)}}},{key:"removePeerTrack",value:function(e,t){var n,r;if((null==(n=e.audioTrack)?void 0:n.trackId)===t)e.audioTrack=void 0;else if((null==(r=e.videoTrack)?void 0:r.trackId)===t)e.videoTrack=void 0;else{var i=e.auxiliaryTracks.findIndex((function(e){return e.trackId===t}));i>=0&&e.auxiliaryTracks.splice(i,1)}}}]),e}(),Kr=function(e){return e?new Date(e):void 0},Wr=function(){function e(t,n,r){var i=this;m(this,e),this.store=t,this.trackManager=n,this.listener=r,this.handlePeerList=function(e){var t;if(0!==e.length){var n=[],r=new Set(e.map((function(e){return e.peer_id})));i.store.getRemotePeers().forEach((function(e){var t=e.peerId,n=e.fromRoomState;!r.has(t)&&n&&i.store.removePeer(t)}));var a,o=k(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;n.push(i.makePeer(s))}}catch(u){o.e(u)}finally{o.f()}null==(t=i.listener)||t.onPeerUpdate(sn.PEER_LIST,n),i.trackManager.processPendingTracks()}},this.handlePeerJoin=function(e){var t,n=i.makePeer(e);null==(t=i.listener)||t.onPeerUpdate(sn.PEER_JOINED,n),i.trackManager.processPendingTracks()},this.handlePeerLeave=function(e){var t,n,r,a,o=i.store.getPeerById(e.peer_id);i.store.removePeer(e.peer_id),hn.d(i.TAG,"PEER_LEAVE event",e,i.store.getPeers()),o&&(o.audioTrack&&(null==(t=i.listener)||t.onTrackUpdate(un.TRACK_REMOVED,o.audioTrack,o)),o.videoTrack&&(null==(n=i.listener)||n.onTrackUpdate(un.TRACK_REMOVED,o.videoTrack,o)),null==(r=o.auxiliaryTracks)||r.forEach((function(e){var t;null==(t=i.listener)||t.onTrackUpdate(un.TRACK_REMOVED,e,o)})),null==(a=i.listener)||a.onPeerUpdate(sn.PEER_LEFT,o))}}return y(e,[{key:"TAG",get:function(){return"[".concat(this.constructor.name,"]")}},{key:"handleNotification",value:function(e,t){switch(e){case Pr.PEER_JOIN:var n=t;this.handlePeerJoin(n);break;case Pr.PEER_LEAVE:var r=t;this.handlePeerLeave(r);break;case Pr.PEER_UPDATE:this.handlePeerUpdate(t)}}},{key:"handlePeerUpdate",value:function(e){var t,n=this.store.getPeerById(e.peer_id);if(n){if(n.role&&n.role.name!==e.role){var r=this.store.getPolicyForRole(e.role);n.updateRole(r),null==(t=this.listener)||t.onPeerUpdate(sn.ROLE_UPDATED,n)}this.handlePeerInfoUpdate(nn({peer:n},e.info))}}},{key:"handlePeerInfoUpdate",value:function(e){var t,n,r=e.peer,i=e.name,a=e.data;!r||(i&&r.name!==i&&(r.updateName(i),null==(t=this.listener)||t.onPeerUpdate(sn.NAME_UPDATED,r)),a&&r.metadata!==a&&(r.updateMetadata(a),null==(n=this.listener)||n.onPeerUpdate(sn.METADATA_UPDATED,r)))}},{key:"makePeer",value:function(e){var t=new Gr({peerId:e.peer_id,name:e.info.name,customerUserId:e.info.user_id,metadata:e.info.data,role:this.store.getPolicyForRole(e.role),joinedAt:Kr(e.joined_at),fromRoomState:!!e.is_from_room_state});for(var n in this.store.addPeer(t),hn.d(this.TAG,"adding to the peerList",t),e.tracks)this.store.setTrackState({peerId:e.peer_id,trackInfo:e.tracks[n]});return t}}]),e}(),qr=function(){function e(t,n){m(this,e),this.store=t,this.eventBus=n}return y(e,[{key:"handlePolicyChange",value:function(e){var t,n,r=this.store.getLocalPeer();if(r&&!r.role){var i=e.known_roles[e.name];r.updateRole(i)}this.store.setKnownRoles(e.known_roles);var a=null==(t=e.known_roles[e.name])?void 0:t.publishParams;if(this.store.setPublishParams(a),this.setSimulcastLayers(a),this.handleStreamingRecordingPermissions(null==(n=e.known_roles[e.name])?void 0:n.permissions),(null==r?void 0:r.role)&&r.role.name!==e.name){var o=this.store.getPolicyForRole(e.name),s=r.role;r.updateRole(o),this.eventBus.localRoleUpdate.publish({oldRole:s,newRole:o})}this.eventBus.policyChange.publish(e)}},{key:"setSimulcastLayers",value:function(e){if(e&&Object.keys(e).length>0){var t=e.videoSimulcastLayers,n=e.screenSimulcastLayers;this.store.setVideoSimulcastLayers(t),this.store.setScreenshareSimulcastLayers(n)}}},{key:"handleStreamingRecordingPermissions",value:function(e){e&&(void 0===e.recording&&(e.recording=!0),void 0===e.streaming&&(e.streaming=!0))}}]),e}(),Qr=function(){function e(t,n){m(this,e),this.store=t,this.listener=n}return y(e,[{key:"handleNotification",value:function(e,t){switch(e){case Pr.ROLE_CHANGE_REQUEST:this.handleRoleChangeRequest(t);break;case Pr.TRACK_UPDATE_REQUEST:this.handleTrackUpdateRequest(t);break;case Pr.CHANGE_TRACK_MUTE_STATE_UPDATE:this.handleChangeTrackStateRequest(t);break;default:return}}},{key:"handleRoleChangeRequest",value:function(e){var t,n={requestedBy:e.requested_by?this.store.getPeerById(e.requested_by):void 0,role:this.store.getPolicyForRole(e.role),token:e.token};null==(t=this.listener)||t.onRoleChangeRequest(n)}},{key:"handleTrackUpdateRequest",value:function(e){var t=this,n=e.requested_by,r=e.track_id,i=e.mute,a=n?this.store.getPeerById(n):void 0,o=this.store.getLocalPeerTracks().find((function(e){return e.publishedTrackId===r}));if(o){var s=function(){var e;null==(e=t.listener)||e.onChangeTrackStateRequest({requestedBy:a,track:o,enabled:!i})};if(i){if(o.enabled===!i)return;o.setEnabled(!i).then(s)}else s()}}},{key:"handleChangeTrackStateRequest",value:function(e){var t,n=this,r=e.type,i=e.source,a=e.value,o=e.requested_by,s=o?this.store.getPeerById(o):void 0,u=!a,c=this.getTracksToBeUpdated({type:r,source:i,enabled:u});if(0!==c.length)if(u)null==(t=this.listener)||t.onChangeMultiTrackStateRequest({requestedBy:s,tracks:c,type:r,source:i,enabled:!0});else{var l,d=[],h=k(c);try{for(h.s();!(l=h.n()).done;){var f=l.value;d.push(f.setEnabled(!1))}}catch(p){h.e(p)}finally{h.f()}Promise.all(d).then((function(){var e;null==(e=n.listener)||e.onChangeMultiTrackStateRequest({requestedBy:s,tracks:c,enabled:!1})}))}}},{key:"getTracksToBeUpdated",value:function(e){var t=e.type,n=e.source,r=e.enabled,i=this.store.getLocalPeerTracks();return t&&(i=i.filter((function(e){return e.type===t}))),n&&(i=i.filter((function(e){return e.source===n}))),i.filter((function(e){return e.enabled!==r}))}}]),e}(),Jr=function(){function e(t,n){m(this,e),this.store=t,this.listener=n}return y(e,[{key:"handleNotification",value:function(e,t){switch(e){case Pr.PEER_LIST:this.onRoomState(t.room);break;case Pr.RTMP_START:this.onRTMPStart(t);break;case Pr.RTMP_STOP:this.onRTMPStop(t);break;case Pr.RECORDING_START:this.onRecordingStart(t);break;case Pr.RECORDING_STOP:this.onRecordingStop(t);break;case Pr.ROOM_STATE:this.handlePreviewRoomState(t);break;default:this.onHLS(e,t)}}},{key:"handlePreviewRoomState",value:function(e){var t=e.room;this.onRoomState(t,e.peer_count)}},{key:"onRoomState",value:function(e,t){var n,r,i,a=e.recording,o=e.streaming,s=e.session_id,u=e.started_at,c=e.name,l=this.store.getRoom();l.peerCount=t,l.name=c,l.recording.server.running=!!(null==a?void 0:a.sfu.enabled),l.recording.browser.running=!!(null==a?void 0:a.browser.enabled),l.rtmp.running=!!(null==(n=null==o?void 0:o.rtmp)?void 0:n.enabled),l.rtmp.startedAt=Kr(null==(r=null==o?void 0:o.rtmp)?void 0:r.started_at),l.recording.server.startedAt=Kr(null==a?void 0:a.sfu.started_at),l.recording.browser.startedAt=Kr(null==a?void 0:a.browser.started_at),l.recording.hls=this.getPeerListHLSRecording(a),l.hls=this.convertHls(null==o?void 0:o.hls),l.sessionId=s,l.startedAt=Kr(u),null==(i=this.listener)||i.onRoomUpdate(on.RECORDING_STATE_UPDATED,l)}},{key:"onRTMPStart",value:function(e){var t;this.setRTMPStatus(!(null==(t=e.error)?void 0:t.code),e)}},{key:"onRTMPStop",value:function(e){this.setRTMPStatus(!1,e)}},{key:"onRecordingStart",value:function(e){var t;this.setRecordingStatus(!(null==(t=e.error)?void 0:t.code),e)}},{key:"onRecordingStop",value:function(e){this.setRecordingStatus(!1,e)}},{key:"onHLS",value:function(e,t){var n,r;if([Pr.HLS_START,Pr.HLS_STOP].includes(e)){var i=this.store.getRoom();t.enabled=e===Pr.HLS_START&&!(null==(n=t.error)?void 0:n.code),i.hls=this.convertHls(t),i.recording.hls=this.getHLSRecording(t),null==(r=this.listener)||r.onRoomUpdate(on.HLS_STREAMING_STATE_UPDATED,i)}}},{key:"convertHls",value:function(e){var t,n,r={running:!!(null==e?void 0:e.enabled),variants:[],error:(null==(t=null==e?void 0:e.error)?void 0:t.code)?e.error:void 0};return null==(n=null==e?void 0:e.variants)||n.forEach((function(e){r.variants.push({meetingURL:e.meeting_url,url:e.url,metadata:e.metadata,startedAt:Kr(e.started_at)})})),r}},{key:"getHLSRecording",value:function(e){var t,n,r,i,a={running:!1};return(null==e?void 0:e.hls_recording)&&(a={running:!!(null==e?void 0:e.enabled),singleFilePerLayer:!!(null==(t=e.hls_recording)?void 0:t.single_file_per_layer),hlsVod:!!(null==(n=e.hls_recording)?void 0:n.hls_vod),startedAt:Kr(null==(r=null==e?void 0:e.variants)?void 0:r[0].started_at),error:(null==(i=null==e?void 0:e.error)?void 0:i.code)?e.error:void 0}),a}},{key:"getPeerListHLSRecording",value:function(e){var t,n,r=null==e?void 0:e.hls;return{running:!!(null==r?void 0:r.enabled),startedAt:Kr(null==r?void 0:r.started_at),singleFilePerLayer:!!(null==(t=null==r?void 0:r.config)?void 0:t.single_file_per_layer),hlsVod:!!(null==(n=null==r?void 0:r.config)?void 0:n.hls_vod)}}},{key:"setRecordingStatus",value:function(e,t){var n,r,i,a,o=this.store.getRoom();"sfu"===t.type?(o.recording.server={running:e,startedAt:e?Kr(t.started_at):void 0,error:(null==(n=t.error)?void 0:n.code)?t.error:void 0},a=on.SERVER_RECORDING_STATE_UPDATED):(o.recording.browser={running:e,startedAt:e?Kr(t.started_at):void 0,error:(null==(r=t.error)?void 0:r.code)?t.error:void 0},a=on.BROWSER_RECORDING_STATE_UPDATED),null==(i=this.listener)||i.onRoomUpdate(a,o)}},{key:"setRTMPStatus",value:function(e,t){var n,r,i=this.store.getRoom();i.rtmp={running:e,startedAt:e?Kr(t.started_at):void 0,error:(null==(n=t.error)?void 0:n.code)?t.error:void 0},null==(r=this.listener)||r.onRoomUpdate(on.RTMP_STREAMING_STATE_UPDATED,i)}}]),e}();function $r(e,t){if("screen"===t&&("chrome"===Lt.browserDetails.browser&&"NotAllowedError"===e.name&&e.message.includes("denied by system")||"NotFoundError"===e.name))return Tn.SystemDeniedPermission(yn.TRACK,t,e.message);switch(e.name){case"OverconstrainedError":return Tn.OverConstrained(yn.TRACK,t,e.constraint);case"NotAllowedError":return Tn.CantAccessCaptureDevice(yn.TRACK,t,e.message);case"NotFoundError":return Tn.DeviceNotAvailable(yn.TRACK,t,e.message);case"NotReadableError":return Tn.DeviceInUse(yn.TRACK,t,e.message);case"TypeError":return Tn.NothingToReturn(yn.TRACK,e.message);default:return function(e,t){var n=e.toLowerCase();return n.includes("device not found")?Tn.DeviceNotAvailable(yn.TRACK,t,e):n.includes("permission denied")?Tn.CantAccessCaptureDevice(yn.TRACK,t,e):Tn.GenericTrack(yn.TRACK,e)}(e.message,t)}}function Yr(e,t){var n=$r(e,t);return n.addNativeError(e),n}function Xr(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({audio:!!e&&e.toConstraints()});case 3:return t.abrupt("return",t.sent.getAudioTracks()[0]);case 6:throw t.prev=6,t.t0=t.catch(0),Yr(t.t0,Br.AUDIO);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))}function Zr(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:!!e&&e.toConstraints()});case 3:return t.abrupt("return",t.sent.getVideoTracks()[0]);case 6:throw t.prev=6,t.t0=t.catch(0),Yr(t.t0,Br.VIDEO);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))}function ei(e){return"canvas"in e||"MediaStreamAudioDestinationNode"===e.label||""===e.label}function ti(e){if(e<0)throw Error("`ms` should be a positive integer");return new Promise((function(t){return setTimeout(t,e)}))}!function(e){e.AUDIO="audio",e.VIDEO="video",e.AV="audio, video",e.SCREEN="screen"}(Br||(Br={}));var ni,ri,ii,ai=function(){function e(t,n,r){var i=this;m(this,e),this.track=t,this.audioLevelEvent=n,this.silenceEvent=r,this.TAG="[TrackAudioLevelMonitor]",this.audioLevel=0,this.isMonitored=!1,this.interval=100,this.historyInterval=700,this.history=new Rr(this.historyInterval/this.interval),this.detectSilence=function(){return an(i,null,u().mark((function e(){var t,n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=30,n=10,r=0;case 1:if(!this.isMonitored){e.next=14;break}if(!this.track.enabled){e.next=10;break}if(!this.isSilentThisInstant()){e.next=9;break}if(!(++r>n)){e.next=7;break}return this.silenceEvent.publish({track:this.track}),e.abrupt("break",14);case 7:e.next=10;break;case 9:return e.abrupt("break",14);case 10:return e.next=12,ti(t);case 12:e.next=1;break;case 14:case"end":return e.stop()}}),e,this)})))};try{var a=new MediaStream([this.track.nativeTrack]);this.analyserNode=this.createAnalyserNodeForStream(a)}catch(a){hn.w(this.TAG,"Unable to initialize AudioContext",a)}}return y(e,[{key:"start",value:function(){var e=this;this.stop(),this.isMonitored=!0,hn.d(this.TAG,"Starting track Monitor",this.track),this.loop().then((function(){return hn.d(e.TAG,"Stopping track Monitor",e.track)}))}},{key:"stop",value:function(){this.analyserNode?(this.sendAudioLevel(0),this.isMonitored=!1):hn.d(this.TAG,"AudioContext not initialized")}},{key:"loop",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMonitored){e.next=6;break}return this.sendAudioLevel(this.getMaxAudioLevelOverPeriod()),e.next=4,ti(this.interval);case 4:e.next=0;break;case 6:case"end":return e.stop()}}),e,this)})))}},{key:"sendAudioLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e=e>35?e:0,Math.abs(this.audioLevel-e)>5){this.audioLevel=e;var t={track:this.track,audioLevel:this.audioLevel};this.audioLevelEvent.publish(t)}}},{key:"getMaxAudioLevelOverPeriod",value:function(){if(this.analyserNode){var e=this.calculateAudioLevel();return void 0!==e&&this.history.enqueue(e),this.history.aggregate((function(e){return Math.max.apply(Math,v(e))}))}hn.d(this.TAG,"AudioContext not initialized")}},{key:"calculateAudioLevel",value:function(){if(this.analyserNode){var e=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(e);var t,n=.009,r=n,i=k(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r=Math.max(r,(a-128)/128)}}catch(s){i.e(s)}finally{i.f()}var o=(Math.log(n)-Math.log(r))/Math.log(n);return Math.ceil(Math.min(Math.max(100*o,0),100))}hn.d(this.TAG,"AudioContext not initialized")}},{key:"isSilentThisInstant",value:function(){if(this.analyserNode){var e=new Uint8Array(this.analyserNode.fftSize);return this.analyserNode.getByteTimeDomainData(e),!e.some((function(e){return 128!==e&&0!==e}))}hn.d(this.TAG,"AudioContext not initialized")}},{key:"createAnalyserNodeForStream",value:function(e){var t=new AudioContext,n=t.createAnalyser();return t.createMediaStreamSource(e).connect(n),n}}]),e}();!function(e){e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE"}(ni||(ni={})),function(e){e.PLATFORM_NOT_SUPPORTED="PLATFORM_NOT_SUPPORTED",e.DEVICE_NOT_SUPPORTED="DEVICE_NOT_SUPPORTED"}(ri||(ri={})),function(e){e.CUSTOM="CUSTOM",e.LOCAL="LOCAL",e.HMS="HMS"}(ii||(ii={}));var oi,si,ui=function(){if(kr&&window){var e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?ii.LOCAL:e.includes("app.100ms.live")?ii.HMS:ii.CUSTOM}return ii.CUSTOM}(),ci=function(){function e(t){var n=t.name,r=t.level,i=t.properties,a=t.includesPII,o=t.timestamp;m(this,e),this.metadata={},this.name=n,this.level=r,this.includesPII=a||!1,this.properties=i||{},this.timestamp=o||(new Date).getTime(),this.event_id=qt(),this.device_id=function(){var e="",t=new vr("hms-analytics-deviceId"),n=t.get();return n?e=n:(e=qt(),t.set(e)),e}()}return y(e,[{key:"toSignalParams",value:function(){return{name:this.name,info:rn(nn({},this.properties),{timestamp:this.timestamp,domain:ui}),timestamp:(new Date).getTime()}}}]),e}();!function(e){e[e.VERBOSE=0]="VERBOSE",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR",e[e.OFF=3]="OFF"}(oi||(oi={})),function(e){e[e.VERBOSE=0]="VERBOSE",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR",e[e.OFF=3]="OFF"}(si||(si={}));var li=function(){function e(){m(this,e)}return y(e,null,[{key:"failure",value:function(e,t){var n=si.ERROR,r=nn({plugin_name:e},t.toAnalyticsProperties());return new ci({name:"mediaPlugin.failed",level:n,properties:r})}},{key:"audioPluginFailure",value:function(e,t,n){var r=si.ERROR,i=nn({plugin_name:e,sampleRate:t},n.toAnalyticsProperties());return new ci({name:"mediaPlugin.failed",level:r,properties:i})}},{key:"audioPluginStats",value:function(e){var t=e.pluginName,n=e.duration,r=e.loadTime,i=e.sampleRate,a=si.INFO;return new ci({name:"mediaPlugin.stats",level:a,properties:{plugin_name:t,duration:n,load_time:r,sampleRate:i}})}},{key:"stats",value:function(e){var t=e.pluginName,n=e.duration,r=e.loadTime,i=e.avgPreProcessingTime,a=e.avgProcessingTime,o=e.inputFrameRate,s=e.pluginFrameRate,u=si.INFO;return new ci({name:"mediaPlugin.stats",level:u,properties:{plugin_name:t,duration:n,load_time:r,avg_preprocessing_time:i,avg_processing_time:a,input_frame_rate:o,plugin_frame_rate:s}})}}]),e}(),di="AudioPluginsAnalytics",hi=function(){function e(t){m(this,e),this.eventBus=t,this.initTime={},this.addedTimestamps={},this.pluginAdded={},this.pluginSampleRate={}}return y(e,[{key:"added",value:function(e,t){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.pluginSampleRate[e]=t}},{key:"removed",value:function(e){if(this.pluginAdded[e]){var t={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],sampleRate:this.pluginSampleRate[e]};this.eventBus.analytics.publish(li.audioPluginStats(t)),this.clean(e)}}},{key:"failure",value:function(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(li.audioPluginFailure(e,this.pluginSampleRate[e],t)),this.clean(e))}},{key:"initWithTime",value:function(e,t){return an(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.initTime[e]){n.next=3;break}return hn.i(di,"Plugin Already loaded ".concat(e,", time it took: ").concat(this.initTime[e])),n.abrupt("return");case 3:return n.prev=3,n.next=6,this.timeInMs(t);case 6:r=n.sent,hn.i(di,"Time taken for Plugin ".concat(e," initialization : ").concat(r)),n.next=14;break;case 10:throw n.prev=10,n.t0=n.catch(3),i=Pn.InitFailed(yn.AUDIO_PLUGINS,"failed during initialization of plugin".concat(n.t0.message||n.t0)),hn.e(di,i),this.failure(e,i),i;case 14:r&&(this.initTime[e]=r);case 15:case"end":return n.stop()}}),n,this,[[3,10]])})))}},{key:"timeInMs",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),t.next=3,e();case 3:return t.abrupt("return",Math.floor(Date.now()-n));case 4:case"end":return t.stop()}}),t)})))}},{key:"clean",value:function(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.pluginAdded[e],delete this.pluginSampleRate[e]}}]),e}(),fi="AudioPluginsManager",pi=function(){function e(t,n){m(this,e),this.pluginAddInProgress=!1,this.hmsTrack=t,this.pluginsMap=new Map,this.analytics=new hi(n),this.createAudioContext()}return y(e,[{key:"getPlugins",value:function(){return Array.from(this.pluginsMap.keys())}},{key:"addPlugin",value:function(e){return an(this,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null==(n=e.getName)?void 0:n.call(e)){t.next=4;break}return hn.w("no name provided by the plugin"),t.abrupt("return");case 4:if(!this.pluginAddInProgress){t.next=7;break}throw i=Pn.AddAlreadyInProgress(yn.AUDIO_PLUGINS,"Add Plugin is already in Progress"),this.analytics.added(r,this.audioContext.sampleRate),this.analytics.failure(r,i),hn.w("can't add another plugin when previous add is in progress"),i;case 7:return this.pluginAddInProgress=!0,t.prev=8,t.next=11,this.addPluginInternal(e);case 11:return t.prev=11,this.pluginAddInProgress=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[8,,11,14]])})))}},{key:"addPluginInternal",value:function(e){return an(this,null,u().mark((function t(){var n,r,i=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null==(n=e.getName)?void 0:n.call(e),!this.pluginsMap.get(r)){t.next=4;break}return hn.w(fi,"plugin - ".concat(r," already added.")),t.abrupt("return");case 4:return t.next=6,this.validateAndThrow(r,e);case 6:if(t.prev=6,0!==this.pluginsMap.size){t.next=12;break}return t.next=10,this.initAudioNodes();case 10:t.next=13;break;case 12:this.prevAudioNode&&this.prevAudioNode.disconnect();case 13:return this.analytics.added(r,this.audioContext.sampleRate),t.next=16,this.analytics.initWithTime(r,(function(){return an(i,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.init());case 1:case"end":return t.stop()}}),t)})))}));case 16:return this.pluginsMap.set(r,e),t.next=19,this.processPlugin(e);case 19:return t.next=21,this.connectToDestination();case 21:t.next=26;break;case 23:throw t.prev=23,t.t0=t.catch(6),hn.e(fi,"failed to add plugin",t.t0),t.t0;case 26:case"end":return t.stop()}}),t,this,[[6,23]])})))}},{key:"validatePlugin",value:function(e){return e.checkSupport(this.audioContext)}},{key:"validateAndThrow",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.validatePlugin(t)).isSupported){n.next=5;break}hn.i(fi,"plugin is supported,- ".concat(t.getName())),n.next=19;break;case 5:if(this.analytics.added(e,this.audioContext.sampleRate),r.errType!==ri.PLATFORM_NOT_SUPPORTED){n.next=13;break}return i=Pn.PlatformNotSupported(yn.AUDIO_PLUGINS,"platform not supported, see docs"),this.analytics.failure(e,i),n.next=10,this.cleanup();case 10:throw i;case 13:if(r.errType!==ri.DEVICE_NOT_SUPPORTED){n.next=19;break}return a=Pn.DeviceNotSupported(yn.AUDIO_PLUGINS,"audio device not supported, see docs"),this.analytics.failure(e,a),n.next=18,this.cleanup();case 18:throw a;case 19:case"end":return n.stop()}}),n,this)})))}},{key:"removePlugin",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.removePluginInternal(e);case 2:if(0!==this.pluginsMap.size){t.next=10;break}return t.next=5,this.cleanup();case 5:return hn.i(fi,"No plugins left, stopping plugins loop"),t.next=8,this.hmsTrack.setProcessedTrack(void 0);case 8:t.next=12;break;case 10:return t.next=12,this.reprocessPlugins();case 12:case"end":return t.stop()}}),t,this)})))}},{key:"cleanup",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=k(this.pluginsMap.values()),e.prev=1,i.s();case 3:if((a=i.n()).done){e.next=9;break}return o=a.value,e.next=7,this.removePluginInternal(o);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),i.e(e.t0);case 14:return e.prev=14,i.f(),e.finish(14);case 17:return e.next=19,this.hmsTrack.setProcessedTrack(void 0);case 19:null==(t=this.sourceNode)||t.disconnect(),null==(n=this.prevAudioNode)||n.disconnect(),null==(r=this.outputTrack)||r.stop(),this.sourceNode=void 0,this.destinationNode=void 0,this.prevAudioNode=void 0,this.outputTrack=void 0;case 26:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))}},{key:"closeContext",value:function(){return an(this,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.audioContext)||t.close(),this.audioContext=void 0;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"reprocessPlugins",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.pluginsMap.size&&this.sourceNode){e.next=2;break}return e.abrupt("return");case 2:return t=Array.from(this.pluginsMap.values()),e.next=5,this.cleanup();case 5:return e.next=7,this.initAudioNodes();case 7:n=0,r=t;case 8:if(!(n<r.length)){e.next=15;break}return i=r[n],e.next=12,this.addPlugin(i);case 12:n++,e.next=8;break;case 15:case"end":return e.stop()}}),e,this)})))}},{key:"initAudioNodes",value:function(){return an(this,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.audioContext){e.next=12;break}if(this.sourceNode||(t=new MediaStream([this.hmsTrack.nativeTrack]),this.sourceNode=this.audioContext.createMediaStreamSource(t)),this.destinationNode){e.next=12;break}return this.destinationNode=this.audioContext.createMediaStreamDestination(),this.outputTrack=this.destinationNode.stream.getAudioTracks()[0],e.prev=4,e.next=7,this.hmsTrack.setProcessedTrack(this.outputTrack);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),hn.e(fi,"error in setting processed track",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,this,[[4,9]])})))}},{key:"processPlugin",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.processAudioTrack(this.audioContext,this.prevAudioNode||this.sourceNode);case 3:n=t.sent,this.prevAudioNode&&this.prevAudioNode.connect(n),this.prevAudioNode=n,t.next=13;break;case 7:return t.prev=7,t.t0=t.catch(0),r=e.getName(),hn.e(fi,"error in processing plugin ".concat(r),t.t0),t.next=13,this.removePluginInternal(e);case 13:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"connectToDestination",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.prevAudioNode&&this.destinationNode&&this.prevAudioNode.context===this.destinationNode.context&&this.prevAudioNode.connect(this.destinationNode)}catch(t){hn.e(fi,"error in connecting to destination node",t)}case 1:case"end":return e.stop()}}),e,this)})))}},{key:"removePluginInternal",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null==(n=e.getName)?void 0:n.call(e),this.pluginsMap.get(r)){t.next=4;break}return hn.w(fi,"plugin - ".concat(r," not found to remove.")),t.abrupt("return");case 4:hn.i(fi,"removing plugin ".concat(r)),this.pluginsMap.delete(r),e.stop(),this.analytics.removed(r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"createAudioContext",value:function(){this.audioContext||(-1!==navigator.userAgent.indexOf("Firefox")?this.audioContext=new AudioContext:this.audioContext=new AudioContext({sampleRate:48e3}))}}]),e}(),vi=function(){function e(){m(this,e),this.storage=new vr("hms-device-selection"),this.remember=!1,this.TAG="HMSDeviceStorage"}return y(e,[{key:"setDevices",value:function(e){this.devices=e}},{key:"rememberDevices",value:function(e){this.remember=e}},{key:"updateSelection",value:function(e,t){var n=this,r=t.deviceId,i=t.groupId;if(this.devices&&this.remember){var a=this.devices[e].find((function(e){return n.isSame({deviceId:r,groupId:i},e)}));if(a){var o=this.storage.get()||{};o[e]=a,this.storage.set(o)}else hn.w(this.TAG,"Could not find device with deviceId: ".concat(r,", groupId: ").concat(i))}}},{key:"getSelection",value:function(){if(this.remember)return this.storage.get()}},{key:"cleanup",value:function(){this.remember=!1,this.devices=void 0}},{key:"isSame",value:function(e,t){return e.deviceId===t.deviceId&&(e.groupId===t.groupId||!e.groupId)}}]),e}(),mi=new vi;function gi(e,t){return function(n){return n in e&&e[n]!==t[n]}}var yi,ki=function(e){Ce(n,e);var t=_e(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(new Ir).build();return m(this,n),(o=t.call(this,e,r,i)).eventBus=a,o.handleSettingsChange=function(e){return an(Ee(o),null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.stream,r=gi(e,this.settings),t.t0=r("maxBitrate")&&e.maxBitrate,!t.t0){t.next=5;break}return t.next=5,n.setMaxBitrate(e.maxBitrate,this);case 5:if(t.t1=r("advanced"),!t.t1){t.next=9;break}return t.next=9,this.nativeTrack.applyConstraints(e.toConstraints());case 9:case"end":return t.stop()}}),t,this)})))},o.handleDeviceChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return an(Ee(o),null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=gi(e,this.settings)("deviceId"),!n.t0){n.next=5;break}return n.next=4,this.replaceTrackWith(e);case 4:t||mi.updateSelection("audioInput",{deviceId:e.deviceId,groupId:this.nativeTrack.getSettings().groupId});case 5:case"end":return n.stop()}}),n,this)})))},e.tracks.push(Ee(o)),o.settings=s,"default"===s.deviceId&&!ei(r)&&(o.settings=o.buildNewSettings({deviceId:r.getSettings().deviceId})),o.pluginsManager=new pi(Ee(o),a),o.setFirstTrackId(r.id),o}return y(n,[{key:"replaceTrackWith",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.nativeTrack,r=this.enabled,i=Boolean(this.audioLevelMonitor),null==n||n.stop(),t.next=4,Xr(e);case 4:return(a=t.sent).enabled=r,o=this.stream,t.next=9,o.replaceSenderTrack(n,this.processedTrack||a);case 9:return t.next=11,o.replaceStreamTrack(n,a);case 11:return this.nativeTrack=a,i&&this.initAudioLevelMonitor(),t.prev=13,t.next=16,this.pluginsManager.reprocessPlugins();case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(13),this.eventBus.audioPluginFailed.publish(t.t0);case 21:case"end":return t.stop()}}),t,this,[[13,18]])})))}},{key:"setEnabled",value:function(e){var t=this,r=function(e){return Te(we(n.prototype),e,t)};return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e!==this.enabled,!t.t0){t.next=11;break}if(t.t1=e&&ei(this.nativeTrack),!t.t1){t.next=6;break}return t.next=6,this.replaceTrackWith(this.settings);case 6:return t.next=8,r("setEnabled").call(this,e);case 8:e&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),this.eventBus.localAudioEnabled.publish({enabled:e,track:this}),this.stream.trackUpdate(this);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"isPublishedTrackId",value:function(e){return this.publishedTrackId===e}},{key:"setSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildNewSettings(e),n.next=3,this.handleDeviceChange(r,t);case 3:if(!ei(this.nativeTrack)){n.next=6;break}return this.settings=r,n.abrupt("return");case 6:return n.next=8,this.handleSettingsChange(r);case 8:this.settings=r;case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getPlugins",value:function(){return this.pluginsManager.getPlugins()}},{key:"addPlugin",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pluginsManager.addPlugin(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"removePlugin",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pluginsManager.removePlugin(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"validatePlugin",value:function(e){return this.pluginsManager.validatePlugin(e)}},{key:"setProcessedTrack",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=7;break}if(t.t0=this.processedTrack,!t.t0){t.next=5;break}return t.next=5,this.stream.replaceSenderTrack(this.processedTrack,this.nativeTrack);case 5:return this.processedTrack=void 0,t.abrupt("return");case 7:if(t.t1=e!==this.processedTrack,!t.t1){t.next=17;break}if(!this.processedTrack){t.next=14;break}return t.next=12,this.stream.replaceSenderTrack(this.processedTrack,e);case 12:t.next=16;break;case 14:return t.next=16,this.stream.replaceSenderTrack(this.nativeTrack,e);case 16:this.processedTrack=e;case 17:case"end":return t.stop()}}),t,this)})))}},{key:"initAudioLevelMonitor",value:function(){this.audioLevelMonitor&&this.destroyAudioLevelMonitor(),hn.d("HMSLocalAudioTrack","Monitor Audio Level for",this,this.getMediaTrackSettings().deviceId),this.audioLevelMonitor=new ai(this,this.eventBus.trackAudioLevelUpdate,this.eventBus.localAudioSilence),this.audioLevelMonitor.start(),this.audioLevelMonitor.detectSilence()}},{key:"destroyAudioLevelMonitor",value:function(){var e;null==(e=this.audioLevelMonitor)||e.stop(),this.audioLevelMonitor=void 0}},{key:"cleanup",value:function(){var e=this,t=function(t){return Te(we(n.prototype),t,e)};return an(this,null,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t("cleanup").call(this),e.next=3,this.pluginsManager.cleanup();case 3:return e.next=5,this.pluginsManager.closeContext();case 5:null==(n=this.processedTrack)||n.stop(),this.destroyAudioLevelMonitor();case 7:case"end":return e.stop()}}),e,this)})))}},{key:"getTrackIDBeingSent",value:function(){return this.processedTrack?this.processedTrack.id:this.nativeTrack.id}},{key:"getTrackBeingSent",value:function(){return this.processedTrack||this.nativeTrack}},{key:"buildNewSettings",value:function(e){var t=nn(nn({},this.settings),e),n=t.volume,r=t.codec,i=t.maxBitrate,a=t.deviceId,o=t.advanced;return new Ar(n,r,i,a,o)}}]),n}(cr);!function(e){e.TRANSFORM="TRANSFORM",e.ANALYZE="ANALYZE"}(yi||(yi={}));var bi=function(){function e(){m(this,e),this.total=0,this.count=0}return y(e,[{key:"add",value:function(e){this.count++,this.total+=e}},{key:"getAvg",value:function(){return Math.floor(this.total/this.count)}},{key:"reset",value:function(){this.total=0,this.count=0}}]),e}(),wi="VideoPluginsAnalytics",Si=function(){function e(t){m(this,e),this.eventBus=t,this.initTime={},this.preProcessingAvgs=new bi,this.addedTimestamps={},this.processingAvgs={},this.pluginAdded={},this.pluginInputFrameRate={},this.pluginFrameRate={}}return y(e,[{key:"added",value:function(e,t,n){this.pluginAdded[e]=!0,this.addedTimestamps[e]=Date.now(),this.initTime[e]=0,this.processingAvgs[e]=new bi,this.pluginInputFrameRate[e]=t,this.pluginFrameRate[e]=n||t}},{key:"removed",value:function(e){var t;if(this.pluginAdded[e]){var n={pluginName:e,duration:Math.floor((Date.now()-this.addedTimestamps[e])/1e3),loadTime:this.initTime[e],avgPreProcessingTime:this.preProcessingAvgs.getAvg(),avgProcessingTime:null==(t=this.processingAvgs[e])?void 0:t.getAvg(),inputFrameRate:this.pluginInputFrameRate[e],pluginFrameRate:this.pluginFrameRate[e]};this.eventBus.analytics.publish(li.stats(n)),this.clean(e)}}},{key:"failure",value:function(e,t){this.pluginAdded[e]&&(this.eventBus.analytics.publish(li.failure(e,t)),this.clean(e))}},{key:"initWithTime",value:function(e,t){return an(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.initTime[e]){n.next=3;break}return hn.i(wi,"Plugin Already loaded ".concat(e,", time it took: ").concat(this.initTime[e])),n.abrupt("return");case 3:return n.prev=3,n.next=6,this.timeInMs(t);case 6:r=n.sent,hn.i(wi,"Time taken for Plugin ".concat(e," initialization : ").concat(r)),n.next=14;break;case 10:throw n.prev=10,n.t0=n.catch(3),i=Pn.InitFailed(yn.VIDEO_PLUGINS,"failed during initialization of plugin".concat(n.t0.message||n.t0)),hn.e(wi,i),this.failure(e,i),i;case 14:r&&(this.initTime[e]=r);case 15:case"end":return n.stop()}}),n,this,[[3,10]])})))}},{key:"preProcessWithTime",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.timeInMs(e);case 2:n=t.sent,this.preProcessingAvgs.add(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"processWithTime",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.timeInMs(t);case 3:i=n.sent,n.next=10;break;case 6:throw n.prev=6,n.t0=n.catch(0),a=Pn.ProcessingFailed(yn.VIDEO_PLUGINS,"Failed during processing of plugin".concat(n.t0.message||n.t0)),hn.e(wi,a),this.failure(e,a),a;case 10:i&&(null==(r=this.processingAvgs[e])||r.add(i));case 11:case"end":return n.stop()}}),n,this,[[0,6]])})))}},{key:"timeInMs",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Date.now(),t.next=3,e();case 3:return t.abrupt("return",Math.floor(Date.now()-n));case 4:case"end":return t.stop()}}),t)})))}},{key:"clean",value:function(e){delete this.addedTimestamps[e],delete this.initTime[e],delete this.processingAvgs[e],delete this.pluginAdded[e],delete this.pluginInputFrameRate[e],delete this.pluginFrameRate[e]}}]),e}(),Ti="VideoPluginsManager",Ei=function(){function e(t,n){m(this,e),this.pluginsLoopRunning=!1,this.pluginsLoopState="paused",this.pluginAddInProgress=!1,this.hmsTrack=t,this.plugins=[],this.pluginsMap={},this.pluginNumFramesToSkip={},this.pluginNumFramesSkipped={},this.analytics=new Si(n),this.canvases=new Array}return y(e,[{key:"getPlugins",value:function(){return v(this.plugins)}},{key:"addPlugin",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.pluginAddInProgress){n.next=7;break}if((i=null==(r=e.getName)?void 0:r.call(e))&&""!==i){n.next=5;break}return hn.w("no name provided by the plugin"),n.abrupt("return");case 5:throw a=Pn.AddAlreadyInProgress(yn.VIDEO_PLUGINS,"Add Plugin is already in Progress"),this.analytics.failure(i,a),hn.w("can't add another plugin when previous add is in progress"),a;case 7:return this.pluginAddInProgress=!0,n.prev=8,n.next=11,this.addPluginInternal(e,t);case 11:return n.prev=11,this.pluginAddInProgress=!1,n.finish(11);case 14:case"end":return n.stop()}}),n,this,[[8,,11,14]])})))}},{key:"addPluginInternal",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a,o,s,c=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((i=null==(r=e.getName)?void 0:r.call(e))&&""!==i){n.next=4;break}return hn.w("no name provided by the plugin"),n.abrupt("return");case 4:if(!this.pluginsMap[i]){n.next=7;break}return hn.w(Ti,"plugin - ".concat(e.getName()," already added.")),n.abrupt("return");case 7:return a=this.hmsTrack.getMediaTrackSettings().frameRate||24,o=0,t&&t>0?(hn.i(Ti,"adding plugin ".concat(e.getName()," with framerate ").concat(t)),t<a&&(o=Math.ceil(a/t)-1),this.analytics.added(i,a,t)):(hn.i(Ti,"adding plugin ".concat(e.getName())),this.analytics.added(i,a)),hn.i(Ti,"numFrames to skip processing",o),this.pluginNumFramesToSkip[i]=o,this.pluginNumFramesSkipped[i]=o,this.validateAndThrow(i,e),n.prev=9,n.next=12,this.analytics.initWithTime(i,(function(){return an(c,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}));case 12:if(this.plugins.push(i),this.pluginsMap[i]=e,!(this.plugins.length+1>this.canvases.length)){n.next=16;break}for(s=this.canvases.length;s<=this.plugins.length;s++)this.canvases[s]=document.createElement("canvas");case 16:return n.next=18,this.startPluginsLoop();case 18:n.next=26;break;case 20:return n.prev=20,n.t0=n.catch(9),hn.e(Ti,"failed to add plugin",n.t0),n.next=25,this.removePlugin(e);case 25:throw n.t0;case 26:case"end":return n.stop()}}),n,this,[[9,20]])})))}},{key:"validatePlugin",value:function(e){return e.checkSupport()}},{key:"validateAndThrow",value:function(e,t){var n=this.validatePlugin(t);if(n.isSupported)hn.i(Ti,"plugin is supported,- ".concat(t.getName()));else switch(n.errType){case ri.PLATFORM_NOT_SUPPORTED:var r=Pn.PlatformNotSupported(yn.VIDEO_PLUGINS,"platform not supported, see docs");throw this.analytics.failure(e,r),r;case ri.DEVICE_NOT_SUPPORTED:var i=Pn.DeviceNotSupported(yn.VIDEO_PLUGINS,"video device not supported, see docs");throw this.analytics.failure(e,i),i}}},{key:"removePlugin",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getName(),this.pluginsMap[n]){t.next=4;break}return hn.w(Ti,"plugin - ".concat(n," not found to remove.")),t.abrupt("return");case 4:if(hn.i(Ti,"removing plugin ".concat(n)),this.removePluginEntry(n),t.t0=0===this.plugins.length,!t.t0){t.next=11;break}return hn.i(Ti,"No plugins left, stopping plugins loop"),t.next=11,this.stopPluginsLoop();case 11:e.stop(),this.analytics.removed(n);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"removePluginEntry",value:function(e){var t=this.plugins.indexOf(e);-1!==t&&this.plugins.splice(t,1),this.pluginsMap[e]&&delete this.pluginsMap[e],this.pluginNumFramesToSkip[e]&&delete this.pluginNumFramesToSkip[e],this.pluginNumFramesSkipped[e]&&delete this.pluginNumFramesSkipped[e]}},{key:"waitForRestart",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pluginsLoopRunning||"running"===this.pluginsLoopState){e.next=6;break}case 1:if("paused"!==this.pluginsLoopState){e.next=6;break}return e.next=4,ti(100);case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e,this)})))}},{key:"cleanup",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=k(this.plugins),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return i=r.value,e.next=7,this.removePlugin(this.pluginsMap[i]);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:null==(t=this.outputTrack)||t.stop();case 18:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))}},{key:"initElementsAndStream",value:function(){this.inputCanvas||(this.inputCanvas=document.createElement("canvas")),this.outputCanvas=document.createElement("canvas"),this.inputVideo||(this.inputVideo=document.createElement("video")),this.inputCanvas.getContext("2d"),this.outputCanvas.getContext("2d");var e=this.outputCanvas.captureStream();this.outputTrack=e.getVideoTracks()[0]}},{key:"startPluginsLoop",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pluginsLoopRunning){e.next=11;break}return this.initElementsAndStream(),this.pluginsLoopRunning=!0,e.prev=2,e.next=5,this.hmsTrack.setProcessedTrack(this.outputTrack);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),this.pluginsLoopRunning=!1,hn.e(Ti,"error in setting processed track",e.t0),e.t0;case 10:this.pluginsLoop().then((function(){hn.d(Ti,"processLoop stopped")}));case 11:case"end":return e.stop()}}),e,this,[[2,7]])})))}},{key:"stopPluginsLoop",value:function(){return an(this,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pluginsLoopRunning=!1,e.next=3,this.hmsTrack.setProcessedTrack(void 0);case 3:this.resetCanvases(),null==(t=this.outputTrack)||t.stop(),this.inputVideo&&(this.inputVideo.srcObject=null,this.inputVideo=void 0);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"pluginsLoop",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pluginsLoopRunning){e.next=27;break}if(t=this.hmsTrack.getMediaTrackSettings().frameRate||24,n=Math.floor(1e3/t),this.hmsTrack.enabled&&"ended"!==this.hmsTrack.nativeTrack.readyState){e.next=8;break}return"running"===this.pluginsLoopState&&this.resetCanvases(),this.pluginsLoopState="paused",e.next=7,ti(n);case 7:return e.abrupt("continue",25);case 8:return r=0,e.prev=9,e.next=12,this.analytics.preProcessWithTime((function(){return an(a,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doPreProcessing();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}));case 12:return i=Date.now(),e.next=15,this.processFramesThroughPlugins();case 15:(r=Math.floor(Date.now()-i))>n&&(r=n),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),hn.e(Ti,"error in plugins loop",e.t0);case 22:return this.pluginsLoopState="running",e.next=25,ti(n-r);case 25:e.next=0;break;case 27:case"end":return e.stop()}}),e,this,[[9,19]])})))}},{key:"doPreProcessing",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.addTrackToVideo();case 2:return e.next=4,this.updateInputCanvas();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"processFramesThroughPlugins",value:function(){return an(this,null,u().mark((function e(){var t,n,r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.canvases[0]=this.inputCanvas,t=u().mark((function e(t){var n,i,a,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.plugins[t],!(i=r.pluginsMap[n])){e.next=36;break}if(e.prev=2,a=r.checkIfSkipRequired(n),i.getPluginType()!==yi.TRANSFORM){e.next=25;break}if(o=function(e,t){return an(r,null,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i.processVideoFrame(e,t,a);case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),hn.e(Ti,"error in processing plugin ".concat(n),r.t0);case 8:case"end":return r.stop()}}),r,null,[[0,5]])})))},!a){e.next=16;break}if(t!==r.plugins.length-1){e.next=12;break}return e.next=10,o(r.canvases[t],r.outputCanvas);case 10:e.next=14;break;case 12:return e.next=14,o(r.canvases[t],r.canvases[t+1]);case 14:case 19:e.next=23;break;case 16:if(t!==r.plugins.length-1){e.next=21;break}return e.next=19,r.analytics.processWithTime(n,(function(){return an(r,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o(this.canvases[t],this.outputCanvas));case 1:case"end":return e.stop()}}),e,this)})))}));case 21:return e.next=23,r.analytics.processWithTime(n,(function(){return an(r,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o(this.canvases[t],this.canvases[t+1]));case 1:case"end":return e.stop()}}),e,this)})))}));case 23:e.next=29;break;case 25:if(e.t0=i.getPluginType()===yi.ANALYZE&&!a,!e.t0){e.next=29;break}return e.next=29,r.analytics.processWithTime(n,(function(){return an(r,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.processVideoFrame(this.inputCanvas);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}));case 29:e.next=36;break;case 31:return e.prev=31,e.t1=e.catch(2),hn.e(Ti,"error in processing plugin ".concat(n),e.t1),e.next=36,r.removePlugin(i);case 36:case"end":return e.stop()}}),e,null,[[2,31]])})),n=0;case 3:if(!(n<this.plugins.length)){e.next=8;break}return e.delegateYield(t(n),"t0",5);case 5:n++,e.next=3;break;case 8:case"end":return e.stop()}}),e,this)})))}},{key:"addTrackToVideo",value:function(){return an(this,null,u().mark((function e(){var t,n,r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inputVideo){e.next=2;break}return e.abrupt("return");case 2:null!==(n=this.inputVideo.srcObject)&&n instanceof MediaStream&&(null==(t=n.getVideoTracks()[0])?void 0:t.id)===this.hmsTrack.nativeTrack.id||(this.inputVideo.pause(),this.inputVideo.srcObject=new MediaStream([this.hmsTrack.nativeTrack]),this.inputVideo.muted=!0,this.inputVideo.playsInline=!0,this.inputVideo&&(this.inputVideo.oncanplaythrough=function(){var e;null==(e=r.inputVideo)||e.play()}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateInputCanvas",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.inputCanvas&&this.inputVideo){e.next=2;break}return e.abrupt("return");case 2:t=this.hmsTrack.getMediaTrackSettings(),n=t.width,r=void 0===n?320:n,i=t.height,a=void 0===i?240:i,this.inputCanvas.height!==a&&(this.inputCanvas.height=a),this.inputCanvas.width!==r&&(this.inputCanvas.width=r),this.inputCanvas.getContext("2d").drawImage(this.inputVideo,0,0,r,a);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"resetCanvases",value:function(){if(this.outputCanvas&&this.inputCanvas){var e=this.outputCanvas.getContext("2d");e&&(e.fillStyle="rgb(0, 0, 0)",e.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height));var t=this.inputCanvas.getContext("2d");t&&(t.fillStyle="rgb(0, 0, 0)",t.fillRect(0,0,this.outputCanvas.width,this.outputCanvas.height)),this.canvases=[]}}},{key:"checkIfSkipRequired",value:function(e){var t=!1;return this.pluginNumFramesSkipped[e]<this.pluginNumFramesToSkip[e]?(this.pluginNumFramesSkipped[e]++,t=!0):(t=!1,this.pluginNumFramesSkipped[e]=0),t}}]),e}(),xi="HMSLocalStream",Ci=function(e){Ce(n,e);var t=_e(n);function n(){var e;return m(this,n),(e=t.apply(this,arguments)).connection=null,e}return y(n,[{key:"setConnection",value:function(e){this.connection=e}},{key:"addTransceiver",value:function(e,t){var n=[];if(e instanceof Li)if(t.length>0)hn.v(xi,"Simulcast enabled with layers",t),n.push.apply(n,v(t));else{var r={active:this.nativeStream.active};e.settings.maxBitrate&&!yr&&(r.maxBitrate=e.settings.maxBitrate),n.push(r)}var i=this.connection.addTransceiver(e.nativeTrack,{streams:[this.nativeStream],direction:"sendonly",sendEncodings:n});return this.setPreferredCodec(i,e.nativeTrack.kind),i}},{key:"setMaxBitrate",value:function(e,t){return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,null==(r=this.connection)?void 0:r.setMaxBitrate(e,t);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"setPreferredCodec",value:function(e,t){}},{key:"replaceTrack",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.replaceSenderTrack(e,t);case 2:e.stop(),this.replaceStreamTrack(e,t);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"replaceStreamTrack",value:function(e,t){this.nativeStream.addTrack(t),this.nativeStream.removeTrack(e)}},{key:"replaceSenderTrack",value:function(e,t){return an(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==(i=null==(r=this.connection)?void 0:r.getSenders().find((function(t){return t.track&&t.track.id===e.id})))){n.next=4;break}return hn.w(xi,"No sender found for trackId=".concat(e.id)),n.abrupt("return");case 4:return n.next=6,i.replaceTrack(t);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"removeSender",value:function(e){var t=this,n=0;this.connection.getSenders().forEach((function(r){var i,a;if((null==(i=r.track)?void 0:i.id)===e.trackId||(null==(a=r.track)?void 0:a.id)===e.getTrackIDBeingSent()){t.connection.removeTrack(r),n+=1;var o=t.tracks.indexOf(e);-1!==o?t.tracks.splice(o,1):hn.e(xi,"Cannot find ".concat(e.trackId," in locally stored tracks"))}})),1!==n&&hn.e(xi,"Removed ".concat(n," sender's, expected to remove 1"))}},{key:"trackUpdate",value:function(e){var t;null==(t=this.connection)||t.trackUpdate(e)}}]),n}(ir),Pi=function(){function e(){m(this,e)}return y(e,null,[{key:"connect",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Date,a=arguments.length>4?arguments[4]:void 0,o=this.eventNameFor("connect",void 0===e),s=e?si.ERROR:si.INFO,u=this.getPropertiesWithError(rn(nn({},t),(p(n={},this.KEY_REQUESTED_AT,null==r?void 0:r.getTime()),p(n,this.KEY_RESPONDED_AT,null==i?void 0:i.getTime()),p(n,"endpoint",a),n)),e);return new ci({name:o,level:s,properties:u})}},{key:"disconnect",value:function(e,t){var n=e?si.ERROR:si.INFO,r=this.getPropertiesWithError(t,e);return new ci({name:"disconnected",level:n,properties:r})}},{key:"join",value:function(e,t,n){var r,i=this.eventNameFor("join",void 0===n),a=n?si.ERROR:si.INFO,o=this.getPropertiesWithError((p(r={},this.KEY_REQUESTED_AT,e.getTime()),p(r,this.KEY_RESPONDED_AT,t.getTime()),r),n);return new ci({name:i,level:a,properties:o})}},{key:"publish",value:function(e){var t=e.devices,n=e.settings,r=e.error,i=this.eventNameFor("publish",void 0===r),a=r?si.ERROR:si.INFO,o=this.getPropertiesWithError({devices:t,audio:null==n?void 0:n.audio,video:null==n?void 0:n.video},r);return new ci({name:i,level:a,properties:o})}},{key:"subscribeFail",value:function(e){var t=this.eventNameFor("subscribe",!1),n=si.ERROR,r=e.toAnalyticsProperties();return new ci({name:t,level:n,properties:r})}},{key:"leave",value:function(){return new ci({name:"leave",level:si.INFO})}},{key:"autoplayError",value:function(){return new ci({name:"autoplayError",level:si.ERROR})}},{key:"deviceChange",value:function(e){var t=e.selection,n=e.type,r=e.devices,i=e.error,a=this.eventNameFor(i?"publish":"device.".concat(n),void 0===i),o=i?si.ERROR:si.INFO,s=this.getPropertiesWithError({selection:t,devices:r},i);return new ci({name:a,level:o,properties:s})}},{key:"performance",value:function(e){var t=si.INFO,n=e.toAnalyticsProperties();return new ci({name:"perf.stats",level:t,properties:n})}},{key:"rtcStats",value:function(e){var t=si.INFO,n=e.toAnalyticsProperties();return new ci({name:"rtc.stats",level:t,properties:n})}},{key:"degradationStats",value:function(e,t){var n=si.INFO,r={degradedAt:e.degradedAt,trackId:e.trackId};if(!t&&e.degradedAt instanceof Date){var i=new Date,a=i.valueOf()-e.degradedAt.valueOf();r=rn(nn({},r),{duration:a,restoredAt:i})}return new ci({name:"video.degradation.stats",level:n,properties:r})}},{key:"audioDetectionFail",value:function(e,t){var n=this.getPropertiesWithError({device:t},e),r=si.ERROR;return new ci({name:"audiopresence.failed",level:r,properties:n})}},{key:"previewNetworkQuality",value:function(e){return new ci({name:"perf.networkquality.preview",level:e.error?si.ERROR:si.INFO,properties:e})}},{key:"eventNameFor",value:function(e,t){return"".concat(e,".").concat(t?"success":"failed")}},{key:"getPropertiesWithError",value:function(e,t){return t&&(e=nn(nn({},t.toAnalyticsProperties()),e)),e}}]),e}();Pi.KEY_REQUESTED_AT="requested_at",Pi.KEY_RESPONDED_AT="responded_at";var Ri,_i={audioContext:null,getAudioContext:function(){return this.audioContext||(this.audioContext=new AudioContext),this.audioContext},resumeContext:function(){this.getAudioContext().resume().catch((function(e){hn.e("AudioContext",e)}))}},Ii="default",Ai="default",Di=function(){function e(t,n,r,i){m(this,e),this.store=t,this.observer=n,this.deviceManager=r,this.eventBus=i,this.TAG="[LocalTrackManager]"}return y(e,[{key:"getTracksToPublish",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o,s,c,l,d,h;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.getTrackSettings(e)){t.next=3;break}return t.abrupt("return",[]);case 3:return r=!!n.audio,i=!!n.video,a=[],t.next=8,this.updateCurrentLocalTrackSettings(n);case 8:if(o=t.sent,s=o.videoTrack,c=o.audioTrack,l=Boolean(s&&this.store.getTrackById(s.trackId)),d=Boolean(c&&this.store.getTrackById(c.trackId)),!l||!d){t.next=15;break}return t.abrupt("return",[]);case 15:return h={audio:r&&!c&&(!e.isAudioMuted||"empty"),video:i&&!s&&(!e.isVideoMuted||"empty")},t.prev=16,hn.d(this.TAG,"Init Local Tracks",{fetchTrackOptions:h}),t.next=20,this.getLocalTracks(h,n);case 20:a=t.sent,t.next=28;break;case 23:return t.prev=23,t.t0=t.catch(16),t.next=27,this.retryGetLocalTracks(t.t0,n,h);case 27:a=t.sent;case 28:return t.abrupt("return",(s&&i&&!l&&a.push(s),c&&r&&!d&&a.push(c),a));case 29:case"end":return t.stop()}}),t,this,[[16,23]])})))}},{key:"getLocalTracks",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{audio:!0,video:!0},n=i.length>1?i[1]:void 0,e.prev=2,e.next=5,this.getNativeLocalTracks(t,n);case 5:return r=e.sent,e.abrupt("return",this.createHMSLocalTracks(r,n));case 9:throw e.prev=9,e.t0=e.catch(2),e.t0 instanceof bn&&this.eventBus.analytics.publish(Pi.publish({devices:this.deviceManager.getDevices(),error:e.t0,settings:n})),e.t0;case 12:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"getNativeLocalTracks",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{audio:!1,video:!1},n=a.length>1?a[1]:void 0,r=new Lr(!0===t.video?n.video:null,!0===t.audio?n.audio:null,n.simulcast),i=[],e.t0=r.audio||r.video,!e.t0){e.next=13;break}return e.t1=i.push,e.t2=i,e.t3=v,e.next=10,this.getAVTracks(r);case 10:e.t4=e.sent,e.t5=(0,e.t3)(e.t4),e.t1.apply.call(e.t1,e.t2,e.t5);case 13:return i.push.apply(i,v(this.getEmptyTracks(t))),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"getLocalScreen",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a,o,s,c,l,d,h;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={video:e.toConstraints()},t&&(delete(i=t.toConstraints()).advanced,r.audio=rn(nn({},i),{autoGainControl:!1,noiseSuppression:!1,googAutoGainControl:!1,echoCancellation:!1})),n.prev=2,n.next=5,navigator.mediaDevices.getDisplayMedia(r);case 5:a=n.sent,n.next=11;break;case 8:throw n.prev=8,n.t0=n.catch(2),Yr(n.t0,Br.SCREEN);case 11:return o=[],s=new Ci(a),c=a.getVideoTracks()[0],l=new Li(s,c,"screen",this.eventBus,e),o.push(l),(d=a.getAudioTracks()[0])&&(h=new ki(s,d,"screen",this.eventBus,t),o.push(h)),n.abrupt("return",(hn.v(this.TAG,"getLocalScreen",o),o));case 16:case"end":return n.stop()}}),n,this,[[2,8]])})))}},{key:"requestPermissions",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 3:e.sent.getTracks().forEach((function(e){return e.stop()})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),hn.e(this.TAG,e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})))}},{key:"getAVTracks",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({audio:!!e.audio&&e.audio.toConstraints(),video:!!e.video&&e.video.toConstraints()});case 3:return n=t.sent,t.abrupt("return",n.getVideoTracks().concat(n.getAudioTracks()));case 7:return t.prev=7,t.t0=t.catch(0),t.next=11,this.deviceManager.init();case 11:throw r=!(this.deviceManager.hasWebcamPermission||!e.video),i=!(this.deviceManager.hasMicrophonePermission||!e.audio),a=this.getErrorType(r,i),Yr(t.t0,a);case 13:case"end":return t.stop()}}),t,this,[[0,7]])})))}},{key:"getTrackSettings",value:function(e){var t=this.getAudioSettings(e),n=this.getVideoSettings(e);if(!t&&!n)return null;var r=this.getScreenSettings();return(new Or).video(n).audio(t).screen(r).build()}},{key:"retryGetLocalTracks",value:function(e,t,n){return an(this,null,u().mark((function r(){var i,a,o,s,c,l,d;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(e instanceof bn&&e.action===yn.TRACK)){r.next=37;break}if(this.observer.onFailure(e),i=e.code===kn.TracksErrors.OVER_CONSTRAINED,a=e.message.includes("audio"),o=e.message.includes("video"),!i){r.next=19;break}return s=(new Or).video(new Nr).audio(new Ar).build(),hn.w(this.TAG,"Fetch AV Tracks failed with overconstrained error",{fetchTrackOptions:n},{error:e}),r.prev=6,r.next=9,this.getLocalTracks(n,s);case 9:case 18:case 23:case 34:return r.abrupt("return",r.sent);case 12:return r.prev=12,r.t0=r.catch(6),c=r.t0 instanceof bn?r.t0.nativeError:r.t0,l=r.t0,"OverconstrainedError"===(null==c?void 0:c.name)&&((d=Tn.GenericTrack(yn.TRACK,"Overconstrained error after dropping all constraints")).addNativeError(c),l=d),r.next=18,this.retryGetLocalTracks(l,t,n);case 19:return n.audio=a?"empty":n.audio,n.video=o?"empty":n.video,hn.w(this.TAG,"Fetch AV Tracks failed",{fetchTrackOptions:n},e),r.prev=20,r.next=23,this.getLocalTracks(n,t);case 26:return r.prev=26,r.t1=r.catch(20),hn.w(this.TAG,"Fetch empty tacks failed",r.t1),n.audio=n.audio&&"empty",n.video=n.video&&"empty",this.observer.onFailure(Tn.GenericTrack(yn.TRACK,r.t1.message)),r.next=34,this.getLocalTracks(n,t);case 35:r.next=38;break;case 37:return r.abrupt("return",(hn.w(this.TAG,"Fetch AV Tracks failed - unknown exception",e),this.observer.onFailure(Tn.GenericTrack(yn.TRACK,e.message)),[]));case 38:case"end":return r.stop()}}),r,this,[[6,12],[20,26]])})))}},{key:"getErrorType",value:function(e,t){return e&&t?Br.AV:e?Br.VIDEO:Br.AUDIO}},{key:"getEmptyTracks",value:function(t){var n=[];return"empty"===t.audio&&n.push(e.getEmptyAudioTrack()),"empty"===t.video&&n.push(e.getEmptyVideoTrack()),n}},{key:"updateCurrentLocalTrackSettings",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.getLocalPeerTracks(),r=n.find((function(e){return e.type===Ln.VIDEO&&"regular"===e.source})),i=n.find((function(e){return e.type===Ln.AUDIO&&"regular"===e.source})),a=n.find((function(e){return e.type===Ln.VIDEO&&"screen"===e.source})),t.t0=null==e?void 0:e.video,!t.t0){t.next=5;break}return t.next=5,null==r?void 0:r.setSettings(e.video);case 5:if(t.t1=null==e?void 0:e.audio,!t.t1){t.next=9;break}return t.next=9,null==i?void 0:i.setSettings(e.audio);case 9:if(t.t2=null==e?void 0:e.screen,!t.t2){t.next=13;break}return t.next=13,null==a?void 0:a.setSettings(e.screen);case 13:return t.abrupt("return",{videoTrack:r,audioTrack:i});case 14:case"end":return t.stop()}}),t,this)})))}},{key:"getAudioSettings",value:function(e){var t,n=this.store.getPublishParams();if(!n||!(null==(t=n.allowed)?void 0:t.includes("audio")))return null;var r=this.store.getLocalPeer(),i=null==r?void 0:r.audioTrack,a=(null==i?void 0:i.settings.deviceId)||e.audioInputDeviceId;return(new Ir).codec(n.audio.codec).maxBitrate(n.audio.bitRate).deviceId(a||Ii).build()}},{key:"getVideoSettings",value:function(e){var t,n=this.store.getPublishParams();if(!n||!(null==(t=n.allowed)?void 0:t.includes("video")))return null;var r=this.store.getLocalPeer(),i=null==r?void 0:r.videoTrack,a=(null==i?void 0:i.settings.deviceId)||e.videoDeviceId,o=n.video,s=this.store.getSimulcastDimensions("regular")||{},u=s.width,c=void 0===u?o.width:u,l=s.height,d=void 0===l?o.height:l;return(new Dr).codec(o.codec).maxBitrate(o.bitRate).maxFramerate(o.frameRate).setWidth(c).setHeight(d).deviceId(a||Ai).build()}},{key:"getScreenSettings",value:function(){var e,t=this.store.getPublishParams();if(!t||!(null==(e=t.allowed)?void 0:e.includes("screen")))return null;var n=t.screen,r=this.store.getSimulcastDimensions("screen")||{},i=r.width,a=void 0===i?n.width:i,o=r.height,s=void 0===o?n.height:o;return(new Dr).maxBitrate(n.bitRate,!1).codec(n.codec).maxFramerate(n.frameRate).setWidth(a).setHeight(s).build()}},{key:"createHMSLocalTracks",value:function(e,t){var n=e.find((function(e){return"video"===e.kind})),r=e.find((function(e){return"audio"===e.kind})),i=new Ci(new MediaStream(e)),a=[];if(r&&(null==t?void 0:t.audio)){var o=new ki(i,r,"regular",this.eventBus,t.audio);a.push(o)}if(n&&(null==t?void 0:t.video)){var s=new Li(i,n,"regular",this.eventBus,t.video);a.push(s)}return a}}],[{key:"getEmptyVideoTrack",value:function(e){var t,n,r,i=(null==(t=null==e?void 0:e.getSettings())?void 0:t.width)||320,a=(null==(n=null==e?void 0:e.getSettings())?void 0:n.height)||240;Ri||(null==(r=(Ri=Object.assign(document.createElement("canvas"),{width:i,height:a})).getContext("2d"))||r.fillRect(0,0,i,a));var o=Ri.captureStream(10).getVideoTracks()[0],s=setInterval((function(){if("ended"!==o.readyState){var e=Ri.getContext("2d");if(e){var t=0===e.getImageData(0,0,1,1).data[0]?1:0;e.fillStyle="rgb(".concat(t,", 0, 0)"),e.fillRect(0,0,1,1)}}else clearInterval(s)}),100);return o.onended=function(){clearInterval(s)},o.enabled=!1,o}},{key:"getEmptyAudioTrack",value:function(){var e=_i.getAudioContext(),t=e.createOscillator(),n=e.createMediaStreamDestination();t.connect(n),t.start();var r=n.stream.getAudioTracks()[0];return r.enabled=!1,r}}]),e}();function Ni(e,t){return function(n){return n in e&&e[n]!==t[n]}}var Oi,Li=function(e){Ce(n,e);var t=_e(n);function n(e,r,i,a){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(new Dr).build();return m(this,n),(o=t.call(this,e,r,i)).eventBus=a,o.buildNewSettings=function(e){var t=nn(nn({},o.settings),e),n=t.width,r=t.height,i=t.codec,a=t.maxFramerate,s=t.maxBitrate,u=t.deviceId,c=t.advanced;return new Nr(n,r,i,a,u,c,s)},o.handleSettingsChange=function(e){return an(Ee(o),null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.stream,r=Ni(e,this.settings),t.t0=r("maxBitrate")&&e.maxBitrate,!t.t0){t.next=5;break}return t.next=5,n.setMaxBitrate(e.maxBitrate,this);case 5:if(t.t1=r("width")||r("height")||r("advanced"),!t.t1){t.next=9;break}return t.next=9,this.nativeTrack.applyConstraints(e.toConstraints());case 9:case"end":return t.stop()}}),t,this)})))},o.handleDeviceChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return an(Ee(o),null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!Ni(e,this.settings)("deviceId")||"regular"!==this.source){n.next=9;break}if(!this.enabled){n.next=8;break}return n.next=4,this.replaceTrackWith(e);case 4:return r=n.sent,n.next=7,this.replaceSender(r,this.enabled);case 7:this.nativeTrack=r;case 8:t||mi.updateSelection("videoInput",{deviceId:e.deviceId,groupId:this.nativeTrack.getSettings().groupId});case 9:case"end":return n.stop()}}),n,this)})))},e.tracks.push(Ee(o)),o.settings=s,"default"===s.deviceId&&r.enabled&&(o.settings=o.buildNewSettings({deviceId:r.getSettings().deviceId})),o.pluginsManager=new Ei(Ee(o),a),o.setFirstTrackId(o.trackId),o}return y(n,[{key:"setEnabled",value:function(e){var t=this,r=function(e){return Te(we(n.prototype),e,t)};return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e===this.enabled){t.next=23;break}if("regular"!==this.source){t.next=19;break}if(!e){t.next=8;break}return t.next=5,this.replaceTrackWith(this.settings);case 5:n=t.sent,t.next=11;break;case 8:return t.next=10,this.replaceTrackWithBlank();case 10:n=t.sent;case 11:return t.next=13,this.replaceSender(n,e);case 13:if(this.nativeTrack=n,t.t0=e,!t.t0){t.next=19;break}return t.next=18,this.pluginsManager.waitForRestart();case 18:this.settings=this.buildNewSettings({deviceId:n.getSettings().deviceId});case 19:return t.next=21,r("setEnabled").call(this,e);case 21:this.eventBus.localVideoEnabled.publish({enabled:e,track:this}),this.stream.trackUpdate(this);case 23:case"end":return t.stop()}}),t,this)})))}},{key:"isPublishedTrackId",value:function(e){return this.publishedTrackId===e}},{key:"addSink",value:function(e){this.addSinkInternal(e,this.processedTrack||this.nativeTrack)}},{key:"setSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.buildNewSettings(e),n.next=3,this.handleDeviceChange(r,t);case 3:if(this.enabled){n.next=6;break}return this.settings=r,n.abrupt("return");case 6:return n.next=8,this.handleSettingsChange(r);case 8:this.settings=r;case 9:case"end":return n.stop()}}),n,this)})))}},{key:"getPlugins",value:function(){return this.pluginsManager.getPlugins()}},{key:"addPlugin",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.pluginsManager.addPlugin(e,t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"removePlugin",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.pluginsManager.removePlugin(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"validatePlugin",value:function(e){return this.pluginsManager.validatePlugin(e)}},{key:"cleanup",value:function(){var e=this,t=function(t){return Te(we(n.prototype),t,e)};return an(this,null,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t("cleanup").call(this),e.next=3,this.pluginsManager.cleanup();case 3:null==(n=this.processedTrack)||n.stop();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"setProcessedTrack",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.nativeTrack.enabled){t.next=3;break}return this.processedTrack=e,t.abrupt("return");case 3:if(e){t.next=10;break}if(t.t0=this.processedTrack,!t.t0){t.next=8;break}return t.next=8,this.stream.replaceSenderTrack(this.processedTrack,this.nativeTrack);case 8:return this.processedTrack=void 0,t.abrupt("return");case 10:if(t.t1=e!==this.processedTrack,!t.t1){t.next=20;break}if(!this.processedTrack){t.next=17;break}return t.next=15,this.stream.replaceSenderTrack(this.processedTrack,e);case 15:t.next=19;break;case 17:return t.next=19,this.stream.replaceSenderTrack(this.nativeTrack,e);case 19:this.processedTrack=e;case 20:case"end":return t.stop()}}),t,this)})))}},{key:"getTrackIDBeingSent",value:function(){return this.getTrackBeingSent().id}},{key:"getTrackBeingSent",value:function(){return this.enabled&&this.processedTrack||this.nativeTrack}},{key:"replaceTrackWith",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=this.nativeTrack)||n.stop(),t.next=4,Zr(e);case 4:return r=t.sent,t.abrupt("return",("default"===this.settings.deviceId&&(this.settings=this.buildNewSettings({deviceId:this.nativeTrack.getSettings().deviceId})),r));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"replaceTrackWithBlank",value:function(){return an(this,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.nativeTrack,e.abrupt("return",(null==t||t.stop(),Di.getEmptyVideoTrack(t)));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"replaceSender",value:function(e,t){return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.stream,!t){n.next=6;break}return n.next=4,r.replaceSenderTrack(this.nativeTrack,this.processedTrack||e);case 4:n.next=8;break;case 6:return n.next=8,r.replaceSenderTrack(this.processedTrack||this.nativeTrack,e);case 8:return n.next=10,r.replaceStreamTrack(this.nativeTrack,e);case 10:case"end":return n.stop()}}),n,this)})))}}]),n}(dr),Mi=function(){function e(t,n,r){var i=this;m(this,e),this.store=t,this.eventBus=n,this.listener=r,this.tracksToProcess=new Map,this.handleTrackAdd=function(e){hn.d(i.TAG,"ONTRACKADD",e,e.nativeTrack),i.store.addTrack(e),i.tracksToProcess.set(e.trackId,e),i.processPendingTracks()},this.handleTrackRemove=function(e){var t;hn.d(i.TAG,"ONTRACKREMOVE",e,e.nativeTrack);var n=i.store.getTrackState(e.trackId);if(n){e.type===Ln.AUDIO&&i.eventBus.audioTrackRemoved.publish(e);var r=i.store.getPeerById(n.peerId);!r||(i.removePeerTracks(r,e),i.store.removeTrack(e.trackId),null==(t=i.listener)||t.onTrackUpdate(un.TRACK_REMOVED,e,r))}},this.handleTrackLayerUpdate=function(e){var t,n;for(var r in e.tracks){var a=e.tracks[r],o=i.store.getTrackById(r);if(o){var s=i.store.getPeerByTrackId(r);if(s&&o instanceof hr){var u=i.isTrackDegraded(a.expected_layer,a.current_layer);o.setLayerFromServer(a.current_layer,u),u?null==(t=i.listener)||t.onTrackUpdate(un.TRACK_DEGRADED,o,s):null==(n=i.listener)||n.onTrackUpdate(un.TRACK_RESTORED,o,s)}}}},this.handleTrackUpdate=function(e){var t,n;hn.d(i.TAG,"TRACK_UPDATE",e);var r=i.store.getPeerById(e.peer.peer_id);if(r)for(var a in e.tracks){var o=Object.assign({},null==(t=i.store.getTrackState(a))?void 0:t.trackInfo),s=e.tracks[a],u=i.store.getTrackById(a);if(i.store.setTrackState({peerId:e.peer.peer_id,trackInfo:nn(nn({},o),s)}),!u||i.tracksToProcess.has(a))i.processPendingTracks();else{u.setEnabled(!s.mute);var c=i.processTrackUpdate(u,o,s);c&&(null==(n=i.listener)||n.onTrackUpdate(c,u,r))}}}}return y(e,[{key:"TAG",get:function(){return"[".concat(this.constructor.name,"]")}},{key:"isTrackDegraded",value:function(e,t){var n=function(e){switch(e){case ln.HIGH:return 3;case ln.MEDIUM:return 2;case ln.LOW:return 1;case ln.NONE:return 0}};return n(t)<n(e)}},{key:"handleTrackMetadataAdd",value:function(e){for(var t in hn.d(this.TAG,"TRACK_METADATA_ADD",e),e.tracks)this.store.setTrackState({peerId:e.peer.peer_id,trackInfo:e.tracks[t]});this.processPendingTracks()}},{key:"processPendingTracks",value:function(){var e=this;new Map(this.tracksToProcess).forEach((function(t){var n,r=e.store.getTrackState(t.trackId);if(r){var i=e.store.getPeerById(r.peerId);!i||(t.source=r.trackInfo.source,t.peerId=i.peerId,t.logIdentifier=i.name,t.setEnabled(!r.trackInfo.mute),e.addAudioTrack(i,t),e.addVideoTrack(i,t),t.type===Ln.AUDIO?e.eventBus.audioTrackAdded.publish({track:t,peer:i}):null==(n=e.listener)||n.onTrackUpdate(un.TRACK_ADDED,t,i),e.tracksToProcess.delete(t.trackId))}}))}},{key:"removePeerTracks",value:function(e,t){var n,r,i=e.auxiliaryTracks.indexOf(t);i>-1?e.auxiliaryTracks.splice(i,1):t.type===Ln.AUDIO&&(null==(n=e.audioTrack)?void 0:n.trackId)===t.trackId?e.audioTrack=void 0:t.type===Ln.VIDEO&&(null==(r=e.videoTrack)?void 0:r.trackId)===t.trackId&&(e.videoTrack=void 0)}},{key:"addAudioTrack",value:function(e,t){t.type===Ln.AUDIO&&(e.audioTrack||"regular"!==t.source?e.auxiliaryTracks.push(t):e.audioTrack=t)}},{key:"addVideoTrack",value:function(e,t){if(t.type===Ln.VIDEO){var n=t,r=this.store.getSimulcastDefinitionsForPeer(e,n.source);n.setSimulcastDefinitons(r),e.videoTrack||"regular"!==t.source?e.auxiliaryTracks.push(n):e.videoTrack=n}}},{key:"processTrackUpdate",value:function(e,t,n){var r;return e.setEnabled(!n.mute),t.mute!==n.mute?(r=n.mute?un.TRACK_MUTED:un.TRACK_UNMUTED,e.type===Ln.AUDIO&&this.eventBus.audioTrackUpdate.publish({track:e,enabled:!n.mute})):t.description!==n.description&&(r=un.TRACK_DESCRIPTION_CHANGED),r}}]),e}(),Ui=function(){function e(t){m(this,e),this.listener=t}return y(e,[{key:"handleQualityUpdate",value:function(e){var t,n=e.peers.map((function(e){return{peerID:e.peer_id,downlinkQuality:e.downlink_score}}));null==(t=this.listener)||t.onConnectionQualityUpdate(n)}}]),e}(),Fi=function(){function e(t,n,r,i,a){var o=this;m(this,e),this.store=t,this.listener=r,this.audioListener=i,this.connectionQualityListener=a,this.TAG="[HMSNotificationManager]",this.hasConsistentRoomStateArrived=!1,this.ignoreNotification=function(e){if(e===Pr.PEER_LIST)o.hasConsistentRoomStateArrived=!0;else if(e===Pr.ROOM_STATE)return o.hasConsistentRoomStateArrived;return!1},this.handleTrackAdd=function(e){o.trackManager.handleTrackAdd(e)},this.handleTrackRemove=function(e){o.trackManager.handleTrackRemove(e)},this.updateLocalPeer=function(e){var t=e.name,n=e.metadata,r=o.store.getLocalPeer();o.peerManager.handlePeerInfoUpdate({peer:r,name:t,data:n})},this.trackManager=new Mi(this.store,n,this.listener),this.peerManager=new Wr(this.store,this.trackManager,this.listener),this.peerListManager=new Hr(this.store,this.peerManager,this.trackManager,this.listener),this.broadcastManager=new zr(this.store,this.listener),this.policyChangeManager=new qr(this.store,n),this.requestManager=new Qr(this.store,this.listener),this.activeSpeakerManager=new Mr(this.store,this.listener,this.audioListener),this.connectionQualityManager=new Ui(this.connectionQualityListener),this.roomUpdateManager=new Jr(this.store,this.listener)}return y(e,[{key:"setListener",value:function(e){this.listener=e,this.trackManager.listener=e,this.peerManager.listener=e,this.peerListManager.listener=e,this.broadcastManager.listener=e,this.requestManager.listener=e,this.activeSpeakerManager.listener=e,this.roomUpdateManager.listener=e}},{key:"setAudioListener",value:function(e){this.audioListener=e,this.activeSpeakerManager.audioListener=e}},{key:"setConnectionQualityListener",value:function(e){this.connectionQualityListener=e,this.connectionQualityManager.listener=e}},{key:"handleNotification",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.method,a=e.params;[Pr.ACTIVE_SPEAKERS,Pr.SFU_STATS,Pr.CONNECTION_QUALITY].includes(i)||hn.d(this.TAG,"Received notification",{method:i,notification:a}),i===Pr.SFU_STATS&&(null==(t=window.HMS)?void 0:t.ON_SFU_STATS)&&"function"==typeof(null==(n=window.HMS)?void 0:n.ON_SFU_STATS)&&window.HMS.ON_SFU_STATS(e.params),!this.ignoreNotification(i)&&(this.roomUpdateManager.handleNotification(i,a),this.peerManager.handleNotification(i,a),this.requestManager.handleNotification(i,a),this.peerListManager.handleNotification(i,a,r),this.broadcastManager.handleNotification(i,a),this.handleIsolatedMethods(i,a))}},{key:"handleIsolatedMethods",value:function(e,t){switch(e){case Pr.TRACK_METADATA_ADD:this.trackManager.handleTrackMetadataAdd(t);break;case Pr.TRACK_UPDATE:this.trackManager.handleTrackUpdate(t);break;case Pr.ON_SFU_TRACK_LAYER_UPDATE:this.trackManager.handleTrackLayerUpdate(t);break;case Pr.ACTIVE_SPEAKERS:this.activeSpeakerManager.handleActiveSpeakers(t);break;case Pr.CONNECTION_QUALITY:this.connectionQualityManager.handleQualityUpdate(t);break;case Pr.POLICY_CHANGE:this.policyChangeManager.handlePolicyChange(t)}}}]),e}(),ji=y((function e(t){m(this,e),this.type=t.type,this.source=t.source||"regular",this.description="",t instanceof sr?(this.mute=!t.enabled,this.track_id=t.publishedTrackId,this.stream_id=t.stream.id):(this.mute=t.mute,this.track_id=t.track_id,this.stream_id=t.stream_id)}));!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Joined="Joined",e.Preview="Preview",e.Failed="Failed",e.Reconnecting="Reconnecting",e.Leaving="Leaving"}(Oi||(Oi={}));var Bi,Vi,Gi=y((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"https://prod-init.100ms.live/init",o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];m(this,e),this.authToken=t,this.peerId=n,this.peerName=r,this.data=i,this.endpoint=a,this.autoSubscribeVideo=o}));!function(e){e.FLAG_SERVER_SUB_DEGRADATION="subscribeDegradation",e.FLAG_SERVER_SIMULCAST="simulcast"}(Bi||(Bi={})),function(e){e[e.ConnectFailed=0]="ConnectFailed",e[e.SignalDisconnect=1]="SignalDisconnect",e[e.PublishIceConnectionFailed=2]="PublishIceConnectionFailed",e[e.SubscribeIceConnectionFailed=3]="SubscribeIceConnectionFailed"}(Vi||(Vi={}));var zi,Hi=(p(Kt={},0,[]),p(Kt,1,[]),p(Kt,2,[1]),p(Kt,3,[1]),Kt),Ki=y((function e(t){var n=this;m(this,e),this.promise=new Promise((function(e,r){n.resolve=e,n.reject=r,t(e,r)}))})),Wi="[RetryScheduler]",qi=function(){function e(t,n){m(this,e),this.onStateChange=t,this.sendEvent=n,this.inProgress=new Map,this.retryTaskIds=[]}return y(e,[{key:"schedule",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.category,r=t.error,i=t.task,a=t.originalState,o=t.maxFailedRetries,s=void 0===o?5:o,c=t.changeState,l=void 0===c||c,e.next=3,this.scheduleTask({category:n,error:r,changeState:l,task:i,originalState:a,maxFailedRetries:s});case 3:case"end":return e.stop()}}),e,this)})))}},{key:"reset",value:function(){this.retryTaskIds.forEach((function(e){return clearTimeout(e)})),this.retryTaskIds=[],this.inProgress.clear()}},{key:"scheduleTask",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c,l,d,h,f,p,v,m,g,y,k,b,w;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.category,r=t.error,i=t.changeState,a=t.task,o=t.originalState,s=t.maxFailedRetries,c=void 0===s?5:s,l=t.failedRetryCount,d=void 0===l?0:l,hn.d(Wi,"schedule: ",{category:Vi[n],error:r}),0!==d){e.next=10;break}if(!(h=this.inProgress.get(n))){e.next=8;break}return hn.d(Wi,"schedule: Already a task for ".concat(Vi[n]," scheduled, waiting for its completion")),e.next=7,h.promise;case 7:return e.abrupt("return");case 8:f=new Ki((function(e,t){})),this.inProgress.set(n,f),this.sendEvent(r,n);case 10:p=!1,v=Hi[n],e.t0=u().keys(v);case 12:if((e.t1=e.t0()).done){e.next=31;break}if(m=e.t1.value,g=v[parseInt(m)],e.prev=15,y=this.inProgress.get(g),e.t2=y,!e.t2){e.next=23;break}return hn.d(Wi,"schedule: Suspending retry task of ".concat(Vi[n],", waiting for ").concat(Vi[g]," to recover")),e.next=22,y.promise;case 22:hn.d(Wi,"schedule: Resuming retry task ".concat(Vi[n]," as it's dependency ").concat(Vi[g]," is recovered"));case 23:e.next=29;break;case 25:return e.prev=25,e.t3=e.catch(15),hn.d(Wi,"schedule: Stopping retry task of ".concat(Vi[n]," as it's dependency ").concat(Vi[g]," failed to recover")),p=!0,e.abrupt("break",31);case 29:e.next=12;break;case 31:if(!(d>=c||p)){e.next=38;break}if(r.description+=". [".concat(Vi[n],"] Could not recover after ").concat(d," tries"),p&&(r.description+=" Could not recover all of it's required dependencies - [".concat(v.map((function(e){return Vi[e]})).toString(),"]")),r.isTerminal=!0,this.inProgress.delete(n),this.sendEvent(r,n),this.reset(),!i){e.next=36;break}this.onStateChange(Oi.Failed,r),e.next=37;break;case 36:throw r;case 37:return e.abrupt("return");case 38:return i&&this.onStateChange(Oi.Reconnecting,r),k=this.getDelayForRetryCount(d),hn.i(Wi,"schedule: [".concat(Vi[n],"] [failedRetryCount=").concat(d,"] Scheduling retry task in ").concat(k,"ms")),e.prev=41,e.next=44,this.setTimeoutPromise(a,k);case 44:b=e.sent,e.next=50;break;case 47:e.prev=47,e.t4=e.catch(41),b=!1,hn.w(Wi,"[".concat(Vi[n],"] Un-caught exception ").concat(e.t4.name," in retry-task, initiating retry"),e.t4);case 50:if(!b){e.next=55;break}w=this.inProgress.get(n),this.inProgress.delete(n),null==w||w.resolve(d),i&&0===this.inProgress.size&&this.onStateChange(o),hn.i(Wi,"schedule: [".concat(Vi[n],"] [failedRetryCount=").concat(d,"] Recovered \u267b\ufe0f")),e.next=57;break;case 55:return e.next=57,this.scheduleTask({category:n,error:r,changeState:i,task:a,originalState:o,maxFailedRetries:c,failedRetryCount:d+1});case 57:case"end":return e.stop()}}),e,this,[[15,25],[41,47]])})))}},{key:"getDelayForRetryCount",value:function(e){var t=Math.pow(2,e),n=Math.random();return Math.round(1e3*Math.min(t+n,60))}},{key:"setTimeoutPromise",value:function(e,t){return an(this,null,u().mark((function n(){var r=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n,i){var a=window.setTimeout((function(){return an(r,null,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:(r=t.sent)&&this.retryTaskIds.splice(this.retryTaskIds.indexOf(a),1),n(r),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),i(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})))}),t);r.retryTaskIds.push(a)})));case 1:case"end":return n.stop()}}),n)})))}}]),e}();!function(e){e.PROD="prod",e.QA="qa",e.DEV="dev"}(zi||(zi={}));var Qi=function(){function e(){m(this,e),this.TAG="[HTTPAnalyticsTransport]",this.failedEvents=new vr("client-events"),this.isConnected=!0,this.env=null}return y(e,[{key:"setEnv",value:function(e){this.env=e,this.flushFailedEvents()}},{key:"sendEvent",value:function(e){var t,n=this;if(this.env&&(null==(t=window.HMS)?void 0:t.CLIENT_EVENTS)){var r={event:e.name,payload:e.properties,event_id:String(e.timestamp),peer_id:e.metadata.peerId,session_id:e.metadata.sessionId,room_id:e.metadata.roomId,timestamp:Date.now(),agent:wr,device_id:e.device_id},i=this.env===zi.PROD?"https://event.100ms.live/v2/client/report":"https://event-nonprod.100ms.live/v2/client/report";fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e.metadata.token)},body:JSON.stringify(r)}).then((function(t){if(401!==t.status){if(200!==t.status)throw Error(t.statusText);n.removeFromStorage(e)}else n.removeFromStorage(e)})).catch((function(t){hn.v(n.TAG,"Failed to send event",t,e),n.addEventToStorage(e)}))}else this.addEventToStorage(e)}},{key:"flushFailedEvents",value:function(){var e=this,t=this.failedEvents.get();null==t||t.forEach((function(t){return e.sendEvent(t)}))}},{key:"addEventToStorage",value:function(e){var t=this.failedEvents.get()||[];t.find((function(t){return t.timestamp===e.timestamp}))||(100===t.length&&t.shift(),t.push(e),this.failedEvents.set(t))}},{key:"removeFromStorage",value:function(e){var t=this.failedEvents.get()||[],n=t.findIndex((function(t){return t.timestamp===e.timestamp}));n>-1&&(t.splice(n,1),this.failedEvents.set(t))}}]),e}(),Ji=new Qi,$i=function(){function e(){m(this,e),this.TAG="AnalyticsTransport"}return y(e,[{key:"sendEvent",value:function(e){try{this.sendSingleEvent(e),this.flushFailedEvents()}catch(S){hn.w(this.TAG,"sendEvent failed",S)}}},{key:"flushFailedEvents",value:function(e){var t;try{for(hn.d(this.TAG,"Flushing failed events",this.failedEvents);this.failedEvents.size()>0;){var n=this.failedEvents.dequeue();n&&((null==(t=n.metadata)?void 0:t.peerId)!==e&&n.metadata.peerId?Ji.sendEvent(n):this.sendSingleEvent(n))}}catch(r){hn.w(this.TAG,"flushFailedEvents failed",r)}}},{key:"sendSingleEvent",value:function(e){try{this.transportProvider.sendEvent(e),hn.d(this.TAG,"Sent event",e.name,e)}catch(S){throw hn.w(this.TAG,"".concat(this.transportProvider.TAG,".sendEvent failed, adding to local storage events"),{event:e,error:S}),this.failedEvents.enqueue(e),S}}}]),e}(),Yi=function(e){Ce(n,e);var t=_e(n);function n(){var e;return m(this,n),(e=t.call(this,100)).localStorage=new vr("hms-analytics"),e.localStorage.clear(),e.initLocalStorageQueue(),e}return y(n,[{key:"enqueue",value:function(e){Te(we(n.prototype),"enqueue",this).call(this,e),this.localStorage.set(this.storage)}},{key:"dequeue",value:function(){var e=Te(we(n.prototype),"dequeue",this).call(this);return this.localStorage.set(this.storage),e}},{key:"initLocalStorageQueue",value:function(){var e,t=this;null==(e=this.localStorage.get())||e.forEach((function(e){var r=new ci(e);Te(we(n.prototype),"enqueue",t).call(t,r)}))}}]),n}(Rr),Xi=function(e){Ce(n,e);var t=_e(n);function n(e){var r;return m(this,n),(r=t.call(this)).transportProvider=e,r.failedEvents=new Yi,r}return y(n)}($i),Zi=function(){function e(t,n){m(this,e),this.store=t,this.eventBus=n,this.TAG="[TrackDegradationController]",this.MAX_RECOVER_GRACE_PERIOD=120,this.recoverAttemptCount=0,this.packetsLost=0;var r=this.store.getSubscribeDegradationParams();this.PACKETS_LOST_THRESHOLD=r.packetLossThreshold,this.MIN_DEGRADE_GRACE_PERIOD=r.degradeGracePeriodSeconds,this.MIN_RECOVER_GRACE_PERIOD=r.recoverGracePeriodSeconds,this.degradeGracePeriod=this.MIN_DEGRADE_GRACE_PERIOD,this.recoverGracePeriod=this.MIN_RECOVER_GRACE_PERIOD}return y(e,[{key:"isAttemptingRecover",get:function(){return Boolean(this.recoveringTrack)}},{key:"handleRtcStatsChange",value:function(e){var t=e>this.packetsLost+this.PACKETS_LOST_THRESHOLD;this.packetsLost=e,t?this.degrade():this.recover()}},{key:"degrade",value:function(){if(!(this.degradeGracePeriod>0))return this.isAttemptingRecover?this.cancelRecovery():(hn.d(this.TAG,"Packet loss increased, Degrading",{packetsLost:this.packetsLost}),this.degradeActiveTracksByHalf(),this.degradeGracePeriod=this.MIN_DEGRADE_GRACE_PERIOD,void(this.recoverGracePeriod=this.MIN_RECOVER_GRACE_PERIOD));this.degradeGracePeriod--}},{key:"recover",value:function(){this.degradeGracePeriod=this.MIN_DEGRADE_GRACE_PERIOD,this.recoverGracePeriod>0?this.recoverGracePeriod--:(this.recoveringTrack=this.getActiveTracks(!0).find((function(e){return e.degraded})),this.recoveringTrack&&(hn.d(this.TAG,"Packet lost stable, recovering track",this.recoveringTrack),this.recoveringTrack.setDegradedFromSdk(!1),this.eventBus.trackRestored.publish(this.recoveringTrack),this.recoverGracePeriod=this.MIN_RECOVER_GRACE_PERIOD))}},{key:"cleanUp",value:function(){this.eventBus.trackDegraded.removeAllListeners(),this.eventBus.trackRestored.removeAllListeners()}},{key:"degradeActiveTracksByHalf",value:function(){var e=this.getActiveTracks(!1);if(e.length){hn.d(this.TAG,{activeTracks:v(e)});for(var t=Math.ceil(e.length/2);t--;){var n=e.pop();n.setDegradedFromSdk(!0),this.eventBus.trackDegraded.publish(n)}}}},{key:"getActiveTracks",value:function(e){var t=this;return this.store.getRemoteVideoTracks().filter((function(t){return t.hasSinks()&&(!t.degraded||e)})).sort((function(e,n){var r=t.store.getComparator().getTrackComparators();return-1*(r.screenShare(e,n)||r.rolePriority(e,n)||r.peerAudioLevel(e,n)||t.store.getComparator().stringComparator(e.trackId,n.trackId))})).slice(0)}},{key:"cancelRecovery",value:function(){this.recoveringTrack&&(this.recoveringTrack.setDegradedFromSdk(!0),this.eventBus.trackDegraded.publish(this.recoveringTrack)),this.recoveringTrack=void 0,this.recoverAttemptCount++,this.recoverGracePeriod=this.getDelayForRecoverCount(this.recoverAttemptCount),this.degradeGracePeriod=this.MIN_DEGRADE_GRACE_PERIOD,hn.d(this.TAG,"Recover Attempt Failed",{count:this.recoverAttemptCount,delay:this.recoverGracePeriod})}},{key:"getDelayForRecoverCount",value:function(e){var t=this.MIN_RECOVER_GRACE_PERIOD+this.MIN_RECOVER_GRACE_PERIOD*e;return Math.min(t,this.MAX_RECOVER_GRACE_PERIOD)}}]),e}(),ea=function(e){var t=e.stream instanceof Ci;return{peerConnectionType:t?"publish":"subscribe",nativeTrack:t?e.getTrackBeingSent():e.nativeTrack}},ta=function(e,t,n,r){return an(void 0,null,u().mark((function i(){var a,o,s,c,l,d,h,f;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=ea(t),s=o.peerConnectionType,c=o.nativeTrack,i.prev=1,i.next=4,null==(a=e[s])?void 0:a.call(e,c);case 4:l=i.sent,i.next=10;break;case 7:i.prev=7,i.t0=i.catch(1),hn.w("[HMSWebrtcStats]","Error in getting track stats",t,c,i.t0);case 10:return d=na(l),h=sa("publish"===s?"bytesSent":"bytesReceived",d,r),f=ua("packetsLost",d,r),i.abrupt("return",((null==d?void 0:d.remote)&&Object.assign(d.remote,{packetsLostRate:ua("packetsLost",d.remote,null==r?void 0:r.remote)}),d&&Object.assign(d,{bitrate:h,packetsLostRate:f,peerId:t.peerId,peerName:n})));case 12:case"end":return i.stop()}}),i,null,[[1,7]])})))},na=function(e){var t,n;return null==e||e.forEach((function(e){switch(e.type){case"inbound-rtp":case"outbound-rtp":t=e;break;case"remote-inbound-rtp":n=e}})),t&&Object.assign(t,{remote:n})},ra=function(e,t,n){var r=ia(t),i=sa("publish"===e?"bytesSent":"bytesReceived",r,n&&n[e]);return r&&Object.assign(r,{bitrate:i})},ia=function(e){var t;return e.forEach((function(n){"transport"===n.type&&(t=e.get(n.selectedCandidatePairId))})),t||e.forEach((function(e){"candidate-pair"===e.type&&e.selected&&(t=e)})),t},aa=function(e){var t={packetsLost:0,jitter:0};return null==e||e.forEach((function(e){e.packetsLost&&(t.packetsLost+=e.packetsLost),e.jitter>t.jitter&&(t.jitter=e.jitter)})),t},oa=function(e,t){return Array.from(new Set(e.concat(t)))},sa=function(e,t,n){return 8*ua(e,t,n)},ua=function(e,t,n){var r=t&&t[e],i=n?n[e]:null;return[t,n,In(r),In(i)].every((function(e){return!!e}))?1e3*ca(r,i,null==t?void 0:t.timestamp,null==n?void 0:n.timestamp):0},ca=function(e,t,n,r){return In(e)&&In(t)&&n&&r?(e-t)/(n-r):0},la=function(){function e(t,n){var r;m(this,e),this.getStats=t,this.store=n,this.TAG="[HMSWebrtcStats]",this.peerStats={},this.trackStats={},this.localPeerID=null==(r=this.store.getLocalPeer())?void 0:r.peerId}return y(e,[{key:"getLocalPeerStats",value:function(){return this.peerStats[this.localPeerID]}},{key:"getTrackStats",value:function(e){return this.trackStats[e]}},{key:"updateStats",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateLocalPeerStats();case 2:return e.next=4,this.updateTrackStats();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateLocalPeerStats",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a,o,s,c,l,d,h,f,p,v,m,g;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.getLocalPeerStats(),e.prev=1,e.next=4,null==(n=(t=this.getStats).publish)?void 0:n.call(t);case 4:c=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),hn.w(this.TAG,"Error in getting publish stats",e.t0);case 10:return l=c&&ra("publish",c,s),e.prev=11,e.next=14,null==(i=(r=this.getStats).subscribe)?void 0:i.call(r);case 14:d=e.sent,e.next=20;break;case 17:e.prev=17,e.t1=e.catch(11),hn.w(this.TAG,"Error in getting subscribe stats",e.t1);case 20:h=d&&ra("subscribe",d,s),f=aa(d),p=f.packetsLost,v=f.jitter,m=ca(p,null==(a=null==s?void 0:s.subscribe)?void 0:a.packetsLost,null==h?void 0:h.timestamp,null==(o=null==s?void 0:s.subscribe)?void 0:o.timestamp),g=h&&Object.assign(h,{packetsLostRate:m,jitter:v,packetsLost:p}),this.peerStats[this.localPeerID]={publish:l,subscribe:g};case 22:case"end":return e.stop()}}),e,this,[[1,7],[11,17]])})))}},{key:"updateTrackStats",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a,o,s,c,l,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.store.getTracksMap(),r=oa(Object.keys(this.trackStats),Object.keys(n)),i=k(r),e.prev=2,i.s();case 4:if((a=i.n()).done){e.next=19;break}if(o=a.value,!(s=n[o])){e.next=16;break}return c=s.peerId&&(null==(t=this.store.getPeerById(s.peerId))?void 0:t.name),l=this.getTrackStats(s.trackId),e.next=12,ta(this.getStats,s,c,l);case 12:(d=e.sent)&&(this.trackStats[o]=d),e.next=17;break;case 16:delete this.trackStats[o];case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),i.e(e.t0);case 24:return e.prev=24,i.f(),e.finish(24);case 27:case"end":return e.stop()}}),e,this,[[2,21,24,27]])})))}}]),e}(),da=function(){function e(t,n,r,i){var a=this;m(this,e),this.store=t,this.eventBus=n,this.publishConnection=r,this.subscribeConnection=i,this.TAG="[HMSWebrtcInternals]",this.interval=1e3,this.isMonitored=!1,this.handleStatsUpdate=function(){return an(a,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(t=this.hmsStats)?void 0:t.updateStats();case 2:this.eventBus.statsUpdate.publish(this.hmsStats);case 3:case"end":return e.stop()}}),e,this)})))}}return y(e,[{key:"getPublishPeerConnection",value:function(){return this.publishConnection}},{key:"getSubscribePeerConnection",value:function(){return this.subscribeConnection}},{key:"getCurrentStats",value:function(){return this.hmsStats}},{key:"onStatsChange",value:function(e){var t=this;return this.eventBus.statsUpdate.subscribe(e),function(){t.eventBus.statsUpdate.unsubscribe(e)}}},{key:"setPeerConnections",value:function(e){var t,n,r=e.publish,i=e.subscribe;this.publishConnection=r,this.subscribeConnection=i,this.hmsStats=new la({publish:null==(t=this.publishConnection)?void 0:t.getStats.bind(this.publishConnection),subscribe:null==(n=this.subscribeConnection)?void 0:n.getStats.bind(this.subscribeConnection)},this.store)}},{key:"start",value:function(){return an(this,null,u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMonitored){e.next=3;break}return hn.d(this.TAG,"Already started"),e.abrupt("return");case 3:this.stop(),this.isMonitored=!0,hn.d(this.TAG,"Starting Webrtc Stats Monitor"),this.startLoop().then((function(){return hn.d(t.TAG,"Stopping Webrtc Stats Monitor")})).catch((function(e){return hn.e(t.TAG,e.message)}));case 4:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){this.isMonitored=!1}},{key:"startLoop",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isMonitored){e.next=7;break}return e.next=3,this.handleStatsUpdate();case 3:return e.next=5,ti(this.interval);case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e,this)})))}},{key:"cleanUp",value:function(){this.stop(),this.eventBus.statsUpdate.removeAllListeners()}}]),e}(),ha="[HMSTransport]:",fa=function(){function e(t,n,r,i,a,o){var s,c,l=this;m(this,e),this.observer=t,this.deviceManager=n,this.store=r,this.localTrackManager=i,this.eventBus=a,this.analyticsEventsService=o,this.state=Oi.Disconnected,this.trackStates=new Map,this.publishConnection=null,this.subscribeConnection=null,this.maxSubscribeBitrate=0,this.callbacks=new Map,this.signalObserver={onOffer:function(e){return an(l,null,u().mark((function t(){var n,r,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.subscribeConnection.setRemoteDescription(e);case 3:hn.d(ha,"[SUBSCRIBE] Adding ".concat(this.subscribeConnection.candidates.length," ice-candidates"),this.subscribeConnection.candidates),n=k(this.subscribeConnection.candidates),t.prev=5,n.s();case 7:if((r=n.n()).done){t.next=13;break}return i=r.value,t.next=11,this.subscribeConnection.addIceCandidate(i);case 11:t.next=7;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(5),n.e(t.t0);case 18:return t.prev=18,n.f(),t.finish(18);case 21:return this.subscribeConnection.candidates.length=0,t.next=24,this.subscribeConnection.createAnswer();case 24:return a=t.sent,t.next=27,this.subscribeConnection.setLocalDescription(a);case 27:this.signal.answer(a),hn.d(ha,"[role=SUBSCRIBE] onOffer renegotiation DONE \u2705"),t.next=35;break;case 31:throw t.prev=31,t.t1=t.catch(0),hn.d(ha,"[role=SUBSCRIBE] onOffer renegotiation FAILED \u274c"),this.state=Oi.Failed,o=t.t1 instanceof bn?t.t1:Cn.Unknown(yn.PUBLISH,t.t1.message),this.eventBus.analytics.publish(Pi.subscribeFail(o)),o;case 35:case"end":return t.stop()}}),t,this,[[0,31],[5,15,18,21]])})))},onTrickle:function(e){return an(l,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==(n=e.target===mn.Publish?this.publishConnection:this.subscribeConnection).remoteDescription){t.next=5;break}n.candidates.push(e.candidate),t.next=7;break;case 5:return t.next=7,n.addIceCandidate(e.candidate);case 7:case"end":return t.stop()}}),t,this)})))},onNotification:function(e){return l.observer.onNotification(e)},onServerError:function(e){return an(l,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.observer.onStateChange(Oi.Failed,e);case 2:case"end":return t.stop()}}),t,this)})))},onFailure:function(e){l.joinParameters&&l.retryScheduler.schedule({category:Vi.SignalDisconnect,error:e,task:l.retrySignalDisconnectTask,originalState:l.state})},onOffline:function(e){return an(l,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:hn.d(ha,"socket offline",Oi[this.state]);try{this.state!==Oi.Leaving&&this.joinParameters&&this.retryScheduler.schedule({category:Vi.SignalDisconnect,error:wn.WebSocketConnectionLost(yn.RECONNECT_SIGNAL,e),task:this.retrySignalDisconnectTask,originalState:this.state})}catch(n){console.error(n)}case 2:case"end":return t.stop()}}),t,this)})))},onOnline:function(){var e;hn.d(ha,"socket online",Oi[l.state]),l.analyticsSignalTransport.flushFailedEvents(null==(e=l.store.getLocalPeer())?void 0:e.peerId)},onNetworkOnline:function(){l.analyticsEventsService.flushFailedClientEvents()}},this.signal=new _r(this.signalObserver),this.analyticsSignalTransport=new Xi(this.signal),this.publishConnectionObserver={onRenegotiationNeeded:function(){return an(l,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.performPublishRenegotiation();case 2:case"end":return e.stop()}}),e,this)})))},onIceConnectionChange:function(e){return an(l,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:hn.d("publisher ice connection state change, ",e);case 1:case"end":return t.stop()}}),t)})))},onConnectionStateChange:function(e){return an(l,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hn.d("publisher connection state change, ",e),t.t0="failed"===e,!t.t0){t.next=5;break}return t.next=5,this.handleIceConnectionFailure(mn.Publish);case 5:case"end":return t.stop()}}),t,this)})))}},this.subscribeConnectionObserver={onApiChannelMessage:function(e){l.observer.onNotification(JSON.parse(e))},onTrackAdd:function(e){hn.d(ha,"[Subscribe] onTrackAdd",e),l.observer.onTrackAdd(e)},onTrackRemove:function(e){hn.d(ha,"[Subscribe] onTrackRemove",e),l.observer.onTrackRemove(e)},onIceConnectionChange:function(e){return an(l,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:hn.d("subscriber ice connection state change, ",e),"connected"===e&&(n=this.callbacks.get(Bn),this.callbacks.delete(Bn),n&&n.promise.resolve(!0));case 1:case"end":return t.stop()}}),t,this)})))},onConnectionStateChange:function(e){return an(l,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hn.d("subscriber connection state change, ",e),t.t0="failed"===e,!t.t0){t.next=5;break}return t.next=5,this.handleIceConnectionFailure(mn.Subscribe);case 5:if("connected"!==e){t.next=8;break}n=this.callbacks.get(Bn),this.callbacks.delete(Bn),n&&n.promise.resolve(!0);case 8:case"end":return t.stop()}}),t,this)})))}},this.retryPublishIceFailedTask=function(){return an(l,null,u().mark((function e(){var t,n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.publishConnection||"connected"===this.publishConnection.iceConnectionState&&"connected"===this.publishConnection.connectionState){e.next=6;break}return t=new Promise((function(e,t){n.callbacks.set(Fn,{promise:{resolve:e,reject:t},action:yn.RESTART_ICE,extra:{}})})),e.next=4,this.performPublishRenegotiation({iceRestart:!0});case 4:return e.next=6,t;case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})))},this.retrySubscribeIceFailedTask=function(){return an(l,null,u().mark((function e(){var t,n,r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.subscribeConnection||"connected"===this.subscribeConnection.iceConnectionState&&"connected"===this.subscribeConnection.connectionState){e.next=3;break}return t=new Promise((function(e,t){r.callbacks.set(Bn,{promise:{resolve:e,reject:t},action:yn.RESTART_ICE,extra:{}})})),n=new Promise((function(e){setTimeout(e,6e4,!1)})),e.abrupt("return",Promise.race([t,n]));case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})))},this.retrySignalDisconnectTask=function(){return an(l,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hn.d(ha,"retrySignalDisconnectTask",{signalConnected:this.signal.isConnected}),this.signal.isConnected){e.next=8;break}return e.prev=1,e.next=4,this.internalConnect(this.joinParameters.authToken,this.joinParameters.endpoint,this.joinParameters.peerId);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:if(e.t1=this.signal.isConnected,!e.t1){e.next=13;break}return e.next=12,this.retryPublishIceFailedTask();case 12:e.t1=e.sent;case 13:return t=e.t1,e.abrupt("return",(this.signal.trackUpdate(this.trackStates),t));case 15:case"end":return e.stop()}}),e,this,[[1,6]])})))},this.webrtcInternals=new da(this.store,this.eventBus,null==(s=this.publishConnection)?void 0:s.nativeConnection,null==(c=this.subscribeConnection)?void 0:c.nativeConnection);this.retryScheduler=new qi((function(e,t){return an(l,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.t0=e!==this.state,!n.t0){n.next=5;break}return this.state=e,n.next=5,this.observer.onStateChange(this.state,t);case 5:case"end":return n.stop()}}),n,this)})))}),this.sendErrorAnalyticsEvent.bind(this)),this.eventBus.statsUpdate.subscribe((function(e){var t,n,r=(null==(n=null==(t=e.getLocalPeerStats())?void 0:t.subscribe)?void 0:n.bitrate)||0;l.maxSubscribeBitrate=Math.max(l.maxSubscribeBitrate,r)}))}return y(e,[{key:"getLocalScreen",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.localTrackManager.getLocalScreen(e,t);case 3:return n.abrupt("return",n.sent);case 6:throw n.prev=6,n.t0=n.catch(0),n.t0 instanceof bn&&this.eventBus.analytics.publish(Pi.publish({error:n.t0,devices:this.deviceManager.getDevices(),settings:new Lr(e,t,!1)})),n.t0;case 9:case"end":return n.stop()}}),n,this,[[0,6]])})))}},{key:"getWebrtcInternals",value:function(){return this.webrtcInternals}},{key:"isFlagEnabled",value:function(e){var t,n=null==(t=this.initConfig)?void 0:t.config;return((null==n?void 0:n.enabledFlags)||[]).includes(e)}},{key:"preview",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return an(this,null,u().mark((function a(){var o;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.connect(e,t,n,r,i);case 2:return o=a.sent,a.abrupt("return",(this.state=Oi.Preview,this.observer.onStateChange(this.state),o));case 4:case"end":return a.stop()}}),a,this)})))}},{key:"join",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return an(this,null,u().mark((function a(){var o,s,c;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(hn.d(ha,"join: started \u23f0"),o=new Date,a.prev=2,a.t0=!this.signal.isConnected||!this.initConfig,!a.t0){a.next=7;break}return a.next=7,this.connect(e,r,t,n,i);case 7:if(this.validateNotDisconnected("connect"),s=this.isFlagEnabled(Bi.FLAG_SERVER_SUB_DEGRADATION),a.t1=this.initConfig,!a.t1){a.next=13;break}return a.next=13,this.connectionJoin(n.name,n.metaData,this.initConfig.rtcConfiguration,i,s);case 13:a.next=23;break;case 15:return a.prev=15,a.t2=a.catch(2),hn.e(ha,"join: failed \u274c [token=".concat(e,"]"),a.t2),this.state=Oi.Failed,a.t2 instanceof bn&&this.eventBus.analytics.publish(Pi.join(o,new Date,a.t2)),(c=a.t2).isTerminal=500===c.code,a.next=22,this.observer.onStateChange(this.state,c);case 22:throw c;case 23:hn.d(ha,"\u2705 join: successful"),this.state=Oi.Joined,this.observer.onStateChange(this.state);case 24:case"end":return a.stop()}}),a,this,[[2,15]])})))}},{key:"connect",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return an(this,null,u().mark((function a(){var o,s=this;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return this.setTransportStateForConnect(),this.joinParameters=new Gi(e,n,r.name,r.metaData,t,i),a.prev=1,a.next=4,this.internalConnect(e,t,n);case 4:return a.abrupt("return",a.sent);case 7:if(a.prev=7,a.t0=a.catch(1),!(a.t0 instanceof bn&&([kn.WebSocketConnectionErrors.WEBSOCKET_CONNECTION_LOST,kn.WebSocketConnectionErrors.FAILED_TO_CONNECT,kn.InitAPIErrors.ENDPOINT_UNREACHABLE].includes(a.t0.code)||a.t0.code.toString().startsWith("5")||a.t0.code.toString().startsWith("429")))){a.next=15;break}return o=function(){return an(s,null,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.internalConnect(e,t,n);case 2:return r.abrupt("return",Boolean(this.initConfig&&this.initConfig.endpoint));case 3:case"end":return r.stop()}}),r,this)})))},a.next=13,this.retryScheduler.schedule({category:Vi.ConnectFailed,error:a.t0,task:o,originalState:this.state,maxFailedRetries:5,changeState:!1});case 13:a.next=16;break;case 15:throw a.t0;case 16:case"end":return a.stop()}}),a,this,[[1,7]])})))}},{key:"leave",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.retryScheduler.reset(),this.joinParameters=void 0,e.prev=1,this.state=Oi.Leaving,null==(t=this.webrtcInternals)||t.cleanUp(),null==(n=this.trackDegradationController)||n.cleanUp(),e.next=7,null==(r=this.publishConnection)?void 0:r.close();case 7:return e.next=9,null==(i=this.subscribeConnection)?void 0:i.close();case 9:try{this.signal.leave()}catch(a){hn.w(ha,"failed to send leave on websocket to server",a)}return this.analyticsEventsService.flushFailedClientEvents(),this.analyticsEventsService.reset(),e.next=14,this.signal.close();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),e.t0 instanceof bn&&this.eventBus.analytics.publish(Pi.disconnect(e.t0)),hn.e(ha,"leave: FAILED \u274c",e.t0);case 19:return e.prev=19,this.state=Oi.Disconnected,this.observer.onStateChange(this.state),e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[1,16,19,22]])})))}},{key:"publish",value:function(e){return an(this,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=k(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=15;break}return i=r.value,t.prev=5,t.next=8,this.publishTrack(i);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),t.t0 instanceof bn&&this.eventBus.analytics.publish(Pi.publish({devices:this.deviceManager.getDevices(),error:t.t0}));case 13:t.next=3;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(1),n.e(t.t1);case 20:return t.prev=20,n.f(),t.finish(20);case 23:case"end":return t.stop()}}),t,this,[[1,17,20,23],[5,10]])})))}},{key:"unpublish",value:function(e){return an(this,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=k(e),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=9;break}return i=r.value,t.next=7,this.unpublishTrack(i);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])})))}},{key:"sendMessage",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.broadcast(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"trackUpdate",value:function(e){var t=Array.from(this.trackStates.values()).find((function(t){return e.type===t.type&&e.source===t.source}));if(t){var n=new ji(rn(nn({},t),{mute:!e.enabled}));this.trackStates.set(t.track_id,n),hn.d(ha,"Track Update",this.trackStates,e),this.signal.trackUpdate(new Map([[t.track_id,n]]))}}},{key:"changeRole",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return an(this,null,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.signal.requestRoleChange({requested_for:e.peerId,role:t,force:n});case 2:case"end":return r.stop()}}),r,this)})))}},{key:"acceptRoleChange",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.acceptRoleChangeRequest({role:e.role.name,token:e.token});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"endRoom",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.signal.endRoom(e,t);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"removePeer",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.signal.removePeer({requested_for:e,reason:t});case 2:case"end":return n.stop()}}),n,this)})))}},{key:"startRTMPOrRecording",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={meeting_url:e.meetingURL,record:e.record},(null==(n=e.rtmpURLs)?void 0:n.length)&&(r.rtmp_urls=e.rtmpURLs),e.resolution&&(r.resolution=e.resolution),t.next=5,this.signal.startRTMPOrRecording(r);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"stopRTMPOrRecording",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signal.stopRTMPAndRecording();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"startHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={variants:e.variants.map((function(e){var t={meeting_url:e.meetingURL};return e.metadata&&(t.metadata=e.metadata),t}))},e.recording&&(n.hls_recording={single_file_per_layer:e.recording.singleFilePerLayer,hls_vod:e.recording.hlsVod}),t.next=4,this.signal.startHLSStreaming(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"stopHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}return n={variants:null==e?void 0:e.variants.map((function(e){var t={meeting_url:e.meetingURL};return e.metadata&&(t.metadata=e.metadata),t}))},t.next=4,this.signal.stopHLSStreaming(n);case 4:return t.next=6,this.signal.stopHLSStreaming();case 6:case"end":return t.stop()}}),t,this)})))}},{key:"changeName",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.updatePeer({name:e});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"changeMetadata",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.updatePeer({data:e});case 2:case"end":return t.stop()}}),t,this)})))}},{key:"changeTrackState",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.requestTrackStateChange(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"changeMultiTrackState",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.signal.requestMultiTrackStateChange(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"publishTrack",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.publishedTrackId=e.nativeTrack.id,hn.d(ha,"\u23f3 publishTrack: trackId=".concat(e.trackId,", toPublishTrackId=").concat(e.publishedTrackId),e),this.trackStates.set(e.publishedTrackId,new ji(e)),n=new Promise((function(e,t){o.callbacks.set(Fn,{promise:{resolve:e,reject:t},action:yn.PUBLISH,extra:{}})})),(r=e.stream).setConnection(this.publishConnection),i=this.store.getSimulcastLayers(e.source),r.addTransceiver(e,i),hn.time("publish-".concat(e.trackId,"-").concat(e.type)),t.next=8,n;case 8:if(hn.timeEnd("publish-".concat(e.trackId,"-").concat(e.type)),this.store.addTrack(e),a=e.settings.maxBitrate,t.t0=a,!t.t0){t.next=15;break}return t.next=15,r.setMaxBitrate(a,e).then((function(){hn.d(ha,"Setting maxBitrate for ".concat(e.source," ").concat(e.type," to ").concat(a," kpbs"))})).catch((function(e){return hn.e(ha,"Failed setting maxBitrate",e)}));case 15:hn.d(ha,"\u2705 publishTrack: trackId=".concat(e.trackId),e,this.callbacks);case 16:case"end":return t.stop()}}),t,this)})))}},{key:"unpublishTrack",value:function(e){return an(this,null,u().mark((function t(){var n,r,i=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return hn.d(ha,"\u23f3 unpublishTrack: trackId=".concat(e.trackId),e),e.publishedTrackId&&this.trackStates.has(e.publishedTrackId)?this.trackStates.delete(e.publishedTrackId):(n=Array.from(this.trackStates.values()).find((function(t){return e.type===t.type&&e.source===t.source})),n&&this.trackStates.delete(n.track_id)),r=new Promise((function(e,t){i.callbacks.set(Fn,{promise:{resolve:e,reject:t},action:yn.UNPUBLISH,extra:{}})})),e.stream.removeSender(e),t.next=5,r;case 5:return t.next=7,e.cleanup();case 7:this.store.removeTrack(e.trackId),hn.d(ha,"\u2705 unpublishTrack: trackId=".concat(e.trackId),this.callbacks);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"connectionJoin",value:function(e,t,n,r,i){return an(this,arguments,u().mark((function e(t,n,r,i,a){var o,s,c,l,d,h,f=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=f.length>5&&void 0!==f[5]?f[5]:{offerToReceiveAudio:!1,offerToReceiveVideo:!1},this.publishConnection=new rr(this.signal,r,this.publishConnectionObserver,this),this.subscribeConnection=new pr(this.signal,r,this.subscribeConnectionObserver),e.prev=2,hn.d(ha,"\u23f3 join: Negotiating over PUBLISH connection"),e.next=6,this.publishConnection.createOffer(o,new Map);case 6:return s=e.sent,e.next=9,this.publishConnection.setLocalDescription(s);case 9:return e.next=11,this.signal.join(t,n,s,!i,a);case 11:return c=e.sent,e.next=14,this.publishConnection.setRemoteDescription(c);case 14:l=k(this.publishConnection.candidates||[]),e.prev=15,l.s();case 17:if((d=l.n()).done){e.next=23;break}return h=d.value,e.next=21,this.publishConnection.addIceCandidate(h);case 21:e.next=17;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(15),l.e(e.t0);case 28:return e.prev=28,l.f(),e.finish(28);case 31:return this.publishConnection.initAfterJoin(),e.next=34,this.initRtcStatsMonitor();case 34:hn.d(ha,"\u2705 join: Negotiated over PUBLISH connection"),e.next=40;break;case 37:throw e.prev=37,e.t1=e.catch(2),this.state=Oi.Failed,e.t1;case 40:case"end":return e.stop()}}),e,this,[[2,37],[15,25,28,31]])})))}},{key:"performPublishRenegotiation",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hn.d(ha,"\u23f3 [role=PUBLISH] onRenegotiationNeeded START",this.trackStates),!(n=this.callbacks.get(Fn))){t.next=24;break}return t.prev=3,t.next=6,this.publishConnection.createOffer(e,this.trackStates);case 6:return r=t.sent,t.next=9,this.publishConnection.setLocalDescription(r);case 9:return hn.time("renegotiation-offer-exchange"),t.next=12,this.signal.offer(r,this.trackStates);case 12:return i=t.sent,this.callbacks.delete(Fn),hn.timeEnd("renegotiation-offer-exchange"),t.next=17,this.publishConnection.setRemoteDescription(i);case 17:n.promise.resolve(!0),hn.d(ha,"[role=PUBLISH] onRenegotiationNeeded DONE \u2705"),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(3),a=t.t0 instanceof bn?t.t0:Cn.Unknown(yn.PUBLISH,t.t0.message),n.promise.reject(a),hn.d(ha,"[role=PUBLISH] onRenegotiationNeeded FAILED \u274c");case 24:case"end":return t.stop()}}),t,this,[[3,21]])})))}},{key:"handleIceConnectionFailure",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e===mn.Publish?this.retryScheduler.schedule({category:Vi.PublishIceConnectionFailed,error:En.ICEFailure(yn.PUBLISH),task:this.retryPublishIceFailedTask,originalState:this.state}):this.retryScheduler.schedule({category:Vi.SubscribeIceConnectionFailed,error:En.ICEFailure(yn.SUBSCRIBE),task:this.retrySubscribeIceFailedTask,originalState:this.state,maxFailedRetries:1});case 1:case"end":return t.stop()}}),t,this)})))}},{key:"internalConnect",value:function(e,t,n){return an(this,null,u().mark((function r(){var i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return hn.d(ha,"connect: started \u23f0"),i=new Date,r.prev=2,r.next=5,Tr.fetchInitConfig(e,n,t);case 5:return this.initConfig=r.sent,this.validateNotDisconnected("post init"),r.next=9,this.openSignal(e,n);case 9:return hn.d(ha,"Adding Analytics Transport: JsonRpcSignal"),this.analyticsEventsService.setTransport(this.analyticsSignalTransport),this.analyticsEventsService.flush(),r.abrupt("return",this.initConfig);case 15:throw r.prev=15,r.t0=r.catch(2),r.t0 instanceof bn&&this.state!==Oi.Reconnecting&&this.eventBus.analytics.publish(Pi.connect(r.t0,this.getAdditionalAnalyticsProperties(),i,new Date,t)),hn.d(ha,"\u274c internal connect: failed",r.t0),r.t0;case 18:case"end":return r.stop()}}),r,this,[[2,15]])})))}},{key:"validateNotDisconnected",value:function(e){if(this.state===Oi.Disconnected)throw hn.w(ha,"aborting join as transport state is disconnected"),Cn.ValidationFailed("leave called before join could complete - stage=".concat(e))}},{key:"openSignal",value:function(e,t){return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.initConfig){n.next=2;break}throw Sn.InitConfigNotAvailable(yn.INIT,"Init Config not found");case 2:return hn.d(ha,"\u23f3 internal connect: connecting to ws endpoint",this.initConfig.endpoint),(r=new URL(this.initConfig.endpoint)).searchParams.set("peer",t),r.searchParams.set("token",e),r.searchParams.set("user_agent",wr),this.endpoint=r.toString(),n.next=10,this.signal.open(this.endpoint);case 10:hn.d(ha,"\u2705 internal connect: connected to ws endpoint");case 11:case"end":return n.stop()}}),n,this)})))}},{key:"initRtcStatsMonitor",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=this.webrtcInternals)||r.setPeerConnections({publish:null==(t=this.publishConnection)?void 0:t.nativeConnection,subscribe:null==(n=this.subscribeConnection)?void 0:n.nativeConnection}),e.t0=this.store.getSubscribeDegradationParams(),!e.t0){e.next=11;break}if(e.t1=this.isFlagEnabled(Bi.FLAG_SERVER_SUB_DEGRADATION),e.t1){e.next=9;break}return e.next=7,null==(i=this.webrtcInternals)?void 0:i.start();case 7:this.trackDegradationController=new Zi(this.store,this.eventBus),this.eventBus.statsUpdate.subscribe((function(e){var t,n,r;null==(r=a.trackDegradationController)||r.handleRtcStatsChange((null==(n=null==(t=e.getLocalPeerStats())?void 0:t.subscribe)?void 0:n.packetsLost)||0)}));case 9:this.eventBus.trackDegraded.subscribe((function(e){a.eventBus.analytics.publish(Pi.degradationStats(e,!0)),a.observer.onTrackDegrade(e)})),this.eventBus.trackRestored.subscribe((function(e){a.eventBus.analytics.publish(Pi.degradationStats(e,!1)),a.observer.onTrackRestore(e)}));case 11:case"end":return e.stop()}}),e,this)})))}},{key:"setTransportStateForConnect",value:function(){if(this.state===Oi.Failed&&(this.state=Oi.Disconnected),this.state!==Oi.Disconnected&&this.state!==Oi.Reconnecting)throw xn.AlreadyJoined(yn.JOIN,"Cannot join a meeting in ".concat(this.state," state"));this.state===Oi.Disconnected&&(this.state=Oi.Connecting,this.observer.onStateChange(this.state))}},{key:"sendErrorAnalyticsEvent",value:function(e,t){var n,r=this.getAdditionalAnalyticsProperties();switch(t){case Vi.ConnectFailed:n=Pi.connect(e,r);break;case Vi.SignalDisconnect:n=Pi.disconnect(e,r);break;case Vi.PublishIceConnectionFailed:n=Pi.publish({error:e});break;case Vi.SubscribeIceConnectionFailed:n=Pi.subscribeFail(e)}this.eventBus.analytics.publish(n)}},{key:"getAdditionalAnalyticsProperties",value:function(){var e,t,n,r,i,a,o,s,u=function(){if(kr&&"undefined"!=typeof navigator.connection){var e=navigator.connection;return{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,rtt:e.rtt,saveData:e.saveData,type:e.type}}}(),c="undefined"!=typeof document&&document.hidden,l=this.store.getRemoteVideoTracks().filter((function(e){return e.degraded})).length;return{network_info:u,document_hidden:c,num_degraded_tracks:l,bitrate:{publish:null==(r=null==(n=null==(t=null==(e=this.getWebrtcInternals())?void 0:e.getCurrentStats())?void 0:t.getLocalPeerStats())?void 0:n.publish)?void 0:r.bitrate,subscribe:null==(s=null==(o=null==(a=null==(i=this.getWebrtcInternals())?void 0:i.getCurrentStats())?void 0:a.getLocalPeerStats())?void 0:o.subscribe)?void 0:s.bitrate},max_sub_bitrate:this.maxSubscribeBitrate,recent_pong_response_times:this.signal.getPongResponseTimes(),transport_state:this.state}}}]),e}();function pa(e){if(0===e.length)throw Sn.InvalidTokenFormat(yn.INIT,"Token cannot be an empty string");var t=e.split(".");if(3!==t.length)throw Sn.InvalidTokenFormat(yn.INIT,"Expected 3 '.' separate fields - header, payload and signature respectively");var n=atob(t[1]);try{var r=JSON.parse(n);return{roomId:r.room_id,userId:r.user_id,role:r.role}}catch(i){throw Sn.InvalidTokenFormat(yn.INIT,"couldn't parse to json - ".concat(i.message))}}var va=function(){function e(t,n){m(this,e),this.id=t,this.store=n,this.recording={server:{running:!1},browser:{running:!1},hls:{running:!1}},this.rtmp={running:!1},this.hls={running:!1,variants:[]}}return y(e,[{key:"localPeer",get:function(){return this.store.getLocalPeer()}},{key:"peers",get:function(){return this.store.getPeers()}}]),e}(),ma={autoplayFailed:void 0,initialized:!1,autoplayCheckPromise:void 0},ga=function(){function e(t,n,r){var i=this;m(this,e),this.store=t,this.deviceManager=n,this.eventBus=r,this.autoPausedTracks=new Set,this.TAG="[AudioSinkManager]:",this.volume=100,this.state=nn({},ma),this.handleAudioPaused=function(e){var t,n=null==(t=e.target.srcObject)?void 0:t.getAudioTracks()[0];if(null==n?void 0:n.enabled){hn.d(i.TAG,"Audio Paused",e.target.id);var r=i.store.getTrackById(e.target.id);r&&("mobile"===gr.getDevice().type?setTimeout((function(){return an(i,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,!e.t0){e.next=4;break}return e.next=4,this.playAudioFor(r);case 4:case"end":return e.stop()}}),e,this)})))}),500):i.autoPausedTracks.add(r))}},this.handleTrackUpdate=function(e){var t,n=e.track,r=e.enabled;(null==(t=window.HMS)?void 0:t.AUDIO_SINK)&&(r?(n.addSink(),i.playAudioFor(n)):n.removeSink())},this.handleTrackAdd=function(e){return an(i,[e],u().mark((function e(t){var n,r,i,a,o,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.peer,(s=document.createElement("audio")).style.display="none",s.id=n.trackId,s.addEventListener("pause",this.handleAudioPaused),n.setAudioElement(s),n.setVolume(this.volume),hn.d(this.TAG,"Audio track added",n.trackId),null==(i=this.audioSink)||i.append(s),e.t0=this.outputDevice,!e.t0){e.next=13;break}return e.next=13,n.setOutputDevice(this.outputDevice);case 13:return(null==(a=window.HMS)?void 0:a.AUDIO_SINK)?n.enabled?n.addSink():n.removeSink():s.srcObject=new MediaStream([n.nativeTrack]),null==(o=this.listener)||o.onTrackUpdate(un.TRACK_ADDED,n,r),e.next=17,this.handleAutoplayError(n);case 17:case"end":return e.stop()}}),e,this)})))},this.handleAutoplayError=function(e){return an(i,null,u().mark((function t(){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=void 0===this.state.autoplayFailed,!t.t0){t.next=5;break}return this.state.autoplayCheckPromise||(this.state.autoplayCheckPromise=new Promise((function(t){n.playAudioFor(e).then(t)}))),t.next=5,this.state.autoplayCheckPromise;case 5:if(!this.state.autoplayFailed){t.next=8;break}return this.autoPausedTracks.add(e),t.abrupt("return");case 8:return t.next=10,this.playAudioFor(e);case 10:case"end":return t.stop()}}),t,this)})))},this.handleAudioDeviceChange=function(e){e.error||!e.selection||"video"===e.type||i.unpauseAudioTracks()},this.handleTrackRemove=function(e){i.autoPausedTracks.delete(e);var t=document.getElementById(e.trackId);t&&(t.removeEventListener("pause",i.handleAudioPaused),t.srcObject=null,t.remove(),e.setAudioElement(null)),i.audioSink&&0===i.audioSink.childElementCount&&(i.state.autoplayCheckPromise=void 0,i.state.autoplayFailed=void 0),hn.d(i.TAG,"Audio track removed",e.trackId)},this.unpauseAudioTracks=function(){return an(i,null,u().mark((function e(){var t,n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.autoPausedTracks.forEach((function(e){t.push(n.playAudioFor(e))})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})))},this.eventBus.audioTrackAdded.subscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.subscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.subscribe(this.handleTrackUpdate),this.eventBus.deviceChange.subscribe(this.handleAudioDeviceChange)}return y(e,[{key:"setListener",value:function(e){this.listener=e}},{key:"outputDevice",get:function(){return this.deviceManager.outputDevice}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.store.updateAudioOutputVolume(e),this.volume=e}},{key:"unblockAutoplay",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.autoPausedTracks.size>0&&this.unpauseAudioTracks();case 1:case"end":return e.stop()}}),e,this)})))}},{key:"init",value:function(e){if(!this.state.initialized){this.state.initialized=!0;var t=document.createElement("div");t.id="HMS-SDK-audio-sink-".concat(qt()),(e&&document.getElementById(e)||document.body).append(t),this.audioSink=t}}},{key:"cleanUp",value:function(){var e;null==(e=this.audioSink)||e.remove(),this.audioSink=void 0,this.eventBus.audioTrackAdded.unsubscribe(this.handleTrackAdd),this.eventBus.audioTrackRemoved.unsubscribe(this.handleTrackRemove),this.eventBus.audioTrackUpdate.unsubscribe(this.handleTrackUpdate),this.eventBus.deviceChange.unsubscribe(this.handleAudioDeviceChange),this.autoPausedTracks=new Set,this.state=nn({},ma)}},{key:"playAudioFor",value:function(e){return an(this,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.getAudioElement()){t.next=4;break}return hn.w(this.TAG,"No audio element found on track",e.trackId),t.abrupt("return");case 4:return t.prev=4,t.next=7,n.play();case 7:this.state.autoplayFailed=!1,this.autoPausedTracks.delete(e),hn.d(this.TAG,"Played track",e.trackId),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(4),this.autoPausedTracks.add(e),hn.e(this.TAG,"Failed to play track",e.trackId,t.t0),r=t.t0,this.state.autoplayFailed||"NotAllowedError"!==r.name||(this.state.autoplayFailed=!0,(i=Tn.AutoplayBlocked(yn.AUTOPLAY,"")).addNativeError(r),this.eventBus.analytics.publish(Pi.autoplayError()),this.eventBus.autoplayError.publish(i));case 17:case"end":return t.stop()}}),t,this,[[4,12]])})))}}]),e}(),ya=function(){function e(t,n){var r=this;m(this,e),this.store=t,this.eventBus=n,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.hasWebcamPermission=!1,this.hasMicrophonePermission=!1,this.TAG="[Device Manager]:",this.initialized=!1,this.videoInputChanged=!1,this.audioInputChanged=!1,this.updateOutputDevice=function(e){var t=r.audioOutput.find((function(t){return t.deviceId===e}));return t&&(r.outputDevice=t,r.store.updateAudioOutputDevice(t),mi.updateSelection("audioOutput",{deviceId:t.deviceId,groupId:t.groupId})),t},this.getCurrentSelection=function(){var e,t,n=r.store.getLocalPeer(),i=r.createIdentifier(null==(e=null==n?void 0:n.audioTrack)?void 0:e.getMediaTrackSettings()),a=r.createIdentifier(null==(t=null==n?void 0:n.videoTrack)?void 0:t.getMediaTrackSettings()),o=r.audioInput.find((function(e){return r.createIdentifier(e)===i})),s=r.videoInput.find((function(e){return r.createIdentifier(e)===a}));return{audioInput:o,videoInput:s,audioOutput:r.outputDevice}},this.computeChange=function(e,t){return e.length!==t.length||t.some((function(t){return!e.includes(r.createIdentifier(t))}))},this.enumerateDevices=function(){return an(r,null,u().mark((function e(){var t,n,r,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:t=e.sent,n=this.videoInput.map(this.createIdentifier),r=this.audioInput.map(this.createIdentifier),this.audioInput=[],this.audioOutput=[],this.videoInput=[],t.forEach((function(e){"audioinput"===e.kind&&e.label?(i.hasMicrophonePermission=!0,i.audioInput.push(e)):"audiooutput"===e.kind?i.audioOutput.push(e):"videoinput"===e.kind&&e.label&&(i.hasWebcamPermission=!0,i.videoInput.push(e))})),this.videoInputChanged=this.computeChange(n,this.videoInput),this.audioInputChanged=this.computeChange(r,this.audioInput),mi.setDevices({videoInput:v(this.videoInput),audioInput:v(this.audioInput),audioOutput:v(this.audioOutput)}),this.logDevices("Enumerate Devices"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),hn.e(this.TAG,"Failed enumerating devices",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})))},this.handleDeviceChange=function(){return an(r,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enumerateDevices();case 2:return this.eventBus.analytics.publish(Pi.deviceChange({selection:this.getCurrentSelection(),type:"list",devices:this.getDevices()})),this.logDevices("After Device Change"),t=this.store.getLocalPeer(),this.setOutputDevice(!0),e.next=8,this.handleAudioInputDeviceChange(null==t?void 0:t.audioTrack);case 8:return e.next=10,this.handleVideoInputDeviceChange(null==t?void 0:t.videoTrack);case 10:case"end":return e.stop()}}),e,this)})))},this.handleAudioInputDeviceChange=function(e){return an(r,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return hn.d(this.TAG,"No Audio track on local peer"),t.abrupt("return");case 3:if(this.audioInputChanged){t.next=6;break}return hn.d(this.TAG,"No Change in AudioInput Device"),t.abrupt("return");case 6:if((n=this.getNewAudioInputDevice())&&n.deviceId){t.next=10;break}return hn.w(this.TAG,"Audio device not found"),t.abrupt("return");case 10:return r=e.settings,i=(new Ir).codec(r.codec).maxBitrate(r.maxBitrate).deviceId(n.deviceId).build(),t.prev=11,t.next=14,e.setSettings(i,!0);case 14:this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:n,type:"audioInput"}),this.logDevices("Audio Device Change Success"),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(11),hn.e(this.TAG,"[Audio Device Change]",t.t0),this.eventBus.analytics.publish(Pi.deviceChange({selection:{audioInput:n},devices:this.getDevices(),error:t.t0})),this.eventBus.deviceChange.publish({error:t.t0,selection:n,type:"audioInput",devices:this.getDevices()});case 21:case"end":return t.stop()}}),t,this,[[11,18]])})))},this.handleVideoInputDeviceChange=function(e){return an(r,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return hn.d(this.TAG,"No video track on local peer"),t.abrupt("return");case 3:if(this.videoInputChanged){t.next=6;break}return hn.d(this.TAG,"No Change in VideoInput Device"),t.abrupt("return");case 6:if((n=this.videoInput[0])&&n.deviceId){t.next=10;break}return hn.w(this.TAG,"Video device not found"),t.abrupt("return");case 10:return r=e.settings,i=(new Dr).codec(r.codec).maxBitrate(r.maxBitrate).maxFramerate(r.maxFramerate).setWidth(r.width).setHeight(r.height).deviceId(n.deviceId).build(),t.prev=11,t.next=14,e.setSettings(i,!0);case 14:this.eventBus.deviceChange.publish({devices:this.getDevices(),selection:n,type:"video"}),this.logDevices("Video Device Change Success"),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(11),hn.e(this.TAG,"[Video Device Change]",t.t0),this.eventBus.analytics.publish(Pi.deviceChange({selection:{videoInput:n},devices:this.getDevices(),error:t.t0})),this.eventBus.deviceChange.publish({error:t.t0,type:"video",selection:n,devices:this.getDevices()});case 21:case"end":return t.stop()}}),t,this,[[11,18]])})))};var i=function(e){var t=e.enabled,n=e.track;return t&&"regular"===n.source};this.eventBus.localVideoEnabled.waitFor(i).then((function(){return an(r,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enumerateDevices();case 2:this.videoInputChanged&&this.eventBus.deviceChange.publish({devices:this.getDevices()});case 3:case"end":return e.stop()}}),e,this)})))})),this.eventBus.localAudioEnabled.waitFor(i).then((function(){return an(r,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enumerateDevices();case 2:this.audioInputChanged&&this.eventBus.deviceChange.publish({devices:this.getDevices()});case 3:case"end":return e.stop()}}),e,this)})))}))}return y(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this.initialized&&!e,t.t0){t.next=10;break}return!this.initialized&&navigator.mediaDevices.addEventListener("devicechange",this.handleDeviceChange),this.initialized=!0,t.next=6,this.enumerateDevices();case 6:this.logDevices("Init"),this.setOutputDevice(),this.eventBus.deviceChange.publish({devices:this.getDevices()}),this.eventBus.analytics.publish(Pi.deviceChange({selection:this.getCurrentSelection(),type:"list",devices:this.getDevices()}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getDevices",value:function(){return{audioInput:this.audioInput,audioOutput:this.audioOutput,videoInput:this.videoInput}}},{key:"cleanUp",value:function(){this.initialized=!1,this.audioInput=[],this.audioOutput=[],this.videoInput=[],this.outputDevice=void 0,navigator.mediaDevices.removeEventListener("devicechange",this.handleDeviceChange)}},{key:"createIdentifier",value:function(e){return e?"".concat(e.deviceId).concat(e.groupId):""}},{key:"getNewAudioInputDevice",value:function(){var e=this.audioInput.find((function(e){return"default"===e.deviceId}));return e?this.audioInput.find((function(t){return t.label!==e.label&&e.label.includes(t.label)})):this.audioInput[0]}},{key:"setOutputDevice",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getNewAudioInputDevice(),n=this.createIdentifier(this.outputDevice);this.outputDevice=void 0,(null==t?void 0:t.groupId)&&(this.outputDevice=this.audioOutput.find((function(e){return"default"!==t.deviceId&&e.label===t.label}))),this.outputDevice||(this.outputDevice=this.audioOutput.find((function(e){return"default"===e.deviceId}))||this.audioOutput[0]),this.store.updateAudioOutputDevice(this.outputDevice),e&&n!==this.createIdentifier(this.outputDevice)&&this.eventBus.deviceChange.publish({selection:this.outputDevice,type:"audioOutput",devices:this.getDevices()})}},{key:"logDevices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";hn.d(this.TAG,e,JSON.stringify({videoInput:v(this.videoInput),audioInput:v(this.audioInput),audioOutput:v(this.audioOutput),selected:this.getCurrentSelection()},null,4))}}]),e}(),ka=function(){function e(t,n){m(this,e),this.deviceManager=t,this.audioSinkManager=n}return y(e,[{key:"getVolume",value:function(){return this.audioSinkManager.getVolume()}},{key:"setVolume",value:function(e){if(e<0||e>100)throw Error("Please pass a valid number between 0-100");this.audioSinkManager.setVolume(e)}},{key:"getDevice",value:function(){return this.deviceManager.outputDevice}},{key:"setDevice",value:function(e){return this.deviceManager.updateOutputDevice(e)}},{key:"unblockAutoplay",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.audioSinkManager.unblockAutoplay();case 2:case"end":return e.stop()}}),e,this)})))}}]),e}(),ba="AnalyticsEventsService",wa=function(){function e(t){m(this,e),this.store=t,this.bufferSize=100,this.transport=null,this.pendingEvents=[],this.level=oi.INFO}return y(e,[{key:"setTransport",value:function(e){this.transport=e}},{key:"reset",value:function(){this.transport=null,this.pendingEvents=[]}},{key:"queue",value:function(e){if(e.level>=this.level&&(this.pendingEvents.push(e),this.pendingEvents.length>this.bufferSize)){var t=this.pendingEvents.shift();hn.d(ba,"Max buffer size reached","Removed event to accommodate new events",t)}return this}},{key:"flushFailedClientEvents",value:function(){Ji.flushFailedEvents()}},{key:"flush",value:function(){var e;try{for(;this.pendingEvents.length>0;){var t=this.pendingEvents.shift();t&&(t.metadata.peerId=null==(e=this.store.getLocalPeer())?void 0:e.peerId,this.transport&&this.transport.transportProvider.isConnected?this.transport.sendEvent(t):this.sendClientEventOnHTTP(t))}}catch(S){hn.w(ba,"Flush Failed",S)}}},{key:"sendClientEventOnHTTP",value:function(e){var t;e.metadata.sessionId=this.store.getRoom().sessionId,e.metadata.token=null==(t=this.store.getConfig())?void 0:t.authToken,e.metadata.roomId=this.store.getRoom().id,Ji.sendEvent(e)}}]),e}(),Sa=function(){function e(t){m(this,e),this.store=t,this.primitiveComparator=function(e,t){return e===t?0:Number(e)-Number(t)},this.stringComparator=function(e,t){return e===t?0:e<t?-1:1}}return y(e,[{key:"getPeerComparators",value:function(){var e=this;return{videoEnabled:function(t,n){var r,i;return e.primitiveComparator(Boolean(null==(r=t.videoTrack)?void 0:r.enabled),Boolean(null==(i=n.videoTrack)?void 0:i.enabled))},audioEnabled:function(t,n){var r,i;return e.primitiveComparator(Boolean(null==(r=t.audioTrack)?void 0:r.enabled),Boolean(null==(i=n.audioTrack)?void 0:i.enabled))},screenShare:function(t,n){return e.primitiveComparator(t.auxiliaryTracks.some((function(e){return"screen"===e.source})),n.auxiliaryTracks.some((function(e){return"screen"===e.source})))},audioLevel:function(t,n){var r,i;return e.primitiveComparator((null==(r=e.store.getSpeakers().find((function(e){return e.peer&&e.peer.peerId===(null==t?void 0:t.peerId)})))?void 0:r.audioLevel)||-1,(null==(i=e.store.getSpeakers().find((function(e){return e.peer&&e.peer.peerId===(null==n?void 0:n.peerId)})))?void 0:i.audioLevel)||-1)},rolePriority:function(t,n){var r,i;return e.primitiveComparator((null==(r=t.role)?void 0:r.priority)||0,(null==(i=n.role)?void 0:i.priority)||0)}}}},{key:"getTrackComparators",value:function(){var e=this;return{video:function(t,n){return e.primitiveComparator(t.type===Ln.VIDEO,n.type===Ln.VIDEO)},audio:function(t,n){return e.primitiveComparator(t.type===Ln.AUDIO,n.type===Ln.AUDIO)},enabled:function(t,n){return e.primitiveComparator(Boolean(t.enabled),Boolean(n.enabled))},peerAudioLevel:function(t,n){var r=e.store.getPeerByTrackId(t.trackId),i=e.store.getPeerByTrackId(n.trackId);return e.getPeerComparators().audioLevel(r,i)},audioLevel:function(t,n){var r,i;return e.primitiveComparator((null==(r=e.store.getSpeakers().find((function(e){return e.track.trackId===t.trackId})))?void 0:r.audioLevel)||0,(null==(i=e.store.getSpeakers().find((function(e){return e.track.trackId===n.trackId})))?void 0:i.audioLevel)||0)},screenShare:function(t,n){return e.primitiveComparator("screen"===t.source,"screen"===n.source)},rolePriority:function(t,n){var r,i,a,o;return e.primitiveComparator((null==(i=null==(r=e.store.getPeerByTrackId(t.trackId))?void 0:r.role)?void 0:i.priority)||0,(null==(o=null==(a=e.store.getPeerByTrackId(n.trackId))?void 0:a.role)?void 0:o.priority)||0)}}}}]),e}(),Ta=function(){function e(){m(this,e),this.comparator=new Sa(this),this.knownRoles={},this.peers={},this.tracks={},this.peerTrackStates={},this.speakers=[],this.videoLayers=null,this.screenshareLayers=null,this.roleDetailsArrived=!1,this.env=zi.PROD}return y(e,[{key:"getConfig",value:function(){return this.config}},{key:"getEnv",value:function(){return this.env}},{key:"getPublishParams",value:function(){return this.publishParams}},{key:"getComparator",value:function(){return this.comparator}},{key:"getRoom",value:function(){return this.room}},{key:"getPolicyForRole",value:function(e){return this.knownRoles[e]}},{key:"getKnownRoles",value:function(){return this.knownRoles}},{key:"getLocalPeer",value:function(){if(this.localPeerId&&this.peers[this.localPeerId])return this.peers[this.localPeerId]}},{key:"getRemotePeers",value:function(){return Object.values(this.peers).filter((function(e){return!e.isLocal}))}},{key:"getPeers",value:function(){return Object.values(this.peers)}},{key:"getPeerById",value:function(e){if(this.peers[e])return this.peers[e]}},{key:"getTracksMap",value:function(){return this.tracks}},{key:"getTracks",value:function(){return Object.values(this.tracks)}},{key:"getVideoTracks",value:function(){return this.getTracks().filter((function(e){return e.type===Ln.VIDEO}))}},{key:"getRemoteVideoTracks",value:function(){return this.getTracks().filter((function(e){return e instanceof hr}))}},{key:"getAudioTracks",value:function(){return this.getTracks().filter((function(e){return e.type===Ln.AUDIO}))}},{key:"getPeerTracks",value:function(e){var t=e?this.peers[e]:void 0,n=[];return(null==t?void 0:t.videoTrack)&&n.push(t.videoTrack),(null==t?void 0:t.audioTrack)&&n.push(t.audioTrack),n.concat((null==t?void 0:t.auxiliaryTracks)||[])}},{key:"getLocalPeerTracks",value:function(){return this.getPeerTracks(this.localPeerId)}},{key:"getTrackById",value:function(e){var t,n,r=this.tracks[e];if(r)return r;var i=this.getLocalPeer();if(i){if(null==(t=i.audioTrack)?void 0:t.isPublishedTrackId(e))return i.audioTrack;if(null==(n=i.videoTrack)?void 0:n.isPublishedTrackId(e))return i.videoTrack}}},{key:"getPeerByTrackId",value:function(e){var t=this.tracks[e];return t.peerId?this.peers[t.peerId]:void 0}},{key:"getSpeakers",value:function(){return this.speakers}},{key:"getSpeakerPeers",value:function(){return this.speakers.map((function(e){return e.peer}))}},{key:"setRoom",value:function(e){this.room=e}},{key:"setKnownRoles",value:function(e){this.knownRoles=e,this.roleDetailsArrived=!0,this.updatePeersPolicy()}},{key:"hasRoleDetailsArrived",value:function(){return this.roleDetailsArrived}},{key:"setConfig",value:function(e){var t,n,r;if(mi.rememberDevices(Boolean(e.rememberDeviceSelection)),e.rememberDeviceSelection){var i=mi.getSelection();i&&(e.settings||(e.settings={}),(null==(t=i.audioInput)?void 0:t.deviceId)&&(e.settings.audioInputDeviceId=e.settings.audioInputDeviceId||i.audioInput.deviceId),(null==(n=i.audioOutput)?void 0:n.deviceId)&&(e.settings.audioOutputDeviceId=e.settings.audioOutputDeviceId||i.audioOutput.deviceId),(null==(r=i.videoInput)?void 0:r.deviceId)&&(e.settings.videoDeviceId=e.settings.videoDeviceId||i.videoInput.deviceId))}this.config=e,this.setEnv()}},{key:"setPublishParams",value:function(e){this.publishParams=e}},{key:"addPeer",value:function(e){this.peers[e.peerId]=e,e.isLocal&&(this.localPeerId=e.peerId)}},{key:"addTrack",value:function(e){this.tracks[e.trackId]=e}},{key:"getTrackState",value:function(e){return this.peerTrackStates[e]}},{key:"setTrackState",value:function(e){this.peerTrackStates[e.trackInfo.track_id]=e}},{key:"removePeer",value:function(e){this.localPeerId===e&&(this.localPeerId=void 0),delete this.peers[e]}},{key:"removeTrack",value:function(e){delete this.tracks[e]}},{key:"updateSpeakers",value:function(e){this.speakers=e}},{key:"updateAudioOutputVolume",value:function(e){this.getAudioTracks().forEach((function(t){return t.setVolume(e)}))}},{key:"updateAudioOutputDevice",value:function(e){this.getAudioTracks().forEach((function(t){t.setOutputDevice(e)}))}},{key:"getSubscribeDegradationParams",value:function(){var e,t,n=null==(t=null==(e=this.getLocalPeer())?void 0:e.role)?void 0:t.subscribeParams.subscribeDegradation;if(n&&Object.keys(n).length>0)return n}},{key:"getSimulcastLayers",value:function(e){var t,n;return"screen"===e?(null==(t=this.screenshareLayers)?void 0:t.layers)||[]:(null==(n=this.videoLayers)?void 0:n.layers)||[]}},{key:"getSimulcastDimensions",value:function(e){var t="screen"===e?this.screenshareLayers:this.videoLayers;return{width:null==t?void 0:t.width,height:null==t?void 0:t.height}}},{key:"convertSimulcastLayers",value:function(e){return rn(nn({},e),{layers:(e.layers||[]).map((function(e){return rn(nn({},e),{maxBitrate:1e3*e.maxBitrate})}))})}},{key:"setVideoSimulcastLayers",value:function(e){this.videoLayers=this.convertSimulcastLayers(e)}},{key:"setScreenshareSimulcastLayers",value:function(e){this.screenshareLayers=this.convertSimulcastLayers(e)}},{key:"getSimulcastDefinitionsForPeer",value:function(e,t){var n;if(!e.role)return[];var r,i=this.getPolicyForRole(e.role.name).publishParams;"regular"===t?r=i.videoSimulcastLayers:"screen"===t&&(r=i.screenSimulcastLayers);var a=null==r?void 0:r.width,o=null==r?void 0:r.height;return(null==(n=null==r?void 0:r.layers)?void 0:n.map((function(e){return{layer:gn[e.rid],resolution:{width:a&&e.scaleResolutionDownBy?a/e.scaleResolutionDownBy:void 0,height:o&&e.scaleResolutionDownBy?o/e.scaleResolutionDownBy:void 0}}})))||[]}},{key:"cleanUp",value:function(){var e,t=k(this.getTracks());try{for(t.s();!(e=t.n()).done;){e.value.cleanup()}}catch(n){t.e(n)}finally{t.f()}this.room=void 0,this.config=void 0,this.localPeerId=void 0,this.roleDetailsArrived=!1}},{key:"setErrorListener",value:function(e){this.errorListener=e}},{key:"updatePeersPolicy",value:function(){var e=this;this.getPeers().forEach((function(t){var n;t.role?t.role=e.getPolicyForRole(t.role.name):null==(n=e.errorListener)||n.onError(Cn.InvalidRole(yn.VALIDATION,""))}))}},{key:"setEnv",value:function(){var e,t=(null==(e=this.config)?void 0:e.initEndpoint).split("https://")[1],n=zi.PROD;t.startsWith(zi.PROD)?n=zi.PROD:t.startsWith(zi.QA)?n=zi.QA:t.startsWith(zi.DEV)&&(n=zi.DEV),this.env=n,Ji.setEnv(n)}}]),e}(),Ea=function(){function e(t,n,r,i,a){var o=this;m(this,e),this.store=t,this.transport=n,this.publish=r,this.removeAuxiliaryTrack=i,this.listener=a,this.handleLocalPeerRoleUpdate=function(e){return an(o,[e],u().mark((function e(t){var n,r,i,a,o,s,c,l,d,h,f;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.oldRole,r=t.newRole,o=this.store.getLocalPeer()){e.next=4;break}return e.abrupt("return");case 4:return s=new Set(n.publishParams.allowed||[]),c=new Set(r.publishParams.allowed||[]),l=this.removeTrack(s,c,"video"),d=this.removeTrack(s,c,"audio"),h=this.removeTrack(s,c,"screen"),e.next=7,this.removeVideoTracks(l);case 7:return e.next=9,this.removeAudioTrack(d);case 9:return e.next=11,this.removeScreenTracks(h);case 11:return this.store.setPublishParams(r.publishParams),f=(null==(i=this.store.getConfig())?void 0:i.settings)||{isAudioMuted:!0,isVideoMuted:!0,audioInputDeviceId:"default",videoDeviceId:"default",audioOutputDeviceId:"default"},e.next=15,this.publish(rn(nn({},f),{isAudioMuted:!0,isVideoMuted:!0}));case 15:null==(a=this.listener)||a.onPeerUpdate(sn.ROLE_UPDATED,o);case 16:case"end":return e.stop()}}),e,this)})))}}return y(e,[{key:"removeVideoTracks",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if(r=this.store.getLocalPeer(),t.t0=null==r?void 0:r.videoTrack,!t.t0){t.next=9;break}return t.next=7,this.transport.unpublish([r.videoTrack]);case 7:null==(n=this.listener)||n.onTrackUpdate(un.TRACK_REMOVED,r.videoTrack,r),r.videoTrack=void 0;case 9:return t.next=11,this.removeAuxTracks((function(e){return"screen"!==e.source&&"video"===e.type}));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"removeAudioTrack",value:function(e){return an(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if(r=this.store.getLocalPeer(),t.t0=null==r?void 0:r.audioTrack,!t.t0){t.next=9;break}return t.next=7,this.transport.unpublish([r.audioTrack]);case 7:null==(n=this.listener)||n.onTrackUpdate(un.TRACK_REMOVED,r.audioTrack,r),r.audioTrack=void 0;case 9:return t.next=11,this.removeAuxTracks((function(e){return"screen"!==e.source&&"audio"===e.type}));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"removeScreenTracks",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!e,t.t0){t.next=4;break}return t.next=4,this.removeAuxTracks((function(e){return"screen"===e.source}));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"removeAuxTracks",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(null==(n=this.store.getLocalPeer())?void 0:n.auxiliaryTracks)){t.next=22;break}r=v(n.auxiliaryTracks),i=k(r),t.prev=4,i.s();case 6:if((a=i.n()).done){t.next=14;break}if(o=a.value,t.t0=e(o),!t.t0){t.next=12;break}return t.next=12,this.removeAuxiliaryTrack(o.trackId);case 12:t.next=6;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t.catch(4),i.e(t.t1);case 19:return t.prev=19,i.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,this,[[4,16,19,22]])})))}},{key:"removeTrack",value:function(e,t,n){return e.has(n)&&!t.has(n)}}]),e}(),xa=function(e){Ce(n,e);var t=_e(n);function n(){return m(this,n),t.apply(this,arguments)}return y(n,[{key:"on",value:function(e,t){return Te(we(n.prototype),"on",this).call(this,e,t)}},{key:"off",value:function(e,t){return Te(we(n.prototype),"off",this).call(this,e,t)}},{key:"emit",value:function(e,t){return Te(we(n.prototype),"emit",this).call(this,e,t)}},{key:"listeners",value:function(e){return Te(we(n.prototype),"listeners",this).call(this,e)}}]),n}(Qt.EventEmitter2),Ca=function(){function e(t){m(this,e),this.audioContext=new AudioContext,this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.audioContext.destination)}return y(e,[{key:"resumeContext",value:function(){"suspended"===this.audioContext.state&&(hn.d(this.TAG,"AudioContext is resumed"),this.audioContext.resume())}},{key:"getAudioTrack",value:function(){return this.destinationNode&&this.source.disconnect(this.destinationNode),this.destinationNode=this.audioContext.createMediaStreamDestination(),this.source.connect(this.destinationNode),this.destinationNode.stream.getAudioTracks()[0]}},{key:"cleanup",value:function(){"closed"!==this.audioContext.state&&this.audioContext.close()}},{key:"TAG",get:function(){return"AudioContextManager"}}]),e}(),Pa=function(e){Ce(n,e);var t=_e(n);function n(){var e;return m(this,n),(e=t.apply(this,arguments)).audioElement=null,e.seeked=!1,e}return y(n,[{key:"play",value:function(e){return an(this,null,u().mark((function t(){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(this.audioElement=this.getAudioElement(),new Promise((function(t,r){n.audioElement=n.getAudioElement(),n.audioElement.src=e,n.seeked=!1,n.audioElement.onerror=function(){var t="Error loading ".concat(e);hn.e(n.TAG,t),n.stop(),r(t)},n.audioElement.oncanplaythrough=function(){return an(n,null,u().mark((function n(){var i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,this.audioElement){n.next=3;break}return n.abrupt("return");case 3:if(this.audioContextManager.resumeContext(),!this.track){n.next=13;break}if(!this.seeked){n.next=8;break}this.seeked=!1,n.next=11;break;case 8:return n.next=10,this.audioElement.play();case 10:t([this.track]);case 11:n.next=17;break;case 13:return n.next=15,this.audioElement.play();case 15:i=this.audioContextManager.getAudioTrack(),this.track=i,t([i]);case 17:n.next=22;break;case 19:n.prev=19,n.t0=n.catch(0),hn.e(this.TAG,"Error playing audio",e,n.t0.message),r(n.t0);case 22:case"end":return n.stop()}}),n,this,[[0,19]])})))},n.audioElement.onseeked=function(){n.seeked=!0}}))));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getTracks",value:function(){return this.track?[this.track.id]:[]}},{key:"getElement",value:function(){return this.audioElement}},{key:"stop",value:function(){var e,t,n;null==(e=this.audioElement)||e.pause(),null==(t=this.audioElement)||t.removeAttribute("src"),this.audioElement=null,null==(n=this.audioContextManager)||n.cleanup(),this.track=void 0}},{key:"getAudioElement",value:function(){var e=this;if(this.audioElement)return this.audioElement;var t=document.createElement("audio");return t.crossOrigin="anonymous",t.addEventListener("timeupdate",(function(t){return e.emit("progress",t)})),t.addEventListener("ended",(function(){e.emit("ended",null)})),this.audioContextManager=new Ca(t),t}},{key:"TAG",get:function(){return"PlaylistAudioManager"}}]),n}(xa),Ra=function(e){Ce(n,e);var t=_e(n);function n(){var e;return m(this,n),(e=t.apply(this,arguments)).videoElement=null,e.canvasContext=null,e.tracks=[],e.DEFAUL_FPS=24,e.seeked=!1,e.drawImage=function(){var t,n,r;e.videoElement&&!e.videoElement.paused&&!e.videoElement.ended&&(null==(r=e.canvasContext)||r.drawImage(e.videoElement,0,0,null==(t=e.canvas)?void 0:t.width,null==(n=e.canvas)?void 0:n.height),e.timer=setTimeout((function(){e.drawImage()}),1e3/e.DEFAUL_FPS))},e}return y(n,[{key:"play",value:function(e){var t=this;return this.videoElement=this.getVideoElement(),this.createCanvas(),new Promise((function(n,r){t.videoElement=t.getVideoElement(),t.videoElement.src=e,t.seeked=!1,t.videoElement.onerror=function(){var n="Error loading ".concat(e);hn.e(t.TAG,n),t.stop(),r(n)},t.videoElement.oncanplaythrough=function(){return an(t,null,u().mark((function t(){var i,a,o,s,c,l=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,this.videoElement){t.next=3;break}return t.abrupt("return");case 3:if(this.canvas.width=this.videoElement.videoWidth,this.canvas.height=this.videoElement.videoHeight,0!==this.tracks.length){t.next=17;break}if(this.clearCanvasAndTracks(),s=this.canvas.captureStream()){t.next=9;break}return hn.e(this.TAG,"Browser does not support captureStream"),t.abrupt("return");case 9:return this.videoElement.onplay=this.drawImage,this.audioContextManager.resumeContext(),t.next=13,this.videoElement.play();case 13:c=this.audioContextManager.getAudioTrack(),s.addTrack(c),s.getTracks().forEach((function(e){l.tracks.push(e)})),n(this.tracks),t.next=24;break;case 17:if(!this.seeked){t.next=21;break}this.seeked=!1,null==(o=this.canvasContext)||o.drawImage(this.videoElement,0,0,null==(i=this.canvas)?void 0:i.width,null==(a=this.canvas)?void 0:a.height),t.next=24;break;case 21:return t.next=23,this.videoElement.play();case 23:n(this.tracks);case 24:t.next=29;break;case 26:t.prev=26,t.t0=t.catch(0),hn.e(this.TAG,"Error playing video",e,t.t0.message),r(t.t0);case 29:case"end":return t.stop()}}),t,this,[[0,26]])})))},t.videoElement.onseeked=function(){t.seeked=!0}}))}},{key:"getTracks",value:function(){return this.tracks.map((function(e){return e.id}))}},{key:"getElement",value:function(){return this.videoElement}},{key:"stop",value:function(){var e,t,n;null==(e=this.videoElement)||e.pause(),null==(t=this.videoElement)||t.removeAttribute("src"),this.videoElement=null,null==(n=this.audioContextManager)||n.cleanup(),this.clearCanvasAndTracks()}},{key:"clearCanvasAndTracks",value:function(){var e;this.tracks=[],null==(e=this.canvasContext)||e.clearRect(0,0,this.canvas.width,this.canvas.height),clearTimeout(this.timer)}},{key:"getVideoElement",value:function(){var e=this;if(this.videoElement)return this.videoElement;var t=document.createElement("video");return t.crossOrigin="anonymous",t.addEventListener("timeupdate",(function(t){return e.emit("progress",t)})),t.addEventListener("ended",(function(){e.emit("ended",null)})),this.audioContextManager=new Ca(t),t}},{key:"createCanvas",value:function(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvasContext=this.canvas.getContext("2d"))}},{key:"TAG",get:function(){return"PlaylistVideoManager"}}]),n}(xa),_a={list:[],currentIndex:-1,isAutoplayOn:!0},Ia={list:[],currentIndex:-1,isAutoplayOn:!0},Aa=function(e){Ce(n,e);var t=_e(n);function n(e,r){var i;return m(this,n),(i=t.call(this)).sdk=e,i.eventBus=r,i.state={audio:nn({},_a),video:nn({},Ia)},i.handlePausePlaylist=function(e){return an(Ee(i),[e],u().mark((function e(t){var n,r,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.enabled,r=t.track,!n){e.next=3;break}return e.abrupt("return");case 3:"audioplaylist"===r.source&&(a=vn.audio),"videoplaylist"===r.source&&(a=vn.video),a&&(null==(i=this.getElement(a))||i.pause());case 4:case"end":return e.stop()}}),e,this)})))},i.addTrack=function(e,t){return an(Ee(i),null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.sdk.addTrack(e,t);case 2:hn.d(this.TAG,"Playlist track added",e);case 3:case"end":return n.stop()}}),n,this)})))},i.removeTrack=function(e){return an(Ee(i),null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.removeTrack(e);case 2:hn.d(this.TAG,"Playlist track removed",e);case 3:case"end":return t.stop()}}),t,this)})))},i.audioManager=new Pa,i.videoManager=new Ra,i.addListeners(),i}return y(n,[{key:"getList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio;return this.state[e].list}},{key:"setList",value:function(e){var t=this;e&&0!==e.length?e.forEach((function(e){t.state[e.type].list.push(e)})):hn.w(this.TAG,"Please pass in a list of HMSPlaylistItem's")}},{key:"removeItem",value:function(e){var t=this.state[e.type].list,n=t.findIndex((function(t){return e.id===t.id}));n>-1&&t.splice(n,1)}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn.audio,n=this.state[t].currentIndex;if(-1===n)throw Rn.NoEntryToPlay(yn.PLAYLIST,"No item is currently playing");var r=this.getElement(t);if(r){var i=Math.max(r.currentTime+e,0);r.currentTime=Math.min(i,r.duration)}}},{key:"seekTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn.audio,n=this.state[t].currentIndex;if(-1===n)throw Rn.NoEntryToPlay(yn.PLAYLIST,"No item is currently playing");if(e<0)throw Error("value cannot be negative");var r=this.getElement(t);r&&(r.currentTime=Math.min(e,r.duration))}},{key:"setVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vn.audio;if(e<0||e>100)throw Error("Please pass a valid number between 0-100");var n=this.getElement(t);n&&(n.volume=.01*e)}},{key:"getVolume",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.getElement(e);return t?100*t.volume:0}},{key:"getCurrentTime",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.getElement(e);return(null==t?void 0:t.currentTime)||0}},{key:"getCurrentIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio;return this.state[e].currentIndex}},{key:"getCurrentProgress",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,n=this.state[t],r=n.list,i=n.currentIndex,a=null==(e=r[i])?void 0:e.url,o=this.getElement(t);return a&&o?Math.floor(o.currentTime/o.duration*100):0}},{key:"getCurrentSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.state[e],n=t.list,r=t.currentIndex;if(-1!==r)return n[r]}},{key:"isPlaying",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.getElement(e);return!!t&&!t.paused}},{key:"setIsAutoplayOn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=arguments.length>1?arguments[1]:void 0;this.state[e].isAutoplayOn=t}},{key:"getPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.getElement(e);return t?t.playbackRate:1}},{key:"setPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=arguments.length>1?arguments[1]:void 0;if(t<.25||t>2)throw Error("Please pass a value between 0.25 and 2.0");var n=this.getElement(e);n&&(n.playbackRate=t)}},{key:"setEnabled",value:function(e,t){return an(this,arguments,u().mark((function e(t,n){var r,i,a,o,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.id,i=n.type,a=void 0===i?vn.audio:i,o=this.state[a].list.findIndex((function(e){return e.id===r})),r&&-1!==o){e.next=5;break}return hn.w(this.TAG,"Pass a valid id"),e.abrupt("return");case 5:if(s=this.state[a].list[o].url,!t){e.next=11;break}return e.next=9,this.play(s,a);case 9:e.next=13;break;case 11:return e.next=13,this.pause(s,a);case 13:this.state[a].currentIndex=o,this.setDuration(a);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"playNext",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:vn.audio,n=this.state[t],r=n.list,!((i=n.currentIndex)>=r.length-1)){e.next=4;break}throw Rn.NoEntryToPlay(yn.PLAYLIST,"Reached end of playlist");case 4:return e.next=6,this.play(r[i+1].url,t);case 6:this.state[t].currentIndex=i+1,this.setDuration(t);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"playPrevious",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i,a=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:vn.audio,n=this.state[t],r=n.list,!((i=n.currentIndex)<=0)){e.next=4;break}throw Rn.NoEntryToPlay(yn.PLAYLIST,"Reached start of playlist");case 4:return e.next=6,this.play(r[i-1].url,t);case 6:this.state[t].currentIndex=i-1,this.setDuration(t);case 8:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:vn.audio,r=t===vn.audio?this.audioManager:this.videoManager,null==(n=r.getElement())||n.pause(),e.next=5,this.removeTracks(t);case 5:r.stop(),this.state[t].currentIndex=-1;case 7:case"end":return e.stop()}}),e,this)})))}},{key:"cleanup",value:function(){this.state={audio:nn({},_a),video:nn({},Ia)},this.eventBus.localAudioEnabled.unsubscribe(this.handlePausePlaylist),this.eventBus.localVideoEnabled.unsubscribe(this.handlePausePlaylist),this.audioManager.stop(),this.videoManager.stop()}},{key:"onProgress",value:function(e){var t=this;this.videoManager.on("progress",(function(){try{e({type:vn.video,progress:t.getCurrentProgress(vn.video)})}catch(S){hn.e(t.TAG,"Error in onProgress callback")}})),this.audioManager.on("progress",(function(){try{e({type:vn.audio,progress:t.getCurrentProgress(vn.audio)})}catch(S){hn.e(t.TAG,"Error in onProgress callback")}}))}},{key:"onNewTrackStart",value:function(e){this.on("newTrackStart",e)}},{key:"onPlaylistEnded",value:function(e){this.on("playlistEnded",e)}},{key:"onCurrentTrackEnded",value:function(e){this.on("currentTrackEnded",e)}},{key:"getElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio;return e===vn.audio?this.audioManager.getElement():this.videoManager.getElement()}},{key:"removeTracks",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i,a,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.length>0&&void 0!==o[0]?o[0]:vn.audio,n=(t===vn.audio?this.audioManager:this.videoManager).getTracks(),r=k(n),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=11;break}return a=i.value,e.next=9,this.removeTrack(a);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[3,13,16,19]])})))}},{key:"play",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c,l=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:vn.audio,r=n===vn.audio?this.audioManager:this.videoManager,i=r.getElement(),!this.isItemCurrentlyPlaying(t,n)){e.next=5;break}return hn.w(this.TAG,"The ".concat(n," is currently playing")),e.abrupt("return");case 5:if(!(null==i?void 0:i.src.includes(t))){e.next=10;break}return e.next=8,i.play();case 8:e.next=31;break;case 10:return null==i||i.pause(),e.next=13,r.play(t);case 13:a=e.sent,o=k(a),e.prev=15,o.s();case 17:if((s=o.n()).done){e.next=23;break}return c=s.value,e.next=21,this.addTrack(c,n===vn.audio?"audioplaylist":"videoplaylist");case 21:e.next=17;break;case 23:e.next=28;break;case 25:e.prev=25,e.t0=e.catch(15),o.e(e.t0);case 28:return e.prev=28,o.f(),e.finish(28);case 31:case"end":return e.stop()}}),e,this,[[15,25,28,31]])})))}},{key:"isItemCurrentlyPlaying",value:function(e,t){var n=this.getElement(t);return!(!n||n.paused||!n.src.includes(e))}},{key:"setDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vn.audio,t=this.getElement(e),n=this.state[e],r=n.list,i=n.currentIndex;r[i]&&(r[i].duration=(null==t?void 0:t.duration)||0),this.emit("newTrackStart",r[i])}},{key:"pause",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:vn.audio,(r=this.getElement(n))&&!r.paused&&r.src.includes(t)?(r.pause(),hn.d(this.TAG,"paused url",t)):hn.w(this.TAG,"The passed in url is not currently playing");case 3:case"end":return e.stop()}}),e,this)})))}},{key:"addListeners",value:function(){var e=this;this.audioManager.on("ended",(function(){return e.handleEnded(vn.audio)})),this.videoManager.on("ended",(function(){return e.handleEnded(vn.video)})),this.eventBus.localAudioEnabled.subscribe(this.handlePausePlaylist),this.eventBus.localAudioEnabled.subscribe(this.handlePausePlaylist)}},{key:"handleEnded",value:function(){return an(this,arguments,u().mark((function e(){var t,n,r,i,a,o=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:vn.audio,n=this.state[t],r=n.list,i=n.currentIndex,a=n.isAutoplayOn,i!==r.length-1){e.next=8;break}return e.next=5,this.stop(t);case 5:this.emit("playlistEnded",t),e.next=14;break;case 8:if(!a){e.next=12;break}this.playNext(t),e.next=14;break;case 12:return e.next=14,this.pause(r[i].url,t);case 14:this.emit("currentTrackEnded",r[i]);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"TAG",get:function(){return"PlaylistManager"}}]),n}(xa),Da=y((function e(t,n){var r=this;m(this,e),this.eventName=t,this.eventEmitter=n,this.publish=function(e){r.eventEmitter.emit(r.eventName,e)},this.subscribe=function(e){r.eventEmitter.on(r.eventName,e)},this.subscribeOnce=function(e){r.eventEmitter.once(r.eventName,e)},this.unsubscribe=function(e){r.eventEmitter.off(r.eventName,e)},this.waitFor=function(e){return r.eventEmitter.waitFor(r.eventName,{filter:e})},this.removeAllListeners=function(){r.eventEmitter.removeAllListeners(r.eventName)}})),Na=y((function e(){m(this,e),this.eventEmitter=new Qt.EventEmitter2,this.deviceChange=new Da(Vn,this.eventEmitter),this.localAudioEnabled=new Da(Gn,this.eventEmitter),this.localVideoEnabled=new Da(zn,this.eventEmitter),this.statsUpdate=new Da(Hn,this.eventEmitter),this.trackDegraded=new Da(Kn,this.eventEmitter),this.trackRestored=new Da(Wn,this.eventEmitter),this.trackAudioLevelUpdate=new Da(qn,this.eventEmitter),this.audioPluginFailed=new Da($n,this.eventEmitter),this.localAudioSilence=new Da(Qn,this.eventEmitter),this.analytics=new Da(Jn,this.eventEmitter),this.policyChange=new Da(Yn,this.eventEmitter),this.localRoleUpdate=new Da(Xn,this.eventEmitter),this.audioTrackUpdate=new Da(Zn,this.eventEmitter),this.audioTrackAdded=new Da(er,this.eventEmitter),this.audioTrackRemoved=new Da(tr,this.eventEmitter),this.autoplayError=new Da(nr,this.eventEmitter)})),Oa=y((function e(t,n){var r=this;m(this,e),this.eventBus=t,this.listener=n,this.TAG="NetworkTestManager",this.controller=new AbortController,this.start=function(e){return an(r,null,u().mark((function t(){var n,r,i,a,o,s,c,l,d,h,f,p,v=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return a=e.url,o=e.timeout,s=e.scoreMap,c=this.controller.signal,l=Date.now(),d=0,h=ti(o).then((function(){v.controller.abort()})),t.prev=3,t.next=6,fetch("".concat(a,"?").concat(Date.now()),{signal:c});case 6:if(t.t0=n=t.sent.body,null!=t.t0){t.next=11;break}t.t1=void 0,t.next=12;break;case 11:t.t1=n.getReader();case 12:if(f=t.t1){t.next=15;break}throw Error("unable to process request");case 15:return p=function(){return an(v,null,u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=17;break}e.prev=1,t=!1;case 3:if(t){e.next=12;break}return e.next=6,f.read();case 6:n=e.sent,r=n.value,i=n.done,t=i,r&&(d+=r.byteLength,this.sendScore({scoreMap:s,downloadedSize:d,startTime:l}));case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),hn.e(this.TAG,e.t0);case 17:case"end":return e.stop()}}),e,this,[[1,14]])})))},t.abrupt("return",Promise.race([p(),h]).then((function(){v.sendScore({scoreMap:s,downloadedSize:d,startTime:l,finished:!0})})).catch((function(e){var t,n;hn.e(v.TAG,e),null==(n=null==(t=v.listener)?void 0:t.onNetworkQuality)||n.call(t,0),v.eventBus.analytics.publish(Pi.previewNetworkQuality({error:e.message}))})));case 19:t.prev=19,t.t2=t.catch(3),hn.e(this.TAG,t.t2),"AbortError"!==t.t2.name&&(null==(i=null==(r=this.listener)?void 0:r.onNetworkQuality)||i.call(r,0),this.eventBus.analytics.publish(Pi.previewNetworkQuality({error:t.t2.message})));case 22:case"end":return t.stop()}}),t,this,[[3,19]])})))},this.stop=function(){r.controller.signal.aborted||r.controller.abort()},this.sendScore=function(e){var t,n,i=e.scoreMap,a=e.downloadedSize,o=e.startTime,s=e.finished,u=void 0!==s&&s,c=a/1024/((Date.now()-o)/1e3)*8,l=-1;for(var d in i){var h=i[d];c>=h.low&&(!h.high||c<=h.high)&&(l=Number(d))}null==(n=null==(t=r.listener)?void 0:t.onNetworkQuality)||n.call(t,l),u&&r.eventBus.analytics.publish(Pi.previewNetworkQuality({score:l,downLink:c.toFixed(2)}))}})),La={isAudioMuted:!1,isVideoMuted:!1,audioInputDeviceId:"default",audioOutputDeviceId:"default",videoDeviceId:"default"},Ma={published:!1,isInitialised:!1,isReconnecting:!1,isPreviewInProgress:!1,deviceManagersInitialised:!1},Ua=function(){function e(){var t=this;m(this,e),this.TAG="[HMSSdk]:",this.transportState=Oi.Disconnected,this.sdkState=nn({},Ma),this.handleAutoplayError=function(e){var n,r;null==(r=null==(n=t.errorListener)?void 0:n.onError)||r.call(n,e)},this.observer={onNotification:function(e){e.method!==Pr.PEER_LEAVE_REQUEST?t.notificationManager.handleNotification(e,t.sdkState.isReconnecting):t.handlePeerLeaveRequest(e.params)},onTrackAdd:function(e){t.notificationManager.handleTrackAdd(e)},onTrackRemove:function(e){t.notificationManager.handleTrackRemove(e)},onTrackDegrade:function(e){var n,r;hn.d(t.TAG,"Sending Track Update Track Degraded",e),null==(r=t.listener)||r.onTrackUpdate(un.TRACK_DEGRADED,e,null==(n=t.store)?void 0:n.getPeerByTrackId(e.trackId))},onTrackRestore:function(e){var n,r;hn.d(t.TAG,"Sending Track Update Track Restored",e),null==(r=t.listener)||r.onTrackUpdate(un.TRACK_RESTORED,e,null==(n=t.store)?void 0:n.getPeerByTrackId(e.trackId))},onFailure:function(e){var n;null==(n=t.errorListener)||n.onError(e)},onStateChange:function(e,n){return an(t,null,u().mark((function t(){var r,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next=t.t0===Oi.Preview||t.t0===Oi.Joined?3:t.t0===Oi.Failed?5:t.t0===Oi.Reconnecting?10:12;break;case 3:return this.transportState===Oi.Reconnecting&&(null==(r=this.listener)||r.onReconnected()),t.abrupt("break",12);case 5:return t.next=7,this.leave();case 7:return null==(a=null==(i=this.errorListener)?void 0:i.onError)||a.call(i,n),this.sdkState.isReconnecting=!1,t.abrupt("break",12);case 10:return this.sdkState.isReconnecting=!0,null==(o=this.listener)||o.onReconnecting(n),t.abrupt("break",12);case 12:this.transportState=e,hn.d(this.TAG,"Transport State Change",this.transportState);case 13:case"end":return t.stop()}}),t,this)})))}},this.handlePeerLeaveRequest=function(e){var n,r=e.requested_by?t.store.getPeerById(e.requested_by):void 0,i={roomEnded:e.room_end,reason:e.reason,requestedBy:r};null==(n=t.listener)||n.onRemovedFromRoom(i),t.leave()},this.handleDeviceChange=function(e){var n,r,i,a,o,s;if(hn.d(t.TAG,"Device Change event",e),null==(r=null==(n=t.deviceChangeListener)?void 0:n.onDeviceChange)||r.call(n,e),e.error&&e.type){var u=e.type.includes("audio")?null==(i=t.localPeer)?void 0:i.audioTrack:null==(a=t.localPeer)?void 0:a.videoTrack;null==(o=t.errorListener)||o.onError(e.error),[kn.TracksErrors.CANT_ACCESS_CAPTURE_DEVICE,kn.TracksErrors.DEVICE_IN_USE,kn.TracksErrors.DEVICE_NOT_AVAILABLE].includes(e.error.code)&&u&&(u.setEnabled(!1),null==(s=t.listener)||s.onTrackUpdate(un.TRACK_MUTED,u,t.localPeer))}},this.handleAudioPluginError=function(e){var n;hn.e(t.TAG,"Audio Plugin Error event",e),null==(n=t.errorListener)||n.onError(e)},this.getScreenshareSettings=function(e){var n=t.store.getPublishParams().screen,r=t.store.getSimulcastDimensions("screen");return{video:(new Dr).maxBitrate(n.bitRate,!1).codec(n.codec).maxFramerate(n.frameRate).setWidth((null==r?void 0:r.width)||n.width).setHeight((null==r?void 0:r.height)||n.height).build(),audio:e?void 0:(new Ir).build()}},this.sendAudioPresenceFailed=function(){var e=Tn.NoAudioDetected(yn.PREVIEW);t.sendAnalyticsEvent(Pi.audioDetectionFail(e,t.deviceManager.getCurrentSelection().audioInput))},this.sendAnalyticsEvent=function(e){t.analyticsEventsService.queue(e).flush()}}return y(e,[{key:"initStoreAndManagers",value:function(){if(this.sdkState.isInitialised)return this.notificationManager.setListener(this.listener),void this.audioSinkManager.setListener(this.listener);this.sdkState.isInitialised=!0,this.store=new Ta,this.eventBus=new Na,this.networkTestManager=new Oa(this.eventBus,this.listener),this.playlistManager=new Aa(this,this.eventBus),this.notificationManager=new Fi(this.store,this.eventBus,this.listener,this.audioListener),this.deviceManager=new ya(this.store,this.eventBus),this.audioSinkManager=new ga(this.store,this.deviceManager,this.eventBus),this.audioOutput=new ka(this.deviceManager,this.audioSinkManager),this.audioSinkManager.setListener(this.listener),this.eventBus.autoplayError.subscribe(this.handleAutoplayError),this.localTrackManager=new Di(this.store,this.observer,this.deviceManager,this.eventBus),this.analyticsEventsService=new wa(this.store),this.transport=new fa(this.observer,this.deviceManager,this.store,this.localTrackManager,this.eventBus,this.analyticsEventsService),this.eventBus.analytics.subscribe(this.sendAnalyticsEvent),this.eventBus.deviceChange.subscribe(this.handleDeviceChange),this.eventBus.audioPluginFailed.subscribe(this.handleAudioPluginError)}},{key:"validateJoined",value:function(e){if(!this.localPeer)throw Cn.NotConnected(yn.VALIDATION,"Not connected - ".concat(e))}},{key:"refreshDevices",value:function(){return an(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateJoined("refreshDevices"),e.next=3,this.deviceManager.init(!0);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getWebrtcInternals",value:function(){var e;return null==(e=this.transport)?void 0:e.getWebrtcInternals()}},{key:"getPlaylistManager",value:function(){return this.playlistManager}},{key:"getRecordingState",value:function(){var e;return null==(e=this.store.getRoom())?void 0:e.recording}},{key:"getRTMPState",value:function(){var e;return null==(e=this.store.getRoom())?void 0:e.rtmp}},{key:"getHLSState",value:function(){var e;return null==(e=this.store.getRoom())?void 0:e.hls}},{key:"localPeer",get:function(){var e;return null==(e=this.store)?void 0:e.getLocalPeer()}},{key:"preview",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a,o=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Dn(),An(),!this.sdkState.isPreviewInProgress){n.next=2;break}return n.abrupt("return",Promise.reject(Cn.PreviewAlreadyInProgress(yn.PREVIEW,"Preview already called")));case 2:return this.setUpPreview(e,t),e.alwaysRequestPermissions&&this.localTrackManager.requestPermissions().then((function(){return an(o,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initDeviceManagers();case 2:case"end":return e.stop()}}),e,this)})))})),r=!1,i=!1,a=setTimeout((function(){var e,t;(!r||!i)&&(null==(t=null==(e=o.listener)?void 0:e.onNetworkQuality)||t.call(e,-1))}),3e3),n.abrupt("return",new Promise((function(n,s){o.eventBus.policyChange.subscribeOnce((function(){return an(o,null,u().mark((function r(){var i,a,o=this;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.localTrackManager.getTracksToPublish(e.settings||La);case 2:return(a=r.sent).forEach((function(e){return o.setLocalPeerTrack(e)})),(null==(i=this.localPeer)?void 0:i.audioTrack)&&this.initPreviewTrackAudioLevelMonitor(),r.next=7,this.initDeviceManagers();case 7:this.sdkState.isPreviewInProgress=!1,t.onPreview(this.store.getRoom(),a),n();case 10:case"end":return r.stop()}}),r,this)})))})),o.transport.preview(e.authToken,e.initEndpoint,o.localPeer.peerId,{name:e.userName,metaData:e.metaData||""},e.autoVideoSubscribe).then((function(t){var n;r=!0,clearTimeout(a),t&&e.captureNetworkQualityInPreview&&o.networkTestManager.start(null==(n=t.config)?void 0:n.networkHealth).then((function(){i=!0}))})).catch((function(e){var t;null==(t=o.errorListener)||t.onError(e),o.sdkState.isPreviewInProgress=!1,s(e)}))})));case 5:case"end":return n.stop()}}),n,this)})))}},{key:"join",value:function(e,t){var n,r,i,a=this;if(Dn(),An(),this.sdkState.isPreviewInProgress)throw Cn.NotReady(yn.JOIN,"Preview is in progress, can't join");var o=pa(e.authToken),s=o.roomId,c=o.userId,l=o.role;null==(n=this.networkTestManager)||n.stop(),null==(i=null==(r=this.localPeer)?void 0:r.audioTrack)||i.destroyAudioLevelMonitor(),this.listener=t,this.commonSetup(e,s,t),this.removeDevicesFromConfig(e),this.store.setConfig(e),this.localPeer?(this.localPeer.name=e.userName,this.localPeer.role=this.store.getPolicyForRole(l),this.localPeer.customerUserId=c,this.localPeer.metadata=e.metaData||""):this.createAndAddLocalPeerToStore(e,l,c),this.roleChangeManager=new Ea(this.store,this.transport,this.publish.bind(this),this.removeTrack.bind(this),this.listener),this.eventBus.localRoleUpdate.subscribe(this.roleChangeManager.handleLocalPeerRoleUpdate),hn.d(this.TAG,"SDK Store",this.store),hn.d(this.TAG,"\u23f3 Joining room ".concat(s)),hn.time("join-room-".concat(s)),this.transport.join(e.authToken,this.localPeer.peerId,{name:e.userName,metaData:e.metaData||""},e.initEndpoint,e.autoVideoSubscribe).then((function(){return an(a,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(hn.d(this.TAG,"\u2705 Joined room ".concat(s)),_i.resumeContext(),this.notifyJoin(),t.t0=this.store.getPublishParams()&&!this.sdkState.published&&!yr,!t.t0){t.next=7;break}return t.next=7,this.publish(e.settings||La);case 7:case"end":return t.stop()}}),t,this)})))})).catch((function(e){var t;null==(t=a.listener)||t.onError(e),hn.e(a.TAG,"Unable to join room",e)})).then((function(){hn.timeEnd("join-room-".concat(s))}))}},{key:"stringifyMetadata",value:function(e){e.metaData&&"string"!=typeof e.metaData&&JSON.stringify(e.metaData)}},{key:"cleanUp",value:function(){var e,t;this.store.cleanUp(),this.cleanDeviceManagers(),this.eventBus.analytics.unsubscribe(this.sendAnalyticsEvent),mi.cleanup(),this.playlistManager.cleanup(),hn.cleanUp(),this.sdkState=nn({},Ma),this.localPeer&&(null==(e=this.localPeer.audioTrack)||e.cleanup(),this.localPeer.audioTrack=void 0,null==(t=this.localPeer.videoTrack)||t.cleanup(),this.localPeer.videoTrack=void 0),this.listener=void 0,this.roleChangeManager&&this.eventBus.localRoleUpdate.unsubscribe(this.roleChangeManager.handleLocalPeerRoleUpdate)}},{key:"leave",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this.store.getRoom())){e.next=9;break}return i=r.id,null==(t=this.networkTestManager)||t.stop(),hn.d(this.TAG,"\u23f3 Leaving room ".concat(i)),e.next=7,null==(n=this.transport)?void 0:n.leave();case 7:this.cleanUp(),hn.d(this.TAG,"\u2705 Left room ".concat(i));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"getLocalPeer",value:function(){return this.store.getLocalPeer()}},{key:"getPeers",value:function(){var e=this.store.getPeers();return hn.d(this.TAG,"Got peers",e),e}},{key:"getAudioOutput",value:function(){return this.audioOutput}},{key:"sendMessage",value:function(e,t){this.sendMessageInternal({message:t,type:e})}},{key:"sendBroadcastMessage",value:function(e,t){return an(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.sendMessageInternal({message:e,type:t});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"sendGroupMessage",value:function(e,t,n){return an(this,null,u().mark((function r(){var i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.store.getKnownRoles(),0!==(t.filter((function(e){return i[e.name]}))||[]).length){r.next=3;break}throw Cn.ValidationFailed("No valid role is present",t);case 3:return r.next=5,this.sendMessageInternal({message:e,recipientRoles:t,type:n});case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"sendDirectMessage",value:function(e,t,n){return an(this,null,u().mark((function r(){var i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.store.getPeerById(t.peerId)){r.next=2;break}throw Cn.ValidationFailed("Invalid peer - peer not present in the room",t);case 2:if((null==(i=this.localPeer)?void 0:i.peerId)!==t.peerId){r.next=4;break}throw Cn.ValidationFailed("Cannot send message to self");case 4:return r.next=6,this.sendMessageInternal({message:e,recipientPeer:t,type:n});case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r,this)})))}},{key:"sendMessageInternal",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.recipientRoles,r=t.recipientPeer,i=t.type,a=void 0===i?"chat":i,""!==(o=t.message).replace(/\u200b/g," ").trim()){e.next=3;break}throw hn.w(this.TAG,"sendMessage","Ignoring empty message send"),Cn.ValidationFailed("Empty message not allowed");case 3:return s=new Ur({sender:this.localPeer,type:a,message:o,recipientPeer:r,recipientRoles:n,time:new Date}),hn.d(this.TAG,"Sending Message: ",s),e.next=7,this.transport.sendMessage(s);case 7:return c=e.sent,e.abrupt("return",(s.time=new Date(c.timestamp),s));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"startScreenShare",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c,l=this,d=arguments;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:{audioOnly:!1,videoOnly:!1},o=this.store.getPublishParams()){e.next=4;break}return e.abrupt("return");case 4:if((s=o.allowed)&&s.includes("screen")){e.next=8;break}return hn.e(this.TAG,"Role ".concat(null==(r=this.localPeer)?void 0:r.role," cannot share screen")),e.abrupt("return");case 8:if(!(null==(a=null==(i=this.localPeer)?void 0:i.auxiliaryTracks)?void 0:a.find((function(e){return"screen"===e.source})))){e.next=10;break}throw Error("Cannot share multiple screens");case 10:return e.next=12,this.getScreenshareTracks(t,n);case 12:if(c=e.sent,this.localPeer){e.next=16;break}return hn.d(this.TAG,"Screenshared when not connected"),c.forEach((function(e){e.cleanup()})),e.abrupt("return");case 16:return e.next=18,this.transport.publish(c);case 18:c.forEach((function(e){var t,n,r;e.peerId=null==(t=l.localPeer)?void 0:t.peerId,null==(n=l.localPeer)||n.auxiliaryTracks.push(e),null==(r=l.listener)||r.onTrackUpdate(un.TRACK_ADDED,e,l.localPeer)}));case 19:case"end":return e.stop()}}),e,this)})))}},{key:"stopEndedScreenshare",value:function(e){return an(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return hn.d(this.TAG,"\u2705 Screenshare ended natively"),t.next=3,this.stopScreenShare();case 3:e();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"stopScreenShare",value:function(){return an(this,null,u().mark((function e(){var t,n,r,i,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(hn.d(this.TAG,"\u2705 Screenshare ended from app"),!(n=null==(t=this.localPeer)?void 0:t.auxiliaryTracks.filter((function(e){return"screen"===e.source})))){e.next=20;break}r=k(n),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=12;break}return a=i.value,e.next=10,this.removeTrack(a.trackId);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})))}},{key:"addTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regular";return an(this,null,u().mark((function n(){var r,i,a,o,s,c,l,d;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=3;break}return hn.w(this.TAG,"Please pass a valid MediaStreamTrack"),n.abrupt("return");case 3:if(this.localPeer){n.next=5;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot addTrack");case 5:if(!this.localPeer.auxiliaryTracks.find((function(t){return t.trackId===e.id}))){n.next=7;break}return n.abrupt("return");case 7:return s=e.kind,c=new MediaStream([e]),l=new Ci(c),d=new("audio"===s?ki:Li)(l,e,t,this.eventBus),this.setPlaylistSettings({track:e,hmsTrack:d,source:t}),n.next=11,null==(r=this.transport)?void 0:r.publish([d]);case 11:d.peerId=null==(i=this.localPeer)?void 0:i.peerId,null==(a=this.localPeer)||a.auxiliaryTracks.push(d),null==(o=this.listener)||o.onTrackUpdate(un.TRACK_ADDED,d,this.localPeer);case 14:case"end":return n.stop()}}),n,this)})))}},{key:"removeTrack",value:function(e){return an(this,null,u().mark((function t(){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.localPeer){t.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot removeTrack");case 2:if(r=this.localPeer.auxiliaryTracks.findIndex((function(t){return t.trackId===e})),!(r>-1)){t.next=12;break}return i=this.localPeer.auxiliaryTracks[r],t.next=7,this.transport.unpublish([i]);case 7:"audioplaylist"===i.source?this.playlistManager.stop(vn.audio):"videoplaylist"===i.source&&this.playlistManager.stop(vn.video),this.localPeer.auxiliaryTracks.splice(r,1),null==(n=this.listener)||n.onTrackUpdate(un.TRACK_REMOVED,i,this.localPeer),t.next=13;break;case 12:hn.w(this.TAG,"No track found for ".concat(e));case 13:case"end":return t.stop()}}),t,this)})))}},{key:"setAnalyticsLevel",value:function(e){this.analyticsEventsService.level=e}},{key:"setLogLevel",value:function(e){hn.level=e}},{key:"addAudioListener",value:function(e){this.audioListener=e,this.notificationManager.setAudioListener(e)}},{key:"addConnectionQualityListener",value:function(e){this.notificationManager.setConnectionQualityListener(e)}},{key:"changeRole",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return an(this,null,u().mark((function r(){var i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=!e.role||e.role.name===t,r.t0){r.next=4;break}return r.next=4,null==(i=this.transport)?void 0:i.changeRole(e,t,n);case 4:case"end":return r.stop()}}),r,this)})))}},{key:"acceptChangeRole",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==(n=this.transport)?void 0:n.acceptRoleChange(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"endRoom",value:function(e,t){return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.localPeer){n.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot end room");case 2:return n.next=4,null==(r=this.transport)?void 0:r.endRoom(e,t);case 4:return n.next=6,this.leave();case 6:case"end":return n.stop()}}),n,this)})))}},{key:"removePeer",value:function(e,t){return an(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.localPeer){n.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot remove peer");case 2:if(this.store.getPeerById(e.peerId)){n.next=4;break}throw Cn.ValidationFailed("Invalid peer, given peer not present in room",e);case 4:return n.next=6,null==(r=this.transport)?void 0:r.removePeer(e.peerId,t);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"startRTMPOrRecording",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.localPeer){t.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot start streaming or recording");case 2:return t.next=4,null==(n=this.transport)?void 0:n.startRTMPOrRecording(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"stopRTMPAndRecording",value:function(){return an(this,null,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.localPeer){e.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot stop streaming or recording");case 2:return e.next=4,null==(t=this.transport)?void 0:t.stopRTMPOrRecording();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"startHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.localPeer){t.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot start HLS streaming");case 2:return t.next=4,null==(n=this.transport)?void 0:n.startHLSStreaming(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"stopHLSStreaming",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.localPeer){t.next=2;break}throw Cn.NotConnected(yn.VALIDATION,"No local peer present, cannot stop HLS streaming");case 2:return t.next=4,null==(n=this.transport)?void 0:n.stopHLSStreaming(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"changeName",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.validateJoined("changeName"),t.next=3,null==(n=this.transport)?void 0:n.changeName(e);case 3:this.notificationManager.updateLocalPeer({name:e});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"changeMetadata",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.validateJoined("changeMetadata"),t.next=3,null==(n=this.transport)?void 0:n.changeMetadata(e);case 3:this.notificationManager.updateLocalPeer({metadata:e});case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getRoles",value:function(){return Object.values(this.store.getKnownRoles())}},{key:"changeTrackState",value:function(e,t){return an(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.type!==Ln.VIDEO||"regular"===e.source){n.next=3;break}return hn.w(this.TAG,"Muting non-regular video tracks is currently not supported"),n.abrupt("return");case 3:if(e.enabled!==t){n.next=6;break}return hn.w(this.TAG,"Aborting change track state, track already has enabled - ".concat(t),e),n.abrupt("return");case 6:if(this.store.getTrackById(e.trackId)){n.next=8;break}throw Cn.ValidationFailed("No track found for change track state",e);case 8:if(i=this.store.getPeerByTrackId(e.trackId)){n.next=11;break}throw Cn.ValidationFailed("No peer found for change track state",e);case 11:return n.next=13,null==(r=this.transport)?void 0:r.changeTrackState({requested_for:i.peerId,track_id:e.trackId,stream_id:e.stream.id,mute:!t});case 13:case"end":return n.stop()}}),n,this)})))}},{key:"changeMultiTrackState",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("boolean"==typeof e.enabled){t.next=2;break}throw Cn.ValidationFailed("Pass a boolean for enabled");case 2:return r=e.enabled,i=e.roles,a=e.type,o=e.source,t.next=5,null==(n=this.transport)?void 0:n.changeMultiTrackState({value:!r,type:a,source:o,roles:null==i?void 0:i.map((function(e){return null==e?void 0:e.name}))});case 5:case"end":return t.stop()}}),t,this)})))}},{key:"publish",value:function(e){return an(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.localTrackManager.getTracksToPublish(e);case 2:return n=t.sent,t.next=5,this.setAndPublishTracks(n);case 5:this.sdkState.published=!0;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"setAndPublishTracks",value:function(e){return an(this,null,u().mark((function t(){var n,r,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=k(e),t.prev=1,r.s();case 3:if((i=r.n()).done){t.next=11;break}return a=i.value,t.next=7,this.transport.publish([a]);case 7:this.setLocalPeerTrack(a),null==(n=this.listener)||n.onTrackUpdate(un.TRACK_ADDED,a,this.localPeer);case 9:t.next=3;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),r.e(t.t0);case 16:return t.prev=16,r.f(),t.finish(16);case 19:return t.next=21,this.initDeviceManagers();case 21:case"end":return t.stop()}}),t,this,[[1,13,16,19]])})))}},{key:"setLocalPeerTrack",value:function(e){var t;switch(e.peerId=null==(t=this.localPeer)?void 0:t.peerId,e.type){case Ln.AUDIO:this.localPeer.audioTrack=e;break;case Ln.VIDEO:this.localPeer.videoTrack=e}}},{key:"initDeviceManagers",value:function(){return an(this,null,u().mark((function e(){var t,n,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.sdkState.deviceManagersInitialised,e.t0){e.next=7;break}return this.sdkState.deviceManagersInitialised=!0,e.next=5,this.deviceManager.init();case 5:this.deviceManager.updateOutputDevice(null==(n=null==(t=mi.getSelection())?void 0:t.audioOutput)?void 0:n.deviceId),this.audioSinkManager.init(null==(r=this.store.getConfig())?void 0:r.audioSinkElementId);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"cleanDeviceManagers",value:function(){this.eventBus.deviceChange.unsubscribe(this.handleDeviceChange),this.eventBus.audioPluginFailed.unsubscribe(this.handleAudioPluginError),this.eventBus.autoplayError.unsubscribe(this.handleAutoplayError),this.deviceManager.cleanUp(),this.audioSinkManager.cleanUp()}},{key:"initPreviewTrackAudioLevelMonitor",value:function(){var e,t=this,n=null==(e=this.localPeer)?void 0:e.audioTrack;null==n||n.initAudioLevelMonitor(),this.eventBus.trackAudioLevelUpdate.subscribe((function(e){var r,i=e&&e.track.trackId===(null==n?void 0:n.trackId)?[{audioLevel:e.audioLevel,peer:t.localPeer,track:n}]:[];t.store.updateSpeakers(i),null==(r=t.audioListener)||r.onAudioLevelUpdate(i)})),this.eventBus.localAudioSilence.subscribe(this.sendAudioPresenceFailed)}},{key:"notifyJoin",value:function(){var e,t=this,n=this.store.getLocalPeer(),r=this.store.getRoom();r.joinedAt=new Date,n&&(n.joinedAt=r.joinedAt),(null==n?void 0:n.role)?null==(e=this.listener)||e.onJoin(r):this.eventBus.policyChange.subscribeOnce((function(){var e;null==(e=t.listener)||e.onJoin(r)}))}},{key:"setUpPreview",value:function(e,t){this.listener=t,this.sdkState.isPreviewInProgress=!0;var n=pa(e.authToken),r=n.roomId,i=n.userId,a=n.role;this.commonSetup(e,r,t),this.store.setConfig(e),this.createAndAddLocalPeerToStore(e,a,i),hn.d(this.TAG,"SDK Store",this.store)}},{key:"setPlaylistSettings",value:function(e){return an(this,arguments,u().mark((function e(t){var n,r,i,a,o,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.hmsTrack,"videoplaylist"!==(i=t.source)){e.next=8;break}return a={},"audio"===n.kind?a.maxBitrate=64:(a.maxBitrate=1e3,o=n.getSettings(),s=o.width,c=o.height,a.width=s,a.height=c),e.next=6,r.setSettings(a);case 6:e.next=12;break;case 8:if(e.t0="audioplaylist"===i,!e.t0){e.next=12;break}return e.next=12,r.setSettings({maxBitrate:64});case 12:case"end":return e.stop()}}),e)})))}},{key:"createAndAddLocalPeerToStore",value:function(e,t,n){var r=this.store.getPolicyForRole(t),i=new Vr({name:e.userName||"",customerUserId:n,metadata:e.metaData||"",role:r});this.store.addPeer(i)}},{key:"commonSetup",value:function(e,t,n){this.stringifyMetadata(e),e.initEndpoint||(e.initEndpoint="https://prod-init.100ms.live"),this.errorListener=n,this.deviceChangeListener=n,this.initStoreAndManagers(),this.store.setErrorListener(this.errorListener),this.store.getRoom()||this.store.setRoom(new va(t,this.store))}},{key:"removeDevicesFromConfig",value:function(e){this.store.getConfig()&&e.settings&&(delete e.settings.audioOutputDeviceId,delete e.settings.videoDeviceId,delete e.settings.audioInputDeviceId)}},{key:"getScreenshareTracks",value:function(e,t){return an(this,null,u().mark((function n(){var r,i,a,o,s,c,l,d,h,p=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.getScreenshareSettings(t.videoOnly),i=r.video,a=r.audio,n.next=5,this.transport.getLocalScreen(i,a);case 5:if(o=n.sent,s=f(o,2),c=s[0],l=s[1],d=function(){p.stopEndedScreenshare(e)},h=[],!t.audioOnly){n.next=17;break}if(c.nativeTrack.stop(),l){n.next=14;break}throw Error("Select share audio when sharing screen");case 14:h.push(l),l.nativeTrack.onended=d,n.next=18;break;case 17:h.push(c),c.nativeTrack.onended=d,l&&h.push(l);case 18:return n.abrupt("return",h);case 19:case"end":return n.stop()}}),n,this)})))}}]),e}();function Fa(e,t){return e===t}function ja(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var r=t.length,i=0;i<r;i++)if(!e(t[i],n[i]))return!1;return!0}function Ba(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"===typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}hn.i("adapter","".concat(Lt.browserDetails.browser," v").concat(Lt.browserDetails.version));var Va,Ga,za,Ha=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=0,o=r.pop(),s=Ba(r),u=e.apply(void 0,[function(){return a++,o.apply(null,arguments)}].concat(n)),c=e((function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return u.apply(null,e)}));return c.resultFunc=o,c.dependencies=s,c.recomputations=function(){return a},c.resetRecomputations=function(){return a=0},c}}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fa,n=null,r=null;return function(){return ja(t,n,arguments)||(r=e.apply(null,arguments)),n=arguments,r}}));var Ka,Wa=Object.defineProperty,qa=Object.defineProperties,Qa=Object.getOwnPropertyDescriptors,Ja=Object.getOwnPropertySymbols,$a=Object.prototype.hasOwnProperty,Ya=Object.prototype.propertyIsEnumerable,Xa=function(e,t,n){return t in e?Wa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},Za=function(e,t){for(var n in t||(t={}))$a.call(t,n)&&Xa(e,n,t[n]);if(Ja){var r,i=k(Ja(t));try{for(i.s();!(r=i.n()).done;){n=r.value;Ya.call(t,n)&&Xa(e,n,t[n])}}catch(a){i.e(a)}finally{i.f()}}return e},eo=function(e,t){return qa(e,Qa(t))},to=function(e,t,n){return new Promise((function(r,i){var a=function(e){try{s(n.next(e))}catch(z){i(z)}},o=function(e){try{s(n.throw(e))}catch(z){i(z)}},s=function(e){return e.done?r(e.value):Promise.resolve(e.value).then(a,o)};s((n=n.apply(e,t)).next())}))};!function(e){e.Disconnected="Disconnected",e.Preview="Preview",e.Connecting="Connecting",e.Connected="Connected",e.Reconnecting="Reconnecting",e.Disconnecting="Disconnecting",e.Failed="Failed"}(Ka||(Ka={}));var no,ro,io,ao,oo=function(){return{room:{id:"",isConnected:!1,name:"",peers:[],shareableLink:"",localPeer:"",hasWaitingRoom:!1,roomState:Ka.Disconnected,recording:{browser:{running:!1},server:{running:!1},hls:{running:!1}},rtmp:{running:!1},hls:{running:!1,variants:[]},sessionId:""},peers:{},tracks:{},playlist:{audio:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1},video:{list:{},selection:{id:"",hasPrevious:!1,hasNext:!1},progress:0,volume:0,currentTime:0,playbackRate:1}},messages:{byID:{},allIDs:[]},speakers:{},connectionQualities:{},settings:{audioInputDeviceId:"",audioOutputDeviceId:"",videoInputDeviceId:""},devices:{audioInput:[],audioOutput:[],videoInput:[]},roles:{},roleChangeRequests:[],errors:[]}},so=function(){return{peerStats:{},trackStats:{},localPeer:{id:""}}};!function(e){e.CHAT="chat"}(no||(no={})),function(e){e.INFO="info",e.ERROR="error",e.CRITICAL="critical"}(ro||(ro={})),function(e){e.PEER_JOINED="PEER_JOINED",e.PEER_LEFT="PEER_LEFT",e.PEER_LIST="PEER_LIST",e.NEW_MESSAGE="NEW_MESSAGE",e.ERROR="ERROR",e.RECONNECTING="RECONNECTING",e.RECONNECTED="RECONNECTED",e.TRACK_ADDED="TRACK_ADDED",e.TRACK_REMOVED="TRACK_REMOVED",e.TRACK_MUTED="TRACK_MUTED",e.TRACK_UNMUTED="TRACK_UNMUTED",e.TRACK_DEGRADED="TRACK_DEGRADED",e.TRACK_RESTORED="TRACK_RESTORED",e.ROLE_CHANGE_REQUEST="ROLE_CHANGE_REQUEST",e.ROLE_UPDATED="ROLE_UPDATED",e.CHANGE_TRACK_STATE_REQUEST="CHANGE_TRACK_STATE_REQUEST",e.CHANGE_MULTI_TRACK_STATE_REQUEST="CHANGE_MULTI_TRACK_STATE_REQUEST",e.ROOM_ENDED="ROOM_ENDED",e.REMOVED_FROM_ROOM="REMOVED_FROM_ROOM",e.DEVICE_CHANGE_UPDATE="DEVICE_CHANGE_UPDATE",e.PLAYLIST_TRACK_ENDED="PLAYLIST_TRACK_ENDED",e.NAME_UPDATED="NAME_UPDATED",e.METADATA_UPDATED="METADATA_UPDATED"}(io||(io={})),function(e){e.audio="audio",e.video="video"}(ao||(ao={}));var uo=function(e,t){var n,r=k(vo(Object.keys(e),Object.keys(t)));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e[i],o=t[i];lo(a,o)?Object.assign(a,o):ho(a,o)?delete e[i]:fo(a,o)&&(e[i]=o)}}catch(s){r.e(s)}finally{r.f()}},co=function(e,t){e.plugins&&po(e.plugins,t.plugins)&&(t.plugins=e.plugins),e.layerDefinitions&&po(e.layerDefinitions,t.layerDefinitions)&&(t.layerDefinitions=e.layerDefinitions)},lo=function(e,t){return e&&t},ho=function(e,t){return e&&!t},fo=function(e,t){return!e&&t},po=function(e,t){if(e===t||0===e.length&&0===(null==t?void 0:t.length))return!0;if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},vo=function(e,t){var n,r=new Set,i=k(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;r.add(a)}}catch(c){i.e(c)}finally{i.f()}var o,s=k(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r.add(u)}}catch(c){s.e(c)}finally{s.f()}return Array.from(r)},mo=function(){function e(){m(this,e)}return y(e,null,[{key:"convertPeer",value:function(e){var t,n,r;return{id:e.peerId,name:e.name,roleName:null==(t=e.role)?void 0:t.name,isLocal:e.isLocal,videoTrack:null==(n=e.videoTrack)?void 0:n.trackId,audioTrack:null==(r=e.audioTrack)?void 0:r.trackId,auxiliaryTracks:e.auxiliaryTracks.map((function(e){return e.trackId})),customerUserId:e.customerUserId,customerDescription:e.metadata,metadata:e.metadata,joinedAt:e.joinedAt}}},{key:"convertTrack",value:function(e,t){var n={id:e.trackId,source:e.source,type:e.type,enabled:e.enabled,displayEnabled:e.enabled,peerId:e.peerId||t};return this.enrichTrack(n,e),n}},{key:"enrichTrack",value:function(t,n){var r=n.getMediaTrackSettings();"screen"===t.source&&"video"===t.type&&(t.displaySurface=r.displaySurface),t.height=r.height,t.width=r.width,n instanceof lr&&(t.volume=n.getVolume()||0),e.updateDeviceID(t,n),e.enrichVideoTrack(t,n),e.enrichPluginsDetails(t,n)}},{key:"updateDeviceID",value:function(e,t){var n;e.deviceID=t instanceof Li||t instanceof ki?t.settings.deviceId:null==(n=t.getMediaTrackSettings())?void 0:n.deviceId}},{key:"enrichVideoTrack",value:function(e,t){t instanceof hr&&(e.layer=t.getSimulcastLayer(),e.degraded=t.degraded,po(t.getSimulcastDefinitions(),e.layerDefinitions)||(e.layerDefinitions=t.getSimulcastDefinitions()))}},{key:"enrichPluginsDetails",value:function(e,t){(t instanceof Li||t instanceof ki)&&(po(t.getPlugins(),e.plugins)||(e.plugins=t.getPlugins()))}},{key:"convertRoom",value:function(t){var n,r,i=e.convertRecordingStreamingState(null==t?void 0:t.recording,null==t?void 0:t.rtmp,null==t?void 0:t.hls),a=i.recording,o=i.rtmp,s=i.hls;return{id:t.id,name:t.name,localPeer:null!=(r=null==(n=t.localPeer)?void 0:n.peerId)?r:"",hasWaitingRoom:t.hasWaitingRoom,shareableLink:t.shareableLink,recording:a,rtmp:o,hls:s,sessionId:t.sessionId,startedAt:t.startedAt,joinedAt:t.joinedAt,peerCount:t.peerCount}}},{key:"convertMessage",value:function(e){var t,n,r,i,a,o,s;return{sender:null==(t=e.sender)?void 0:t.peerId,senderName:null==(n=e.sender)?void 0:n.name,senderRole:null==(i=null==(r=e.sender)?void 0:r.role)?void 0:i.name,senderUserId:null==(a=e.sender)?void 0:a.customerUserId,recipientPeer:null==(o=e.recipientPeer)?void 0:o.peerId,recipientRoles:null==(s=e.recipientRoles)?void 0:s.map((function(e){return e.name})),time:e.time,type:e.type,message:e.message}}},{key:"convertRoles",value:function(e){var t={};return e&&e.forEach((function(e){t[e.name]=e})),t}},{key:"convertRoleChangeRequest",value:function(e){var t;return{requestedBy:null==(t=e.requestedBy)?void 0:t.peerId,roleName:e.role.name,token:e.token}}},{key:"convertException",value:function(e){return{code:e.code,action:e.action,name:e.name,message:e.message,description:e.description,isTerminal:e.isTerminal,nativeError:e.nativeError,timestamp:new Date}}},{key:"convertDeviceChangeUpdate",value:function(e){var t={devices:e.devices,selection:e.selection,type:e.type};return e.error&&(t.error=this.convertException(e.error)),t}},{key:"convertPlaylist",value:function(e){return{audio:this.getConvertedPlaylistType(e,ao.audio),video:this.getConvertedPlaylistType(e,ao.video)}}},{key:"convertPlaylistItem",value:function(e,t){var n=t.type,r=e.getCurrentSelection(n),i=e.isPlaying(n),a=t.url===(null==r?void 0:r.url);return eo(Za({},t),{type:t.type,selected:a,playing:a&&i})}},{key:"getConvertedPlaylistType",value:function(t,n){var r={},i=t.getCurrentSelection(n),a=t.getCurrentProgress(n),o=t.getVolume(n),s=t.getList(n),u=t.getCurrentIndex(n);return t.getList(n).forEach((function(n){r[n.id]=e.convertPlaylistItem(t,n)})),{list:r,selection:{id:null==i?void 0:i.id,hasPrevious:u>0,hasNext:u<s.length-1},progress:a,volume:o,currentTime:t.getCurrentTime(n),playbackRate:t.getPlaybackRate(n)}}},{key:"convertRecordingStreamingState",value:function(e,t,n){var r;return{recording:{browser:Za({running:!1},null==e?void 0:e.browser),server:Za({running:!1},null==e?void 0:e.server),hls:Za({running:!1},null==e?void 0:e.hls)},rtmp:Za({running:!1},t),hls:{variants:(null==(r=null==n?void 0:n.variants)?void 0:r.map((function(e){return e})))||[],running:!!(null==n?void 0:n.running),error:null==n?void 0:n.error}}}}]),e}();function go(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:bo;if(t){var a,o=k(t.auxiliaryTracks);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=e[s];i(u)&&(r=yo(u)?u:r,n=ko(u)?u:n)}}catch(c){o.e(c)}finally{o.f()}}return{video:n,audio:r}}function yo(e){return e&&"audio"===e.type}function ko(e){return e&&"video"===e.type}function bo(e){return e&&"screen"===e.source}function wo(e){return e&&"audioplaylist"===e.source}function So(e){return e&&"videoplaylist"===e.source}function To(e){return Boolean(null==e?void 0:e.degraded)}function Eo(e,t){return!(!t||!e.tracks[t])&&e.tracks[t].enabled}var xo=function(e){return e.room},Co=(Ha(xo,(function(e){return e.id})),function(e){return e.peers}),Po=function(e){return e.messages.byID},Ro=function(e){return e.messages.allIDs},_o=function(e){return e.tracks},Io=function(e){return e.settings},Ao=Ha([xo],(function(e){return e&&e.isConnected})),Do=Ha([Ao,xo],(function(e,t){return e?t.peerCount||t.peers.length:Math.max(t.peerCount||t.peers.length-1,0)})),No=Ha([xo,Co],(function(e,t){return e.peers.map((function(e){return t[e]}))})),Oo=Ha(_o,(function(e){return Object.values(e)})),Lo=Ha(xo,Co,(function(e,t){return t[e.localPeer]})),Mo=Ha(xo,(function(e){return e.localPeer})),Uo=(Ha(Lo,(function(e){return null==e?void 0:e.name})),Ha(Lo,(function(e){return null==e?void 0:e.roleName})),Ha(Lo,(function(e){return null==e?void 0:e.audioTrack}))),Fo=Ha(Lo,(function(e){return null==e?void 0:e.videoTrack})),jo=Ha(Lo,(function(e){return null==e?void 0:e.auxiliaryTracks})),Bo=Ha([Uo,Fo,jo],(function(e,t,n){var r=v(n);return e&&r.unshift(e),t&&r.unshift(t),r})),Vo=(Ha(No,(function(e){return e.filter((function(e){return!e.isLocal}))})),Ha(Co,(function(e){return e.speakers}),(function(e,t){var n=Object.entries(t).sort((function(e,t){var n,r,i=(null==(n=e[1])?void 0:n.audioLevel)||0;return((null==(r=t[1])?void 0:r.audioLevel)||0)>i?1:-1}));if(n.length>0&&n[0][1].audioLevel&&n[0][1].audioLevel>0){var r=n[0][1].peerID;if(r in e)return e[r]}return null})),function(e){var t=Lo(e);return Eo(e,null==t?void 0:t.audioTrack)}),Go=function(e){var t=Lo(e);return Eo(e,null==t?void 0:t.videoTrack)},zo=function(e){var t=Lo(e);return function(e,t){return!(!t||!e.tracks[t])&&e.tracks[t].displayEnabled}(e,null==t?void 0:t.videoTrack)},Ho=Ha(Lo,_o,(function(e,t){var n=go(t,e),r=n.video,i=n.audio;return!(!r&&!i)})),Ko=Ha(Co,_o,(function(e,t){var n;for(var r in e){var i=e[r],a=go(t,i),o=a.video,s=a.audio;if(o)return i;s&&!n&&(n=i)}return n})),Wo=(Ha(Ko,(function(e){return!!e})),Ha(Co,_o,(function(e,t){for(var n in e){var r=e[n],i=go(t,r),a=i.audio;if(!i.video&&a)return r}})),Ha(Co,_o,(function(e,t){var n=[],r=[];for(var i in e){var a=e[i],o=go(t,a),s=o.video,u=o.audio;s?n.push(a):u&&r.push(a)}return n.concat(r)})),Ha(Co,_o,(function(e,t){for(var n in t){var r=t[n];if(So(r)&&ko(r)&&r.peerId)return e[r.peerId]}})),Ha(Co,_o,(function(e,t){for(var n in t){var r=t[n];if(wo(r)&&r.peerId)return e[r.peerId]}})),Ha(Oo,(function(e){return e.filter(To)})),Ha(Ro,(function(e){return e.length}))),qo=(Ha(Po,(function(e){return Object.values(e).filter((function(e){return!e.read})).length})),Ha(Ro,Po,(function(e,t){var n=[];return e.forEach((function(e){n.push(t[e])})),n}))),Qo=Ha([xo],(function(e){return e&&e.roomState})),Jo=(Ha(Qo,(function(e){return e===Ka.Preview})),Ha(xo,(function(e){return e.roomState!==Ka.Disconnected}))),$o=function(e){return e.roles},Yo=(Ha([$o],(function(e){return Object.keys(e)})),Ha([Lo,$o],(function(e,t){return(null==e?void 0:e.roleName)?t[e.roleName]:null}))),Xo=(Ha([Yo],(function(e){var t;return!!(null==(t=null==e?void 0:e.subscribeParams)?void 0:t.subscribeToRoles)&&e.subscribeParams.subscribeToRoles.length>0})),Ha(Yo,(function(e){return null==e?void 0:e.permissions}))),Zo=(Ha(xo,(function(e){return e.recording})),Ha(xo,(function(e){return e.rtmp})),Ha(xo,(function(e){return e.hls})),Ha(xo,(function(e){return e.sessionId})),Ha(xo,(function(e){return e.startedAt})),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].list}}),es=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].selection}},ts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].progress}},ns=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].currentTime}},rs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].playbackRate}},is=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return function(t){return t.playlist[e].volume}},as=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return Ha(Zo(e),(function(e){return Object.values(e)}))},os=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ao.audio;return Ha(Zo(e),es(e),(function(e,t){if(t.id)return e[t.id]}))},ss={selection:es(ao.audio),progress:ts(ao.audio),currentTime:ns(ao.audio),playbackRate:rs(ao.audio),volume:is(ao.audio),list:as(ao.audio),selectedItem:os(ao.audio)},us={selection:es(ao.video),progress:ts(ao.video),currentTime:ns(ao.video),playbackRate:rs(ao.video),volume:is(ao.video),list:as(ao.video),selectedItem:os(ao.video)};function cs(e){return function(t){return function(n){return e(n,t)}}}var ls="HMS-Store:",ds=function(){function e(){m(this,e)}return y(e,null,[{key:"v",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[Wt.VERBOSE,e].concat(n))}},{key:"d",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log.apply(this,[Wt.DEBUG].concat(t))}},{key:"i",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log.apply(this,[Wt.INFO].concat(t))}},{key:"w",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log.apply(this,[Wt.WARN].concat(t))}},{key:"e",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log.apply(this,[Wt.ERROR].concat(t))}},{key:"time",value:function(e){this.log(Wt.TIME,"[HMSPerformanceTiming]",e)}},{key:"timeEnd",value:function(e){this.log(Wt.TIMEEND,"[HMSPerformanceTiming]",e,e)}},{key:"cleanUp",value:function(){performance.clearMarks(),performance.clearMeasures()}},{key:"log",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!(this.level.valueOf()>e.valueOf()))switch(e){case Wt.VERBOSE:var i;(i=console).log.apply(i,[ls].concat(n));break;case Wt.DEBUG:var a;(a=console).debug.apply(a,[ls].concat(n));break;case Wt.INFO:var o;(o=console).info.apply(o,[ls].concat(n));break;case Wt.WARN:var s;(s=console).warn.apply(s,[ls].concat(n));break;case Wt.ERROR:var u;(u=console).error.apply(u,[ls].concat(n));break;case Wt.TIME:performance.mark(n[1]);break;case Wt.TIMEEND:var c=n[0],l=n[1];try{var d=performance.measure(l,l);this.log(Wt.DEBUG,c,l,null==d?void 0:d.duration),performance.clearMarks(l),performance.clearMeasures(l)}catch(d){this.log(Wt.DEBUG,c,l,d)}}}}]),e}();ds.level=Wt.VERBOSE;var hs=function(e,t){return t},fs=function(e,t){return t},ps=Ha([Co,hs],(function(e,t){return t?e[t]:null})),vs=Ha([_o,function(e,t){return t}],(function(e,t){return t?e[t]:null})),ms=cs(ps),gs=(cs(Ha([function(e){return e.appData},function(e,t){return t}],(function(e,t){return e?t?e[t]:e:{}}))),cs(Ha(ps,(function(e){return null==e?void 0:e.name}))),cs(vs)),ys=cs((function(e,t){var n=ps(e,t);if(n&&n.videoTrack&&""!==n.videoTrack)return e.tracks[n.videoTrack]})),ks=cs((function(e,t){var n=ps(e,t);if(n&&n.audioTrack&&""!==n.audioTrack)return e.tracks[n.audioTrack]})),bs=ys,ws=(cs((function(e,t){var n=ps(e,t);return(null==n?void 0:n.auxiliaryTracks.map((function(t){return e.tracks[t]})))||[]})),function(e,t){return t?e.speakers[t]:null}),Ss=(cs(Ha(ws,(function(e){return(null==e?void 0:e.audioLevel)||0}))),cs(Ha((function(e,t){var n=ks(t)(e);return ws(e,null==n?void 0:n.id)}),(function(e){return(null==e?void 0:e.audioLevel)||0}))),cs((function(e,t){if(t)return e.connectionQualities[t]})),cs((function(e,t){var n=ps(e,t);if(n){var r=null==n?void 0:n.auxiliaryTracks.find((function(t){return yo(e.tracks[t])}));return r?e.tracks[r]:void 0}})),cs(Ha(_o,ps,(function(e,t){var n=null==t?void 0:t.auxiliaryTracks.find((function(t){var n=e[t];return So(n)&&ko(n)}));return n?e[n]:void 0}))),cs(Ha(_o,ps,(function(e,t){var n=null==t?void 0:t.auxiliaryTracks.find((function(t){var n=e[t];return So(n)&&yo(n)}));return n?e[n]:void 0}))),cs(Ha(_o,ps,(function(e,t){var n=null==t?void 0:t.auxiliaryTracks.find((function(t){var n=e[t];return wo(n)&&yo(n)}));return n?e[n]:void 0}))),cs(Ha(_o,ps,(function(e,t){return go(e,t)})))),Ts=function(e){return Ha(Ss(e),(function(e){return e.audio}))},Es=(cs((function(e,t){var n=ps(e,t);return Eo(e,null==n?void 0:n.audioTrack)})),cs((function(e,t){var n=ps(e,t);return Eo(e,null==n?void 0:n.videoTrack)})),cs((function(e,t){if(t&&e.tracks[t])return 0===e.tracks[t].volume}))),xs=(cs((function(e,t){var n=ps(e,t);return Es(null==n?void 0:n.audioTrack)(e)})),cs((function(e,t){var n=Ts(t)(e);return Es(null==n?void 0:n.id)(e)})),cs((function(e,t){var n=vs(e,t);if(n)return"audio"!==n.type?void ds.w("Please pass audio track here"):n.volume}))),Cs=(cs((function(e,t){var n=ps(e,t);return xs(null==n?void 0:n.audioTrack)(e)})),cs((function(e,t){var n=Ts(t)(e);return xs(null==n?void 0:n.id)(e)})),cs((function(e,t){var n=vs(e,t);if(n)return"video"!==n.type?void ds.w("Please pass video track here"):n.layer})),Ha([qo,Mo,hs],(function(e,t,n){if(n)return e.filter((function(e){var r;return!(!e.recipientPeer&&!(null==(r=e.recipientRoles)?void 0:r.length)||e.sender&&![t,n].includes(e.sender))&&[t,n].includes(e.recipientPeer)}))}))),Ps=Ha([qo,fs],(function(e,t){if(t)return e.filter((function(e){var n,r;return!!(null==(n=e.recipientRoles)?void 0:n.length)&&(null==(r=e.recipientRoles)?void 0:r.includes(t))}))})),Rs=Ha(qo,(function(e){return e.filter((function(e){var t;return!e.recipientPeer&&!(null==(t=e.recipientRoles)?void 0:t.length)}))})),_s=Ha([Ps,fs],(function(e){return e?e.filter((function(e){return!e.read})).length:0})),Is=Ha([Cs,hs],(function(e){return e?e.filter((function(e){return!e.read})).length:0}));Ha(Rs,(function(e){return e.filter((function(e){return!e.read})).length})),cs(Cs),cs(Ps),cs(_s),cs(Is),Ha([Co,_o],(function(e,t){return Object.values(e).map((function(e){var n;return{peer:e,isAudioEnabled:!!e.audioTrack&&(null==(n=t[e.audioTrack])?void 0:n.enabled)}}))})),Ha([function(e){return e.roleChangeRequests[0]||null},Co,$o],(function(e,t,n){return e?{requestedBy:e.requestedBy?t[e.requestedBy]:void 0,role:n[e.roleName],token:e.token}:null})),Ha([Yo],(function(e){var t,n=!1,r=!1,i=!1;return(null==(t=null==e?void 0:e.publishParams)?void 0:t.allowed)&&(n=e.publishParams.allowed.includes("video"),r=e.publishParams.allowed.includes("audio"),i=e.publishParams.allowed.includes("screen")),{video:n,audio:r,screen:i}})),Ha([Fo,_o],(function(e,t){var n=null;return e&&(n=t[e]),(null==n?void 0:n.plugins)||[]})),Ha([Uo,_o],(function(e,t){var n=null;return e&&(n=t[e]),(null==n?void 0:n.plugins)||[]}));function As(e){return e instanceof lr||e instanceof hr}var Ds=function(){function e(t,n,r,i){m(this,e),this.playlistManager=t,this.syncPlaylistState=r,this.store=i,this.type=n}return y(e,[{key:"play",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return ds.w("Please pass id to play"),t.abrupt("return");case 3:return t.next=5,this.playlistManager.setEnabled(!0,{id:e,type:this.type});case 5:case"end":return t.stop()}}),t,this)})))}},{key:"pause",value:function(){return to(this,null,u().mark((function e(){var t,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.type===ao.audio?ss:us,(n=this.store.getState(t.selection)).id){e.next=4;break}return ds.w("No item is currently playing to pause"),e.abrupt("return");case 4:return e.next=6,this.playlistManager.setEnabled(!1,{id:n.id,type:this.type});case 6:case"end":return e.stop()}}),e,this)})))}},{key:"playNext",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playlistManager.playNext(this.type);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"playPrevious",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playlistManager.playPrevious(this.type);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"seek",value:function(e){this.playlistManager.seek(e,this.type),this.syncPlaylistState("seekOn".concat(this.type,"Playlist"))}},{key:"seekTo",value:function(e){this.playlistManager.seekTo(e,this.type),this.syncPlaylistState("seekToOn".concat(this.type,"Playlist"))}},{key:"setVolume",value:function(e){this.playlistManager.setVolume(e,this.type),this.syncPlaylistState("setVolumeOn".concat(this.type,"Playlist"))}},{key:"setList",value:function(e){this.playlistManager.setList(e),this.syncPlaylistState("setListOn".concat(this.type,"Playlist"))}},{key:"stop",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playlistManager.stop(this.type);case 2:this.syncPlaylistState("stop".concat(this.type,"Playlist"));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"setIsAutoplayOn",value:function(e){this.playlistManager.setIsAutoplayOn(this.type,e)}},{key:"setPlaybackRate",value:function(e){this.playlistManager.setPlaybackRate(this.type,e),this.syncPlaylistState("set".concat(this.type,"PlaybackRate"))}}]),e}(),Ns=(p(Va={},sn.PEER_JOINED,io.PEER_JOINED),p(Va,sn.PEER_LEFT,io.PEER_LEFT),p(Va,sn.ROLE_UPDATED,io.ROLE_UPDATED),p(Va,sn.AUDIO_TOGGLED,"PEER_AUDIO_UPDATED"),p(Va,sn.VIDEO_TOGGLED,"PEER_VIDEO_UPDATED"),p(Va,sn.NAME_UPDATED,io.NAME_UPDATED),p(Va,sn.METADATA_UPDATED,io.METADATA_UPDATED),Va),Os=(p(Ga={},un.TRACK_ADDED,io.TRACK_ADDED),p(Ga,un.TRACK_REMOVED,io.TRACK_REMOVED),p(Ga,un.TRACK_MUTED,io.TRACK_MUTED),p(Ga,un.TRACK_UNMUTED,io.TRACK_UNMUTED),p(Ga,un.TRACK_DEGRADED,io.TRACK_DEGRADED),p(Ga,un.TRACK_RESTORED,io.TRACK_RESTORED),Ga),Ls=(p(za={},sn.PEER_JOINED,"peerJoined"),p(za,sn.PEER_LEFT,"peerLeft"),p(za,sn.NAME_UPDATED,"peerNameUpdated"),p(za,sn.ROLE_UPDATED,"peerRoleUpdated"),p(za,sn.METADATA_UPDATED,"peerMetadataUpdated"),za),Ms=function(){function e(t,n,r){var i=this;m(this,e),this.hmsSDKTracks={},this.hmsSDKPeers={},this.isRoomJoinCalled=!1,this.ignoredMessageTypes=[],this.setProgress=function(e){var t=e.type,n=e.progress;i.setState((function(e){e.playlist[t].progress=n,e.playlist[t].currentTime=i.sdk.getPlaylistManager().getCurrentTime(t)}),"playlistProgress")},this.syncPlaylistState=function(e){i.setState((function(e){Object.assign(e.playlist,mo.convertPlaylist(i.sdk.getPlaylistManager()))}),e)},this.sendPeerUpdateNotification=function(e,t){var n=i.store.getState(ms(t.peerId)),r=Ls[e];i.syncRoomState(r),n||(n=i.store.getState(ms(t.peerId))),i.hmsNotifications.sendPeerUpdate(e,n)},this.setState=function(e,t){return i.store.namedSetState(e,t)},this.store=t,this.sdk=n,this.hmsNotifications=r}return y(e,[{key:"refreshDevices",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sdk.refreshDevices();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"unblockAudio",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sdk.getAudioOutput().unblockAutoplay();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"setVolume",value:function(e,t){t?this.setTrackVolume(e,t):(this.sdk.getAudioOutput().setVolume(e),this.syncRoomState("setOutputVolume"))}},{key:"setAudioOutputDevice",value:function(e){this.sdk.getAudioOutput().setDevice(e)&&this.setState((function(t){t.settings.audioOutputDeviceId=e}),"setAudioOutputDevice")}},{key:"setPreferredLayer",value:function(e,t){var n=this.hmsSDKTracks[e];n?n instanceof hr?(n.preferLayer(t),this.updateVideoLayer(e,"setPreferredLayer")):ds.w("track ".concat(e," is not an video track")):this.logPossibleInconsistency("track ".concat(e," not present, unable to set preffer layer"))}},{key:"preview",value:function(e){return to(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isRoomJoinCalled){t.next=3;break}return this.logPossibleInconsistency("attempting to call preview after join was called"),t.abrupt("return");case 3:if((n=this.store.getState(Qo))!==Ka.Preview&&n!==Ka.Connecting){t.next=7;break}return this.logPossibleInconsistency("attempting to call preview while room is in preview/connecting"),t.abrupt("return");case 7:return t.prev=7,this.setState((function(e){e.room.roomState=Ka.Connecting}),"connecting"),t.next=11,this.sdkPreviewWithListeners(e);case 11:t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(7),ds.e("Cannot show preview. Failed to connect to room - ",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,this,[[7,13]])})))}},{key:"join",value:function(e){if(this.isRoomJoinCalled)this.logPossibleInconsistency("room join is called again");else try{this.isRoomJoinCalled=!0,this.setState((function(e){e.room.roomState=Ka.Connecting}),"join"),this.sdkJoinWithListeners(e)}catch(S){throw this.isRoomJoinCalled=!1,ds.e("Failed to connect to room - ",S),S}}},{key:"leave",value:function(){return to(this,null,u().mark((function e(){var t,n=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.store.getState(Jo)){e.next=3;break}return this.logPossibleInconsistency("room leave is called when no room is connected"),e.abrupt("return");case 3:return t=this.store.getState(Qo),e.abrupt("return",(this.setState((function(e){e.room.roomState=Ka.Disconnecting}),"leaving"),this.sdk.leave().then((function(){n.resetState("leave"),ds.i("left room")})).catch((function(e){ds.e("error in leaving room - ",e),n.setState((function(e){e.room.roomState=t}),"revertLeave")}))));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"setScreenShareEnabled",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r={audioOnly:!1,videoOnly:!1},"object"==typeof t?Object.assign(r,t):"boolean"==typeof t&&(r.audioOnly=t),n.prev=2,!e){n.next=8;break}return n.next=6,this.startScreenShare(r);case 6:n.next=10;break;case 8:return n.next=10,this.stopScreenShare();case 10:n.next=15;break;case 12:throw n.prev=12,n.t0=n.catch(2),this.hmsNotifications.sendError(mo.convertException(n.t0)),n.t0;case 15:case"end":return n.stop()}}),n,this,[[2,12]])})))}},{key:"addTrack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"regular";return to(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.sdk.addTrack(e,t);case 2:this.syncRoomState("addTrack");case 3:case"end":return n.stop()}}),n,this)})))}},{key:"removeTrack",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.removeTrack(e);case 2:this.syncRoomState("removeTrack");case 3:case"end":return t.stop()}}),t,this)})))}},{key:"setLocalAudioEnabled",value:function(e){return to(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.getState(Uo),t.t0=n,!t.t0){t.next=5;break}return t.next=5,this.setEnabledTrack(n,e);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"setLocalVideoEnabled",value:function(e){return to(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.getState(Fo),t.t0=n,!t.t0){t.next=5;break}return t.next=5,this.setEnabledTrack(n,e);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"setEnabledTrack",value:function(e,t){return to(this,null,u().mark((function n(){var r,i,a=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((null==(r=this.store.getState().tracks[e])?void 0:r.enabled)!==t){n.next=3;break}return this.logPossibleInconsistency("local track[".concat(e,"] enabled state - ").concat(t)),n.abrupt("return");case 3:return this.setState((function(n){n.tracks[e]?n.tracks[e].displayEnabled=t:a.logPossibleInconsistency("track id not found for setEnabled")}),"displayEnabled"),n.prev=4,n.next=7,this.setEnabledSDKTrack(e,t);case 7:this.syncRoomState("setEnabled"),n.next=13;break;case 10:throw n.prev=10,n.t0=n.catch(4),this.setState((function(n){n.tracks[e].displayEnabled=!t}),"rollbackDisplayEnabled"),this.hmsNotifications.sendError(mo.convertException(n.t0)),n.t0;case 13:i=t?un.TRACK_UNMUTED:un.TRACK_MUTED,this.hmsNotifications.sendTrackUpdate(i,e);case 15:case"end":return n.stop()}}),n,this,[[4,10]])})))}},{key:"setAudioSettings",value:function(e){return to(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.getState(Uo),t.t0=n,!t.t0){t.next=6;break}return t.next=5,this.setSDKLocalAudioTrackSettings(n,e);case 5:this.syncRoomState("setAudioSettings");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"setVideoSettings",value:function(e){return to(this,null,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.store.getState(Fo),t.t0=n,!t.t0){t.next=6;break}return t.next=5,this.setSDKLocalVideoTrackSettings(n,e);case 5:this.syncRoomState("setVideoSettings");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"sendMessage",value:function(e){this.sendBroadcastMessage(e)}},{key:"sendBroadcastMessage",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.sdk.sendBroadcastMessage(e,t);case 2:r=n.sent,this.updateMessageInStore(r,{message:e,type:t});case 4:case"end":return n.stop()}}),n,this)})))}},{key:"sendGroupMessage",value:function(e,t,n){return to(this,null,u().mark((function r(){var i,a,o;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.store.getState($o),a=t.map((function(e){return i[e]})),r.next=4,this.sdk.sendGroupMessage(e,a,n);case 4:o=r.sent,this.updateMessageInStore(o,{message:e,recipientRoles:t,type:n});case 6:case"end":return r.stop()}}),r,this)})))}},{key:"sendDirectMessage",value:function(e,t,n){return to(this,null,u().mark((function r(){var i,a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.hmsSDKPeers[t],r.next=3,this.sdk.sendDirectMessage(e,i,n);case 3:a=r.sent,this.updateMessageInStore(a,{message:e,recipientPeer:i.peerId,type:n});case 5:case"end":return r.stop()}}),r,this)})))}},{key:"updateMessageInStore",value:function(e,t){if(!e)throw ds.w("sendMessage","Failed to send message",t),Error("sendMessage Failed - ".concat(JSON.stringify(t)));var n=mo.convertMessage(e);return n.read=!0,n.senderName="You",n.ignored=this.ignoredMessageTypes.includes(n.type),this.putMessageInStore(n),n}},{key:"setMessageRead",value:function(e,t){var n=this;this.setState((function(r){t?r.messages.byID[t]?r.messages.byID[t].read=e:n.logPossibleInconsistency("no message with id is found"):r.messages.allIDs.forEach((function(t){r.messages.byID[t].read=e}))}),"setMessageRead")}},{key:"attachVideo",value:function(e,t){return to(this,null,u().mark((function n(){var r=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.localAndVideoUnmuting(e)){n.next=2;break}return n.abrupt("return",new Promise((function(n){var i=r.store.subscribe((function(a){return to(r,null,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.t0=a,!r.t0){r.next=6;break}return r.next=4,this.attachVideoInternal(e,t);case 4:i(),n();case 6:case"end":return r.stop()}}),r,this)})))}),Go)})));case 2:return n.next=4,this.attachVideoInternal(e,t);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"detachVideo",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKTracks[e])||"video"!==r.type){n.next=7;break}return n.next=4,r.removeSink(t);case 4:this.updateVideoLayer(e,"detachVideo"),n.next=8;break;case 7:this.logPossibleInconsistency("no video track found to remove sink");case 8:case"end":return n.stop()}}),n,this)})))}},{key:"addPluginToVideoTrack",value:function(e,t){return to(this,null,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.addRemoveVideoPlugin(e,"add",t));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"addPluginToAudioTrack",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.addRemoveAudioPlugin(e,"add"));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"validateVideoPluginSupport",value:function(e){var t={isSupported:!1};if(!e)return ds.w("no plugin passed in for checking support"),t.errMsg="no plugin passed in for checking support",t;var n=this.store.getState(Fo);if(n){var r=this.hmsSDKTracks[n];r?t=r.validatePlugin(e):(ds.w("track ".concat(n," not present, unable to validate plugin")),t.errMsg="track ".concat(n," not present, unable to validate plugin"))}return t}},{key:"validateAudioPluginSupport",value:function(e){var t={isSupported:!1};if(!e)return ds.w('no plugin passed in for checking support"'),t.errMsg='no plugin passed in for checking support"',t;var n=this.store.getState(Uo);if(n){var r=this.hmsSDKTracks[n];r?t=r.validatePlugin(e):(ds.w("track ".concat(n," not present, unable to validate plugin")),t.errMsg="track ".concat(n," not present, unable to validate plugin"))}return t}},{key:"removePluginFromVideoTrack",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.addRemoveVideoPlugin(e,"remove"));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"removePluginFromAudioTrack",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.addRemoveAudioPlugin(e,"remove"));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"changeRole",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return to(this,null,u().mark((function r(){var i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=this.hmsSDKPeers[e]){r.next=4;break}return this.logPossibleInconsistency("Unknown peer ID given ".concat(e," for changerole")),r.abrupt("return");case 4:return r.next=6,this.sdk.changeRole(i,t,n);case 6:case"end":return r.stop()}}),r,this)})))}},{key:"acceptChangeRole",value:function(e){return to(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=e.requestedBy?this.hmsSDKPeers[e.requestedBy.id]:void 0)||ds.w("peer for which role change is requested no longer available - ".concat(e.requestedBy)),r={requestedBy:n,role:e.role,token:e.token},t.next=5,this.sdk.acceptChangeRole(r);case 5:this.removeRoleChangeRequest(e);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"initAppData",value:function(e){this.setState((function(t){t.appData=e}),"initAppData")}},{key:"setAppData",value:function(e,t,n){var r="Object"===(null==t?void 0:t.constructor.name);this.setState((function(i){if(i.appData)n&&r?Object.assign(i.appData[e],t):i.appData[e]=t;else{var a=p({},e,t);i.appData=a}}),"setAppData-".concat(e))}},{key:"rejectChangeRole",value:function(e){this.removeRoleChangeRequest(e)}},{key:"endRoom",value:function(e,t){return to(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null==(r=this.store.getState(Xo))?void 0:r.endRoom){n.next=4;break}return ds.w("You are not allowed to perform this action - endRoom"),n.abrupt("return");case 4:return i=this.store.getState(Qo),this.setState((function(e){e.room.roomState=Ka.Disconnecting}),"endingRoom"),n.prev=6,n.next=9,this.sdk.endRoom(e,t);case 9:this.resetState("endRoom"),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(6),ds.e("error in ending room - ",n.t0),this.setState((function(e){e.room.roomState=i}),"revertEndRoom");case 15:case"end":return n.stop()}}),n,this,[[6,12]])})))}},{key:"removePeer",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKPeers[e])||r.isLocal){n.next=6;break}return n.next=4,this.sdk.removePeer(r,t);case 4:n.next=8;break;case 6:return this.logPossibleInconsistency("No remote peer found for peerID - ".concat(e)),n.abrupt("return");case 8:case"end":return n.stop()}}),n,this)})))}},{key:"startRTMPOrRecording",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.startRTMPOrRecording(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"stopRTMPAndRecording",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sdk.stopRTMPAndRecording();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"startHLSStreaming",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.startHLSStreaming(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"stopHLSStreaming",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.stopHLSStreaming(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"changeName",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.changeName(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"changeMetadata",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"string"!=typeof e&&(e=JSON.stringify(e)),t.next=3,this.sdk.changeMetadata(e);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"setRemoteTrackEnabled",value:function(e,t){return to(this,null,u().mark((function n(){var r,i=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("string"!=typeof e){n.next=10;break}if(!(r=this.hmsSDKTracks[e])||!As(r)){n.next=7;break}return n.next=5,this.sdk.changeTrackState(r,t);case 5:n.next=8;break;case 7:this.logPossibleInconsistency("No remote track with ID ".concat(e," found for change track state"));case 8:n.next=11;break;case 10:Array.isArray(e)&&e.forEach((function(e){return i.setRemoteTrackEnabled(e,t)}));case 11:case"end":return n.stop()}}),n,this)})))}},{key:"setRemoteTracksEnabled",value:function(e){return to(this,null,u().mark((function t(){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={enabled:e.enabled,type:e.type,source:e.source},e.roles&&(r=this.store.getState($o),n.roles=e.roles.map((function(e){return r[e]}))),t.next=4,this.sdk.changeMultiTrackState(n);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setLogLevel",value:function(e){ds.level=e,this.sdk.setLogLevel(e)}},{key:"ignoreMessageTypes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)this.ignoredMessageTypes=e;else{var n,r=k(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;this.ignoredMessageTypes.includes(i)||this.ignoredMessageTypes.push(i)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"resetState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"resetState";this.setState((function(e){Object.assign(e,oo())}),e),this.isRoomJoinCalled=!1,this.hmsSDKTracks={},ds.cleanUp()}},{key:"sdkJoinWithListeners",value:function(e){this.sdk.join(e,{onJoin:this.onJoin.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onTrackUpdate:this.onTrackUpdate.bind(this),onMessageReceived:this.onMessageReceived.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onRoleChangeRequest:this.onRoleChangeRequest.bind(this),onRoleUpdate:this.onRoleUpdate.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onChangeTrackStateRequest:this.onChangeTrackStateRequest.bind(this),onChangeMultiTrackStateRequest:this.onChangeMultiTrackStateRequest.bind(this),onRemovedFromRoom:this.onRemovedFromRoom.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this)}),this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)}),this.sdk.addConnectionQualityListener({onConnectionQualityUpdate:this.onConnectionQualityUpdate.bind(this)})}},{key:"onRemovedFromRoom",value:function(e){var t,n=this.store.getState(ms(null==(t=e.requestedBy)?void 0:t.peerId));this.hmsNotifications.sendLeaveRoom(eo(Za({},e),{requestedBy:n||void 0}));var r=e.roomEnded||!n?"roomEnded":"removedFromRoom";ds.i("resetting state after peer removed ".concat(r),e),this.resetState(r)}},{key:"onDeviceChange",value:function(e){var t=this,n=e.devices;if(n){var r=this.store.getState(Lo);if(this.setState((function(e){po(e.devices.audioInput,n.audioInput)||(e.devices.audioInput=n.audioInput),po(e.devices.videoInput,n.videoInput)||(e.devices.videoInput=n.videoInput),po(e.devices.audioOutput,n.audioOutput)||(e.devices.audioOutput=n.audioOutput),t.hmsSDKPeers[null==r?void 0:r.id]&&Object.assign(e.settings,t.getMediaSettings(t.hmsSDKPeers[null==r?void 0:r.id]))}),"deviceChange"),e.selection){var i=mo.convertDeviceChangeUpdate(e);this.hmsNotifications.sendDeviceChange(i)}}}},{key:"sdkPreviewWithListeners",value:function(e){return to(this,null,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.sdk.preview(e,{onPreview:this.onPreview.bind(this),onError:this.onError.bind(this),onReconnected:this.onReconnected.bind(this),onReconnecting:this.onReconnecting.bind(this),onDeviceChange:this.onDeviceChange.bind(this),onRoomUpdate:this.onRoomUpdate.bind(this),onPeerUpdate:this.onPeerUpdate.bind(this),onNetworkQuality:this.onNetworkQuality.bind(this)});case 2:this.sdk.addAudioListener({onAudioLevelUpdate:this.onAudioLevelUpdate.bind(this)});case 3:case"end":return t.stop()}}),t,this)})))}},{key:"onNetworkQuality",value:function(e){var t=this;this.setState((function(n){var r,i=n.room.localPeer||(null==(r=t.sdk.getLocalPeer())?void 0:r.peerId);i&&(n.connectionQualities[i]={peerID:i,downlinkQuality:e})}),"ConnectionQuality")}},{key:"startScreenShare",value:function(e){return to(this,null,u().mark((function t(){var n=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.store.getState(Ho)){t.next=4;break}this.logPossibleInconsistency("start screenshare is called while it's on"),t.next=7;break;case 4:return t.next=6,this.sdk.startScreenShare((function(){return n.syncRoomState("screenshareStopped")}),e);case 6:this.syncRoomState("startScreenShare");case 7:case"end":return t.stop()}}),t,this)})))}},{key:"stopScreenShare",value:function(){return to(this,null,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.store.getState(Ho)){e.next=6;break}return e.next=3,this.sdk.stopScreenShare();case 3:this.syncRoomState("stopScreenShare"),e.next=7;break;case 6:this.logPossibleInconsistency("stop screenshare is called while it's not on");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"attachVideoInternal",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKTracks[e])||"video"!==r.type){n.next=7;break}return n.next=4,r.addSink(t);case 4:this.updateVideoLayer(e,"attachVideo"),n.next=8;break;case 7:this.logPossibleInconsistency("no video track found to add sink");case 8:case"end":return n.stop()}}),n,this)})))}},{key:"syncRoomState",value:function(e){var t=this;ds.time("store-sync-".concat(e));var n,r={},i=[],a={},o={},s={},u=k(this.sdk.getPeers());try{for(u.s();!(n=u.n()).done;){var c=n.value,l=mo.convertPeer(c);r[l.id]=l,i.push(l.id),this.hmsSDKPeers[l.id]=c;var d,h=k([c.audioTrack,c.videoTrack].concat(v(c.auxiliaryTracks)));try{for(h.s();!(d=h.n()).done;){var f=d.value;if(f){var p=mo.convertTrack(f);a[p.id]=p,o[f.trackId]=f}}}catch(b){h.e(b)}finally{h.f()}l.isLocal&&Object.assign(s,this.getMediaSettings(c))}}catch(b){u.e(b)}finally{u.f()}var m=this.sdk.getRecordingState(),g=this.sdk.getRTMPState(),y=this.sdk.getHLSState();this.setState((function(e){e.room.peers=i;var n=e.peers,u=e.tracks;(function(e,t){var n,r=k(vo(Object.keys(e),Object.keys(t)));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e[i],o=t[i];lo(a,o)?(po(a.auxiliaryTracks,o.auxiliaryTracks)&&(o.auxiliaryTracks=a.auxiliaryTracks),Object.assign(a,o)):ho(a,o)?delete e[i]:fo(a,o)&&(e[i]=o)}}catch(b){r.e(b)}finally{r.f()}})(n,r),function(e,t){var n,r=k(vo(Object.keys(e),Object.keys(t)));try{for(r.s();!(n=r.n()).done;){var i=n.value,a=e[i],o=t[i];lo(a,o)?(co(a,o),Object.assign(a,o)):ho(a,o)?delete e[i]:fo(a,o)&&(e[i]=o)}}catch(b){r.e(b)}finally{r.f()}}(u,a),Object.assign(e.settings,s),t.hmsSDKTracks=o,Object.assign(e.roles,mo.convertRoles(t.sdk.getRoles())),Object.assign(e.playlist,mo.convertPlaylist(t.sdk.getPlaylistManager())),Object.assign(e.room,mo.convertRecordingStreamingState(m,g,y))}),e),ds.timeEnd("store-sync-".concat(e))}},{key:"onPreview",value:function(e){this.setState((function(t){Object.assign(t.room,mo.convertRoom(e)),t.room.roomState=Ka.Preview}),"previewStart"),this.syncRoomState("previewSync")}},{key:"onJoin",value:function(e){var t=this,n=this.sdk.getPlaylistManager();this.audioPlaylist=new Ds(n,ao.audio,this.syncPlaylistState.bind(this),this.store),this.videoPlaylist=new Ds(n,ao.video,this.syncRoomState.bind(this),this.store),this.syncRoomState("joinSync"),this.setState((function(t){Object.assign(t.room,mo.convertRoom(e)),t.room.isConnected=!0,t.room.roomState=Ka.Connected}),"joined"),n.onProgress(this.setProgress),n.onNewTrackStart((function(e){t.syncPlaylistState("".concat(e.type,"PlaylistUpdate"))})),n.onPlaylistEnded((function(e){t.syncPlaylistState("".concat(e,"PlaylistEnded"))})),n.onCurrentTrackEnded((function(e){t.hmsNotifications.sendPlaylistTrackEnded(mo.convertPlaylistItem(n,e)),t.syncPlaylistState("".concat(e.type,"PlaylistItemEnded"))}))}},{key:"onRoomUpdate",value:function(e,t){this.setState((function(e){Object.assign(e.room,mo.convertRoom(t))}),"RoomUpdate")}},{key:"onPeerUpdate",value:function(e,t){if(![sn.BECAME_DOMINANT_SPEAKER,sn.RESIGNED_DOMINANT_SPEAKER].includes(e)){if(Array.isArray(t)){this.syncRoomState("peersJoined");var n,r=[],i=k(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=this.store.getState(ms(a.peerId));o&&r.push(o)}}catch(s){i.e(s)}finally{i.f()}return void this.hmsNotifications.sendPeerList(r)}this.sendPeerUpdateNotification(e,t)}}},{key:"onTrackUpdate",value:function(e,t,n){if(e===un.TRACK_REMOVED)this.hmsNotifications.sendTrackUpdate(e,t.trackId),this.handleTrackRemove(t,n);else{var r=e===un.TRACK_ADDED?"trackAdded":"trackUpdate";this.syncRoomState(r),this.hmsNotifications.sendTrackUpdate(e,t.trackId)}}},{key:"onMessageReceived",value:function(e){var t=mo.convertMessage(e);t.read=!1,t.ignored=this.ignoredMessageTypes.includes(t.type),this.putMessageInStore(t),this.hmsNotifications.sendMessageReceived(t)}},{key:"putMessageInStore",value:function(e){var t=this;e.ignored||this.setState((function(n){e.id=String(t.store.getState(Wo)+1),n.messages.byID[e.id]=e,n.messages.allIDs.push(e.id)}),"newMessage")}},{key:"onAudioLevelUpdate",value:function(e){this.setState((function(t){var n={};e.forEach((function(e){if(e.track&&e.peer){var r=e.track.trackId;n[r]=e.audioLevel,t.speakers[r]||(t.speakers[r]={audioLevel:e.audioLevel,peerID:e.peer.peerId,trackID:r})}}));for(var r=0,i=Object.entries(t.speakers);r<i.length;r++){var a=f(i[r],2),o=a[0],s=a[1];s.audioLevel=n[o]||0,0===s.audioLevel&&delete t.speakers[o]}}),"audioLevel")}},{key:"onConnectionQualityUpdate",value:function(e){this.setState((function(t){var n=new Set;e.forEach((function(e){var r=e.peerID;!r||(n.add(r),t.connectionQualities[r]?Object.assign(t.connectionQualities[r],e):t.connectionQualities[r]=e)}));for(var r=0,i=Object.keys(t.connectionQualities);r<i.length;r++){var a=i[r];n.has(a)||delete t.connectionQualities[a]}}),"connectionQuality")}},{key:"onChangeTrackStateRequest",value:function(e){var t,n=this.store.getState(ms(null==(t=e.requestedBy)?void 0:t.peerId)),r=this.getStoreLocalTrackIDfromSDKTrack(e.track),i=this.store.getState(gs(r));if(!i)return this.logPossibleInconsistency("Not found track for which track state change was requested, ".concat(e.track));e.enabled||this.syncRoomState("changeTrackStateRequest"),this.hmsNotifications.sendChangeTrackStateRequest({requestedBy:n||void 0,track:i,enabled:e.enabled})}},{key:"onChangeMultiTrackStateRequest",value:function(e){var t,n=this.store.getState(ms(null==(t=e.requestedBy)?void 0:t.peerId));e.enabled||this.syncRoomState("changeMultiTrackStateRequest");var r,i=[],a=this.store.getState(_o),o=k(e.tracks);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=this.getStoreLocalTrackIDfromSDKTrack(s);u&&a[u]&&i.push(a[u])}}catch(c){o.e(c)}finally{o.f()}this.hmsNotifications.sendChangeMultiTrackStateRequest({requestedBy:n||void 0,tracks:i,enabled:e.enabled,type:e.type,source:e.source})}},{key:"onReconnected",value:function(){this.syncRoomState("reconnectedSync"),this.hmsNotifications.sendReconnected(),this.setState((function(e){e.room.roomState=e.room.isConnected?Ka.Connected:Ka.Preview}),"reconnected")}},{key:"onReconnecting",value:function(e){var t=mo.convertException(e);ds.e("Reconnection: received error from sdk",t),this.hmsNotifications.sendReconnecting(t),this.setState((function(e){e.room.roomState=Ka.Reconnecting,e.errors.push(t)}),"reconnecting")}},{key:"onError",value:function(e){var t=mo.convertException(e);t.isTerminal?(this.leave().then((function(){return ds.e("error from SDK, left room.")})),this.setState((function(e){e.room.roomState=Ka.Failed,e.errors.push(t)}),"errorTerminal")):this.store.getState().errors.length<50&&this.setState((function(e){e.errors.push(t)}),"error"),this.syncRoomState("errorSync"),this.hmsNotifications.sendError(t),ds.e("received error from sdk",t)}},{key:"updateVideoLayer",value:function(e,t){var n=this.hmsSDKTracks[e];n&&n instanceof hr&&this.setState((function(t){t.tracks[e].layer=n.getSimulcastLayer(),t.tracks[e].degraded=n.degraded}),t)}},{key:"handleTrackRemove",value:function(e,t){var n=this;this.setState((function(r){var i=r.peers[t.peerId],a=r.tracks,o=e.trackId;if(n.isSameStoreSDKTrack(o,null==i?void 0:i.audioTrack))null==i||delete i.audioTrack;else if(n.isSameStoreSDKTrack(o,null==i?void 0:i.videoTrack))null==i||delete i.videoTrack;else{var s=null==i?void 0:i.auxiliaryTracks.indexOf(o);s>-1&&n.isSameStoreSDKTrack(o,null==i?void 0:i.auxiliaryTracks[s])&&(null==i||i.auxiliaryTracks.splice(s,1))}delete a[o],delete n.hmsSDKTracks[o]}),"trackRemoved")}},{key:"setEnabledSDKTrack",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKTracks[e])){n.next=6;break}return n.next=4,r.setEnabled(t);case 4:n.next=7;break;case 6:this.logPossibleInconsistency("track ".concat(e," not present, unable to enabled/disable"));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setSDKLocalVideoTrackSettings",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKTracks[e])){n.next=6;break}return n.next=4,r.setSettings(t);case 4:n.next=7;break;case 6:this.logPossibleInconsistency("local track ".concat(e," not present, unable to set settings"));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"setSDKLocalAudioTrackSettings",value:function(e,t){return to(this,null,u().mark((function n(){var r;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=this.hmsSDKTracks[e])){n.next=6;break}return n.next=4,r.setSettings(t);case 4:n.next=7;break;case 6:this.logPossibleInconsistency("local track ".concat(e," not present, unable to set settings"));case 7:case"end":return n.stop()}}),n,this)})))}},{key:"getMediaSettings",value:function(e){var t,n=this.store.getState(Io),r=e.audioTrack,i=e.videoTrack;return{audioInputDeviceId:(null==r?void 0:r.settings.deviceId)||n.audioInputDeviceId,videoInputDeviceId:(null==i?void 0:i.settings.deviceId)||n.videoInputDeviceId,audioOutputDeviceId:null==(t=this.sdk.getAudioOutput().getDevice())?void 0:t.deviceId}}},{key:"setTrackVolume",value:function(e,t){var n=this.hmsSDKTracks[t];n?n instanceof cr?(n.setVolume(e),this.setState((function(n){var r=n.tracks[t];r&&(r.volume=e)}),"trackVolume")):ds.w("track ".concat(t," is not an audio track")):this.logPossibleInconsistency("track ".concat(t," not present, unable to set volume"))}},{key:"localAndVideoUnmuting",value:function(e){if(this.store.getState(Lo).videoTrack!==e)return!1;var t=this.store.getState(zo),n=this.store.getState(Go);return t&&!n}},{key:"logPossibleInconsistency",value:function(e){ds.w("possible inconsistency detected - ",e)}},{key:"addRemoveVideoPlugin",value:function(e,t,n){return to(this,null,u().mark((function r(){var i,a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=3;break}return ds.w("Invalid plugin received in store"),r.abrupt("return");case 3:if(!(i=this.store.getState(Fo))){r.next=20;break}if(!(a=this.hmsSDKTracks[i])){r.next=19;break}if("add"!==t){r.next=12;break}return r.next=10,a.addPlugin(e,n);case 10:r.next=16;break;case 12:if(r.t0="remove"===t,!r.t0){r.next=16;break}return r.next=16,a.removePlugin(e);case 16:this.syncRoomState("".concat(t,"VideoPlugin")),r.next=20;break;case 19:this.logPossibleInconsistency("track ".concat(i," not present, unable to remove plugin"));case 20:case"end":return r.stop()}}),r,this)})))}},{key:"addRemoveAudioPlugin",value:function(e,t){return to(this,null,u().mark((function n(){var r,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=3;break}return ds.w("Invalid plugin received in store"),n.abrupt("return");case 3:if(!(r=this.store.getState(Uo))){n.next=20;break}if(!(i=this.hmsSDKTracks[r])){n.next=19;break}if("add"!==t){n.next=12;break}return n.next=10,i.addPlugin(e);case 10:n.next=16;break;case 12:if(n.t0="remove"===t,!n.t0){n.next=16;break}return n.next=16,i.removePlugin(e);case 16:this.syncRoomState("".concat(t,"AudioPlugin")),n.next=20;break;case 19:this.logPossibleInconsistency("track ".concat(r," not present, unable to remove plugin"));case 20:case"end":return n.stop()}}),n,this)})))}},{key:"isSameStoreSDKTrack",value:function(e,t){var n;return!!t&&(null==(n=this.hmsSDKTracks[t])?void 0:n.trackId)===e}},{key:"onRoleChangeRequest",value:function(e){this.setState((function(t){0===t.roleChangeRequests.length&&t.roleChangeRequests.push(mo.convertRoleChangeRequest(e))}),"roleChangeRequest")}},{key:"removeRoleChangeRequest",value:function(e){this.setState((function(t){var n=t.roleChangeRequests.findIndex((function(t){return t.token===e.token}));-1!==n&&t.roleChangeRequests.splice(n,1)}),"removeRoleChangeRequest")}},{key:"onRoleUpdate",value:function(){this.syncRoomState("roleUpdate")}},{key:"getStoreLocalTrackIDfromSDKTrack",value:function(e){var t=this;return this.store.getState(Bo).find((function(n){return t.hmsSDKTracks[n].trackId===e.trackId}))}}]),e}(),Us="hmsNotification",Fs=function(){function e(t){var n=this;m(this,e),this.id=0,this.onNotification=function(e,t){var r=function(n){if(t&&!(Array.isArray(t)?t.includes(n.type):t===n.type))return;e(n)};return n.eventEmitter.addListener(Us,r),function(){n.eventEmitter.removeListener(Us,r)}},this.store=t,this.eventEmitter=new Qt.EventEmitter2}return y(e,[{key:"sendPlaylistTrackEnded",value:function(e){var t=this.createNotification(io.PLAYLIST_TRACK_ENDED,e,ro.INFO);this.emitEvent(t)}},{key:"sendDeviceChange",value:function(e){var t,n=this.createNotification(io.DEVICE_CHANGE_UPDATE,e,e.error?ro.ERROR:ro.INFO,"Selected ".concat(e.type," device - ").concat(null==(t=e.selection)?void 0:t.label));this.emitEvent(n)}},{key:"sendLeaveRoom",value:function(e){var t,n=null==(t=e.requestedBy)?void 0:t.name,r=this.createNotification(e.roomEnded||!n?io.ROOM_ENDED:io.REMOVED_FROM_ROOM,e,ro.INFO,"".concat(e.roomEnded?"Room ended":"Removed from room"," ").concat(n?"by ".concat(n):""));this.emitEvent(r)}},{key:"sendPeerList",value:function(e){var t=this.createNotification(io.PEER_LIST,e,ro.INFO);this.emitEvent(t)}},{key:"sendPeerUpdate",value:function(e,t){var n=this.store.getState(ms(null==t?void 0:t.id))||t,r=Ns[e];if(r){var i=this.createNotification(r,n,ro.INFO);this.emitEvent(i)}}},{key:"sendTrackUpdate",value:function(e,t){var n=this.store.getState(gs(t)),r=Os[e];if(r){var i=this.createNotification(r,n,ro.INFO);this.emitEvent(i)}}},{key:"sendMessageReceived",value:function(e){var t=this.createNotification(io.NEW_MESSAGE,e,ro.INFO);this.emitEvent(t)}},{key:"sendError",value:function(e){var t=this.createNotification(io.ERROR,e,ro.ERROR);this.emitEvent(t)}},{key:"sendReconnecting",value:function(e){var t=this.createNotification(io.RECONNECTING,e,ro.ERROR);this.emitEvent(t)}},{key:"sendReconnected",value:function(){var e=this.createNotification(io.RECONNECTED,null,ro.INFO);this.emitEvent(e)}},{key:"sendChangeTrackStateRequest",value:function(e){var t=this.createNotification(io.CHANGE_TRACK_STATE_REQUEST,e,ro.INFO);this.emitEvent(t)}},{key:"sendChangeMultiTrackStateRequest",value:function(e){var t=this.createNotification(io.CHANGE_MULTI_TRACK_STATE_REQUEST,e,ro.INFO);this.emitEvent(t)}},{key:"emitEvent",value:function(e){this.eventEmitter.emit(Us,e)}},{key:"createNotification",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.id++,{id:this.id,type:e,message:r,data:t,severity:n}}}]),e}(),js=function(e){return kr?"".concat(e," ").concat(document.title):e},Bs=function(e,t,n){var r,i,a=Vs(n,t);null==(r=e.getWebrtcInternals())||r.start();var o=null==(i=e.getWebrtcInternals())?void 0:i.onStatsChange((function(e){return Gs(t,e,n)}));return function(){a(),o&&o()}},Vs=function(e,t){var n,r,i;return e.getState(Mo)?t.namedSetState((function(t){t.localPeer.id=e.getState(Mo)}),"localpeer-id"):n=e.subscribe((function(e){e&&t.namedSetState((function(t){t.localPeer.id=e}),"localpeer-id")}),Mo),e.getState(Fo)?t.namedSetState((function(t){t.localPeer.videoTrack=e.getState(Fo)}),"localpeer-videotrack-id"):r=e.subscribe((function(e){e&&t.namedSetState((function(t){t.localPeer.videoTrack=e}),"localpeer-videotrack-id")}),Fo),e.getState(Uo)?t.namedSetState((function(t){t.localPeer.videoTrack=e.getState(Uo)}),"localpeer-audiotrack-id"):i=e.subscribe((function(e){e&&t.namedSetState((function(t){t.localPeer.videoTrack=e}),"localpeer-audiotrack-id")}),Uo),function(){null==n||n(),null==r||r(),null==i||i()}},Gs=function(e,t,n){var r=n.getState(_o);e.namedSetState((function(e){for(var i={},a=0,o=Object.keys(r);a<o.length;a++){var s=o[a],u=t.getTrackStats(s);u&&(i[s]=u)}uo(e.trackStats,i);var c=p({},n.getState(Mo),t.getLocalPeerStats());uo(e.peerStats,c)}),"webrtc-stats")},zs=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"resetState";e.namedSetState((function(e){Object.assign(e,{peerStats:{},trackStats:{},localPeer:{id:""}})}),t)},Hs=y((function e(t,n){var r=this;m(this,e),this.hmsStore=t,this.sdk=n,this.store=Xs.createNewHMSStore(js("HMSStatsStore"),so),this.getState=this.store.getState,this.subscribe=this.store.subscribe,this.getPublishPeerConnection=function(){return new Promise((function(e){var t,n;"Connected"===r.hmsStore.getState(Qo)?e(null==(n=null==(t=r.sdk)?void 0:t.getWebrtcInternals())?void 0:n.getPublishPeerConnection()):r.hmsStore.subscribe((function(t){var n,i;"Connected"===t&&e(null==(i=null==(n=r.sdk)?void 0:n.getWebrtcInternals())?void 0:i.getPublishPeerConnection())}),Qo)}))},this.getSubscribePeerConnection=function(){return new Promise((function(e){var t,n;"Connected"===r.hmsStore.getState(Qo)?e(null==(n=null==(t=r.sdk)?void 0:t.getWebrtcInternals())?void 0:n.getSubscribePeerConnection()):r.hmsStore.subscribe((function(t){var n,i;"Connected"===t&&e(null==(i=null==(n=r.sdk)?void 0:n.getWebrtcInternals())?void 0:i.getSubscribePeerConnection())}),Qo)}))},this.sdk&&function(e,t,n){var r;n.getState(Qo)===Ka.Connected&&(r=Bs(e,t,n)),n.subscribe((function(i){[Ka.Connected,Ka.Reconnecting].includes(i)?r||(r=Bs(e,t,n)):r&&(zs(t),r())}),Qo)}(this.sdk,this.store,this.hmsStore)})),Ks=function(e){return e.trackStats},Ws=function(e){return e.peerStats},qs=Ha([Ws,function(e){return e.localPeer.id}],(function(e,t){return e[t]})),Qs=(Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.packetsLost})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.jitter})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.publish)?void 0:t.bitrate})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.bitrate})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.publish)?void 0:t.availableOutgoingBitrate})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.availableIncomingBitrate})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.publish)?void 0:t.bytesSent})),Ha(qs,(function(e){var t;return null==(t=null==e?void 0:e.subscribe)?void 0:t.bytesReceived})),Ha([Ws,function(e,t){return t}],(function(e,t){return t?e[t]:void 0}))),Js=Ha([Ks,function(e,t){return t}],(function(e,t){return t?e[t]:void 0})),$s=(cs(Qs),cs(Js),cs(Ha(Js,(function(e){return null==e?void 0:e.bitrate}))),cs(Ha(Js,(function(e){return null==e?void 0:e.bytesReceived}))),cs(Ha(Js,(function(e){return null==e?void 0:e.framesPerSecond}))),cs(Ha(Js,(function(e){return null==e?void 0:e.jitter}))),cs(Ha(Js,(function(e){return null==e?void 0:e.packetsLost}))),Ha([Ks,function(e){return e.localPeer.audioTrack}],(function(e,t){return t?e[t]:void 0}))),Ys=Ha([Ks,function(e){return e.localPeer.videoTrack}],(function(e,t){return t?e[t]:void 0})),Xs=(Ha($s,(function(e){return null==e?void 0:e.bitrate})),Ha(Ys,(function(e){return null==e?void 0:e.bitrate})),Ha($s,(function(e){return null==e?void 0:e.bytesSent})),Ha(Ys,(function(e){return null==e?void 0:e.bytesSent})),Ha(Ys,(function(e){return null==e?void 0:e.framesPerSecond})),Ha(Ys,(function(e){return null==e?void 0:e.qualityLimitationReason})),function(){function e(t,n,r){var i=this;m(this,e),this.getStats=function(){return i.stats||(i.stats=new Hs(i.store,i.sdk)),i.stats},this.store=t||e.createNewHMSStore(js("HMSStore"),oo),this.notifications=r||new Fs(this.store),n?this.actions=n:(this.sdk=new Ua,this.actions=new Ms(this.store,this.sdk,this.notifications)),this.initialTriggerOnSubscribe=!1,kr&&(window.__hms=this)}return y(e,[{key:"triggerOnSubscribe",value:function(){this.initialTriggerOnSubscribe||(e.makeStoreTriggerOnSubscribe(this.store),this.initialTriggerOnSubscribe=!0)}},{key:"getStore",value:function(){return this.store}},{key:"getHMSActions",value:function(){return this.actions}},{key:"getActions",value:function(){return this.actions}},{key:"getNotifications",value:function(){return{onNotification:this.notifications.onNotification}}}],[{key:"createNewHMSStore",value:function(t,n){var r=ke((function(){return n()})),i=r.setState;r.setState=function(e){var t="function"==typeof e?ye(e):e;i(t)};var a=r.getState;r.getState=function(e){if(e){var t=e.name||"byIDSelector";window.selectorsCount||(window.selectorsCount={}),window.selectorsCount[t]=(window.selectorsCount[t]||0)+1;var n=performance.now(),r=e(a()),i=performance.now()-n;return i>1&&(window.expensiveSelectors=window.expensiveSelectors||new Map,window.expensiveSelectors.set(t,i)),r}return a()},e.compareWithShallowCheckInSubscribe(r);var o=e.setUpDevtools(r,t);return eo(Za({},r),{namedSetState:o})}},{key:"makeStoreTriggerOnSubscribe",value:function(e){var t=e.subscribe;e.subscribe=function(n,r,i){return n(e.getState(r),void 0),t(n,r,i)}}},{key:"compareWithShallowCheckInSubscribe",value:function(e){var t=e.subscribe;e.subscribe=function(e,n,r){return n||(n=function(e){return e}),t(e,n,r=r||be)}}},{key:"setUpDevtools",value:function(t,n){var r;try{r=window.__REDUX_DEVTOOLS_EXTENSION__||window.top.__REDUX_DEVTOOLS_EXTENSION__}catch(b){}if(!r)return function(e){t.setState(e)};var i=r.connect(e.devtoolsOptions(n));i.prefix=n?"".concat(n," > "):"";var a=t.setState;return t.setState=function(e){a(e),i.send("".concat(i.prefix,"setState"),t.getState())},i.subscribe(e.devtoolsSubscribe(i,t,a)),i.send("setUpStore",t.getState()),function(e,n){a(e);var r=n||"".concat(i.prefix,"action");i.send(r,t.getState())}}},{key:"devtoolsOptions",value:function(e){return{name:e,actionsBlacklist:["audioLevel","playlistProgress","connectionQuality"]}}},{key:"devtoolsSubscribe",value:function(e,t,n){return function(r){var i,a,o,s;if("DISPATCH"===r.type&&r.state)["JUMP_TO_ACTION","JUMP_TO_STATE"].includes(r.payload.type)?n(JSON.parse(r.state)):t.setState(JSON.parse(r.state));else if("DISPATCH"===r.type&&"COMMIT"===(null==(i=r.payload)?void 0:i.type))e.init(t.getState());else if("DISPATCH"===r.type&&"IMPORT_STATE"===(null==(a=r.payload)?void 0:a.type)){var u=null==(o=r.payload.nextLiftedState)?void 0:o.actionsById;((null==(s=r.payload.nextLiftedState)?void 0:s.computedStates)||[]).forEach((function(r,i){var a=r.state,o=u[i]||"".concat(e.prefix,"setState");0===i?e.init(a):(n(a),e.send(o,t.getState()))}))}}}}]),e}());function Zs(e){var t,n=new Set,r=function(e,r){var i="function"===typeof e?e(t):e;if(i!==t){var a=t;t=r?i:Object.assign({},t,i),n.forEach((function(e){return e(t,a)}))}},i=function(){return t},a={setState:r,getState:i,subscribe:function(e,r,a){return r||a?function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");var o=r(t);function s(){var n=r(t);if(!a(o,n)){var i=o;e(o=n,i)}}return n.add(s),function(){return n.delete(s)}}(e,r,a):(n.add(e),function(){return n.delete(e)})},destroy:function(){return n.clear()}};return t=e(r,i,a),a}var eu,tu,nu="undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?a.useEffect:a.useLayoutEffect;function ru(e){var t="function"===typeof e?Zs(e):e,n=function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.getState,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,i=(0,a.useReducer)((function(e){return e+1}),0),o=f(i,2),s=o[1],u=t.getState(),c=(0,a.useRef)(u),l=(0,a.useRef)(n),d=(0,a.useRef)(r),h=(0,a.useRef)(!1),p=(0,a.useRef)();void 0===p.current&&(p.current=n(u));var v=!1;(c.current!==u||l.current!==n||d.current!==r||h.current)&&(e=n(u),v=!r(p.current,e)),nu((function(){v&&(p.current=e),c.current=u,l.current=n,d.current=r,h.current=!1}));var m=(0,a.useRef)(u);nu((function(){var e=function(){try{var e=t.getState(),n=l.current(e);d.current(p.current,n)||(c.current=e,p.current=n,s())}catch(r){h.current=!0,s()}},n=t.subscribe(e);return t.getState()!==m.current&&e(),n}),[]);var g=v?e:p.current;return(0,a.useDebugValue)(g),g};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");var e=[n,t];return{next:function(){var t=e.length<=0;return{value:e.shift(),done:t}}}},n}function iu(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}(tu=eu||(eu={}))[tu.VERBOSE=0]="VERBOSE",tu[tu.DEBUG=1]="DEBUG",tu[tu.INFO=2]="INFO",tu[tu.WARN=3]="WARN",tu[tu.ERROR=4]="ERROR",tu[tu.NONE=5]="NONE";var au=function(){function e(){m(this,e)}return y(e,null,[{key:"v",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[eu.VERBOSE,e].concat(n))}},{key:"d",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[eu.DEBUG,e].concat(n))}},{key:"i",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[eu.INFO,e].concat(n))}},{key:"w",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[eu.WARN,e].concat(n))}},{key:"e",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.log.apply(this,[eu.ERROR,e].concat(n))}},{key:"log",value:function(e,t){for(var n,r,i,a,o,s=arguments.length,u=new Array(s>2?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];if(!(this.level.valueOf()>e.valueOf()))switch(e){case eu.VERBOSE:(n=console).log.apply(n,["HMSui-components: ",t].concat(u));break;case eu.DEBUG:(r=console).debug.apply(r,["HMSui-components: ",t].concat(u));break;case eu.INFO:(i=console).info.apply(i,["HMSui-components: ",t].concat(u));break;case eu.WARN:(a=console).warn.apply(a,["HMSui-components: ",t].concat(u));break;case eu.ERROR:(o=console).error.apply(o,["HMSui-components: ",t].concat(u))}}}]),e}();au.level=eu.VERBOSE;var ou="It seems like you forgot to add your component within a top level HMSRoomProvider, please refer to 100ms react docs(https://docs.100ms.live/javascript/v2/features/integration#react-hooks) to check on the required steps for using this hook.";var su,uu="undefined"!=typeof window,cu=(0,a.createContext)(null),lu=function(e){var t=e.children,n=e.actions,r=e.store,i=e.notifications,o=e.stats,s=e.isHMSStatsOn,u=void 0!==s&&s;if(!su){var c=function(){throw new Error("modifying store is not allowed")};if(n&&r)su={actions:n,store:ru(Object.assign(Object.assign({},r),{setState:c,destroy:c}))},i&&(su.notifications=i),o&&(su.statsStore=ru({getState:o.getState,subscribe:o.subscribe,setState:c,destroy:c}));else{var l=new Xs;if(su={actions:l.getActions(),store:ru(Object.assign(Object.assign({},l.getStore()),{setState:c,destroy:c})),notifications:l.getNotifications()},u){var d=l.getStats();su.statsStore=ru({getState:d.getState,subscribe:d.subscribe,setState:c,destroy:c})}}}return(0,a.useEffect)((function(){uu&&(window.addEventListener("beforeunload",(function(){return su.actions.leave()})),window.addEventListener("onunload",(function(){return su.actions.leave()})))}),[]),a.createElement(cu.Provider,{value:su},t)},du=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iu;t||au.w("fetching full store without passing any selector may have a heavy performance impact on your website.");var r=(0,a.useContext)(e);if(!r)throw new Error(ou);return(0,r.store)(t,n)}}(cu),hu=(function(e){}(cu),function(){var e=(0,a.useContext)(cu);if(!e)throw new Error(ou);return e.actions}),fu=n(184),pu=function(e){var t=e.peer,n=e.isLocal,r=hu(),i=a.useRef(null),o=du(bs(t.id));return a.useEffect((function(){l(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(i.current),console.log(o),!i.current||!o){e.next=10;break}if(!o.enabled){e.next=8;break}return e.next=6,r.attachVideo(o.id,i.current);case 6:e.next=10;break;case 8:return e.next=10,r.detachVideo(o.id,i.current);case 10:case"end":return e.stop()}}),e)})))()}),[r,o]),(0,fu.jsx)("div",{className:"flex m-auto",children:(0,fu.jsxs)("div",{className:"relative",children:[(0,fu.jsx)("video",{ref:i,autoPlay:!0,playsInline:!0,muted:!0,className:"object-cover h-64 w-screen h-screen rounded-lg shadow-lg ".concat(n?"mirror":"")}),(0,fu.jsx)("div",{className:"top-0 w-full absolute flex justify-center",children:(0,fu.jsx)("div",{className:"px-2 py-1 text-sm bg-gray-600 text-white mt-2 ml-2 rounded-lg",children:"".concat(t.name)})})]})})},vu=function(e){if(!e.show)return null;var t="6288c1d9b873787aa26f06f0",n="FRONTEND";return(0,fu.jsx)("div",{className:"modal",children:(0,fu.jsxs)("div",{className:"modal-content",children:[(0,fu.jsxs)("div",{className:"modal-header",children:[(0,fu.jsx)("button",{onClick:e.onClose,className:"button",children:"Close"}),(0,fu.jsxs)("h5",{className:"modal-title",children:["Invite People to join meeting ",n]})]}),(0,fu.jsx)("div",{className:"modal-body",children:(0,fu.jsx)("input",{className:"modal-input",placeholder:"Choose from the list or type to filter"})}),(0,fu.jsxs)("div",{className:"modal-footer",children:[(0,fu.jsx)("button",{className:"button",children:"Copy invite link"}),(0,fu.jsxs)("div",{className:"btn-right",children:[(0,fu.jsxs)("h5",{children:["Meeting Passcode: ",t," "]}),(0,fu.jsx)("button",{className:"button",children:"Invite"})]})]})]})})},mu=function(){var e=hu(),t=du(Vo),n=du(Go),r=du(Ho),i=du(Do),o=function(){var n=l(u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.setLocalAudioEnabled(!t);case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),s=function(){var t=l(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setLocalVideoEnabled(!n);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){var t=l(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setScreenShareEnabled(!r);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=f((0,a.useState)(!1),2),h=d[0],p=d[1];return(0,fu.jsxs)("div",{class:"main__controls",children:[(0,fu.jsxs)("div",{className:"main__controls__block",children:[(0,fu.jsx)("div",{className:"main__controls__button main__mute_button",onClick:o,children:t?(0,fu.jsxs)(fu.Fragment,{children:[(0,fu.jsx)("i",{className:"fas fa-microphone"}),(0,fu.jsx)("span",{children:"Mute"})]}):(0,fu.jsxs)(fu.Fragment,{children:[(0,fu.jsx)("i",{className:"fas fa-microphone-slash"}),(0,fu.jsx)("span",{children:"UnMute"})]})}),(0,fu.jsx)("div",{onClick:s,className:"main__controls__button main__video_button",children:n?(0,fu.jsxs)(fu.Fragment,{children:[(0,fu.jsx)("i",{className:"fas fa-video"}),(0,fu.jsx)("span",{children:"Stop Video"})]}):(0,fu.jsxs)(fu.Fragment,{children:[(0,fu.jsx)("i",{className:"fas fa-video"}),(0,fu.jsx)("span",{children:"Play Video"})]})}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-shield-alt"}),(0,fu.jsx)("span",{children:"Security"})]}),(0,fu.jsxs)("div",{className:"main__controls__button part",onClick:function(){document.getElementById("invite").classList.toggle("show")},children:[(0,fu.jsx)("i",{className:"fas fa-user-friends"}),(0,fu.jsxs)("span",{className:"partLink",children:["Participants ",(0,fu.jsx)("span",{className:"participants",children:i})]}),(0,fu.jsx)("div",{id:"invite",className:"dropdown-content",children:(0,fu.jsxs)("button",{onClick:function(){return p(!0)},children:["Invite",(0,fu.jsx)("span",{className:"share-icon"})]})}),(0,fu.jsx)(vu,{onClose:function(){return p(!1)},show:h})]}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-comment-alt"}),(0,fu.jsx)("span",{children:"Chat"})]}),(0,fu.jsxs)("div",{onClick:c,className:"main__controls__button main__video_button",children:[(0,fu.jsx)("i",{className:"fas fa-desktop"}),r?"Unshare":"Share Screen"]}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-record-vinyl"}),(0,fu.jsx)("span",{children:"Record "})]}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-laugh"}),(0,fu.jsx)("span",{children:"Reactions"})]}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-retweet"}),(0,fu.jsx)("span",{children:"Apps"})]}),(0,fu.jsxs)("div",{className:"main__controls__button",children:[(0,fu.jsx)("i",{className:"fas fa-clipboard"}),(0,fu.jsx)("span",{children:"Whiteboard"})]})]}),(0,fu.jsx)("div",{className:"main__controls__block",children:(0,fu.jsx)("div",{onClick:function(){e.endRoom(!1,"reason")&&e.leave()},className:"main__controls__button",children:(0,fu.jsx)("span",{className:"leave_meeting",children:"Leave Meeting"})})})]})},gu=function(){var e=du(Lo),t=du(No);return(0,fu.jsxs)("div",{class:"main",children:[(0,fu.jsxs)("div",{class:"main__left",children:[(0,fu.jsx)("div",{class:"main__videos",children:(0,fu.jsx)("div",{id:"video-grid",children:(0,fu.jsx)("div",{className:"flex flex-col mt-20",children:(0,fu.jsxs)("div",{className:"flex bg-gray-900 w-screen min-h-screen p-2 flex-wrap",children:[e&&(0,fu.jsx)(pu,{peer:e,isLocal:!0}),t&&t.filter((function(e){return!e.isLocal})).map((function(e){return(0,fu.jsx)(fu.Fragment,{children:(0,fu.jsx)(pu,{isLocal:!1,peer:e})})}))]})})})}),(0,fu.jsx)(mu,{})]}),(0,fu.jsxs)("div",{className:"main__right",children:[(0,fu.jsx)("div",{className:"main__header",children:(0,fu.jsx)("h6",{children:"Chat"})}),(0,fu.jsx)("div",{className:"main__chat_window",children:(0,fu.jsx)("ul",{className:"messages"})}),(0,fu.jsx)("div",{className:"main__message_container",children:(0,fu.jsx)("input",{id:"chat_message",type:"text",placeholder:"Type message here..."})})]})]})},yu=function(){return(0,fu.jsx)("nav",{className:"navbar",children:(0,fu.jsxs)("div",{className:"container-fluid",children:[(0,fu.jsxs)("div",{className:"navbar-header",children:[(0,fu.jsxs)("button",{type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#bs-example-navbar-collapse-1","aria-expanded":"false",children:[(0,fu.jsx)("span",{className:"sr-only",children:"Toggle navigation"}),(0,fu.jsx)("span",{className:"icon-bar"}),(0,fu.jsx)("span",{className:"icon-bar"}),(0,fu.jsx)("span",{className:"icon-bar"})]}),(0,fu.jsx)("a",{className:"navbar-brand",href:"https://google.com",children:(0,fu.jsx)("img",{className:"gb_xc",src:"https://st1.zoom.us/static/6.1.6899/image/new/ZoomLogo.png",srcSet:"https://st1.zoom.us/static/6.1.6899/image/new/ZoomLogo.png 1x",alt:"Zoom logo","aria-hidden":"true","data-iml":"1243.5999999940395","data-atf":"true"})})]}),(0,fu.jsx)("div",{className:"collapse navbar-collapse",id:"bs-example-navbar-collapse-1",children:(0,fu.jsxs)("ul",{className:"nav navbar-nav navbar-right",children:[(0,fu.jsx)("li",{children:(0,fu.jsx)("a",{href:"https://zoom.com",style:{fontSize:15},children:" Join"})}),(0,fu.jsx)("li",{children:(0,fu.jsx)("a",{href:"https://zoom.com",style:{fontSize:15},children:"Host"})}),(0,fu.jsx)("li",{children:(0,fu.jsx)("a",{href:"https://zoom.com",style:{fontSize:15},children:"Sign In"})}),(0,fu.jsx)("li",{children:(0,fu.jsx)("a",{className:"signup",children:"SIGN UP IT'S FREE"})})]})})]})})},ku=function(){var e=l(u().mark((function e(t){var n,r,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://prod-in2.100ms.live/hmsapi/googlemeet.app.100ms.live/","api/token"),{method:"POST",body:JSON.stringify({user_id:t,role:"host",room_id:"6288c1d9b873787aa26f06f0"})});case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,i=r.token,console.log(i),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bu=ku,wu=function(){var e=hu(),t=f((0,a.useState)(""),2),n=t[0],r=t[1],i=function(){var t=l(u().mark((function t(n){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bu(n);case 2:r=t.sent,e.join({userName:n,authToken:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,fu.jsxs)(fu.Fragment,{children:[(0,fu.jsx)(yu,{}),(0,fu.jsx)("hr",{}),(0,fu.jsx)("div",{id:"content_container",style:{minHeight:872},className:"zoom-newcontent ",children:(0,fu.jsx)("div",{id:"content",className:"main-content",children:(0,fu.jsx)("div",{className:"mini-layout",id:"join-conf",children:(0,fu.jsxs)("div",{className:"mini-layout-body",children:[(0,fu.jsx)("h1",{style:{fontSize:25},children:"Join Meeting"}),(0,fu.jsx)("div",{className:"box",children:(0,fu.jsxs)("form",{id:"join-form",className:"form-vertical",onSubmit:function(e){e.preventDefault(),i(n)},children:[(0,fu.jsx)("div",{className:"form-group confno",style:{marginBottom:30},children:(0,fu.jsxs)("div",{className:"controls",children:[(0,fu.jsx)("label",{htmlFor:"join-confno",style:{color:747486,fontSize:15,marginBottom:10},children:"Meeting ID or Personal Link Name"}),(0,fu.jsx)("input",{"aria-describedby":"rule-tip",id:"join-confno",type:"text",className:"form-control input-lg confno",autoComplete:"off",maxLength:"100",placeholder:"Enter Meeting ID or Personal Link Name",value:n,onChange:function(e){return r(e.target.value)},name:"userName",required:!0}),(0,fu.jsx)("div",{id:"errorContainer",className:"wc-new-syle",children:(0,fu.jsxs)("div",{id:"join-errormsg",className:"error hideme",children:[(0,fu.jsx)("i",{}),(0,fu.jsx)("span",{})]})})]})}),(0,fu.jsx)("div",{className:"form-group",style:{marginBottom:16},children:(0,fu.jsxs)("div",{className:"controls",children:['By clicking "Join", you agree to our ',(0,fu.jsx)("a",{href:"https://zoom.us/terms",children:"Terms of Services"})," and ",(0,fu.jsx)("a",{href:"https://zoom.us/privacy",children:"Privacy Statement"})]})}),(0,fu.jsx)("div",{className:"form-group",style:{marginBottom:72},children:(0,fu.jsx)("div",{className:"controls wc-new-syle",children:(0,fu.jsx)("button",{id:"btnSubmit",role:"button",style:{width:200,padding:5},className:"btn btn-primary user submit",children:"Join"})})}),(0,fu.jsx)("div",{className:"form-group",children:(0,fu.jsx)("div",{className:"controls wc-new-syle",children:(0,fu.jsx)("a",{id:"btnRoomSystemJoin",className:"doc",href:"https://zoom.us/meeting/rooms",children:"Join a meeting from an H.323/SIP room system"})})})]})})]})})})})]})},Su=function(){var e=hu(),t=du(Ao),n=function(){var t=l(u().mark((function t(n){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,bu(n);case 2:r=t.sent,e.join({authToken:r,userName:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,fu.jsx)(fu.Fragment,{children:t?(0,fu.jsx)(gu,{}):(0,fu.jsx)(wu,{handleSubmit:n})})},Tu=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))};o.createRoot(document.getElementById("root")).render((0,fu.jsx)(lu,{children:(0,fu.jsx)(Su,{})})),Tu()}()}();
//# sourceMappingURL=main.f376c71b.js.map